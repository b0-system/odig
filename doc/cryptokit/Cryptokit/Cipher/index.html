<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cipher (cryptokit.Cryptokit.Cipher)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cryptokit</a> &#x00BB; <a href="../index.html">Cryptokit</a> &#x00BB; Cipher</nav><h1>Module <code>Cryptokit.Cipher</code></h1><p>The <code>Cipher</code> module implements the AES, DES, Triple-DES, ARCfour and Blowfish symmetric ciphers. Symmetric ciphers are presented as transforms parameterized by a secret key and a ``direction'' indicating whether encryption or decryption is to be performed. The same secret key is used for encryption and for decryption.</p><nav class="toc"><ul><li><a href="#recommended-ciphers">Recommended ciphers</a></li><li><a href="#weaker,-older-ciphers,-not-recommended-for-new-applications">Weaker, older ciphers, not recommended for new applications</a></li></ul></nav></header><dl><dt class="spec type" id="type-direction"><a href="#type-direction" class="anchor"></a><code><span class="keyword">type</span> direction</code><code> = </code><table class="variant"><tr id="type-direction.Encrypt" class="anchored"><td class="def constructor"><a href="#type-direction.Encrypt" class="anchor"></a><code>| </code><code><span class="constructor">Encrypt</span></code></td></tr><tr id="type-direction.Decrypt" class="anchored"><td class="def constructor"><a href="#type-direction.Decrypt" class="anchor"></a><code>| </code><code><span class="constructor">Decrypt</span></code></td><td class="doc"><p>Indicate whether the cipher should perform encryption (transforming plaintext to ciphertext) or decryption (transforming ciphertext to plaintext).</p></td></tr></table></dt><dt class="spec type" id="type-chaining_mode"><a href="#type-chaining_mode" class="anchor"></a><code><span class="keyword">type</span> chaining_mode</code><code> = </code><table class="variant"><tr id="type-chaining_mode.ECB" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.ECB" class="anchor"></a><code>| </code><code><span class="constructor">ECB</span></code></td></tr><tr id="type-chaining_mode.CBC" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.CBC" class="anchor"></a><code>| </code><code><span class="constructor">CBC</span></code></td></tr><tr id="type-chaining_mode.CFB" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.CFB" class="anchor"></a><code>| </code><code><span class="constructor">CFB</span> <span class="keyword">of</span> int</code></td></tr><tr id="type-chaining_mode.OFB" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.OFB" class="anchor"></a><code>| </code><code><span class="constructor">OFB</span> <span class="keyword">of</span> int</code></td></tr><tr id="type-chaining_mode.CTR" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.CTR" class="anchor"></a><code>| </code><code><span class="constructor">CTR</span></code></td></tr><tr id="type-chaining_mode.CTR_N" class="anchored"><td class="def constructor"><a href="#type-chaining_mode.CTR_N" class="anchor"></a><code>| </code><code><span class="constructor">CTR_N</span> <span class="keyword">of</span> int</code></td><td class="doc"><p>Block ciphers such as AES or DES map a fixed-sized block of input data to a block of output data of the same size. A chaining mode indicates how to extend them to multiple blocks of data. The five chaining modes supported in this library are:</p><ul><li><code>ECB</code>: Electronic Code Book mode.</li><li><code>CBC</code>: Cipher Block Chaining mode.</li><li><code>CFB n</code>: Cipher Feedback Block with <code>n</code> bytes.</li><li><code>OFB n</code>: Output Feedback Block with <code>n</code> bytes</li><li><code>CTR</code>: Counter mode, incrementing all the bytes of the IV</li><li><code>CTR_N n</code>: Counter mode, incrementing only the final <code>n</code> bytes of the IV. For example, <code>CTR_N 4</code> increments the final 32 bits of the IV, as in NIST Special Publication 800-38D.</li></ul><p>A detailed description of these modes is beyond the scope of this documentation; refer to a good cryptography book. <code>CBC</code> is a recommended default. For <code>CFB n</code> and <code>OFB n</code>, note that the blocksize is reduced to <code>n</code>, but encryption speed drops by a factor of <code>blocksize / n</code>, where <code>blocksize</code> is the block size of the underlying cipher; moreover, <code>n</code> must be between <code>1</code> and <code>blocksize</code> included. For <code>CTR_N n</code>, <code>n</code> must be between <code>1</code> and <code>blocksize</code> included. <code>CTR</code> is equivalent to <code>CTR_N blocksize</code>.</p></td></tr></table></dt></dl><section><header><h3 id="recommended-ciphers"><a href="#recommended-ciphers" class="anchor"></a>Recommended ciphers</h3></header><dl><dt class="spec value" id="val-aes"><a href="#val-aes" class="anchor"></a><code><span class="keyword">val</span> aes : ?&#8288;mode:<a href="index.html#type-chaining_mode">chaining_mode</a> <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> ?&#8288;iv:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>AES is the Advanced Encryption Standard, also known as Rijndael. This is a modern block cipher, recently standardized. It processes data by blocks of 128 bits (16 bytes), and supports keys of 128, 192 or 256 bits. The string argument is the key; it must have length 16, 24 or 32. The direction argument specifies whether encryption or decryption is to be performed.</p><p>The optional <code>mode</code> argument specifies a chaining mode, as described above; <code>CBC</code> is used by default.</p><p>The optional <code>pad</code> argument specifies a padding scheme to pad cleartext to an integral number of blocks. If no <code>pad</code> argument is given, no padding is performed and the length of the cleartext must be an integral number of blocks.</p><p>The optional <code>iv</code> argument is the initialization vector used by the chaining mode. It is ignored in ECB mode. If provided, it must be a string of the same size as the block size (16 bytes). If omitted, the null initialization vector (16 zero bytes) is used.</p><p>The <code>aes</code> function returns a transform that performs encryption or decryption, depending on the direction argument.</p></dd></dl><dl><dt class="spec value" id="val-chacha20"><a href="#val-chacha20" class="anchor"></a><code><span class="keyword">val</span> chacha20 : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;ctr:int64 <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Chacha20 is a stream cipher proposed by D. J. Bernstein in 2008.</p><p>The Chacha20 cipher is a stream cipher, not a block cipher. Hence, its natural block size is 1, and no padding is required. Chaining modes do not apply. A feature of stream ciphers is that the xor of two ciphertexts obtained with the same key is the xor of the corresponding plaintexts, which allows various attacks. Hence, the same key must never be reused.</p><p>The string argument is the key; its length must be either 16 or (better) 32.</p><p>The optional <code>iv</code> argument is the initialization vector (also called nonce) that can be used to diversify the key. If present, it must be 8 characters long. If absent, it is taken to be eight zero bytes.</p><p>The optional <code>ctr</code> argument is the initial value of the internal counter. If absent, it defaults to 0.</p><p>The direction argument is present for consistency with the other ciphers only, and is actually ignored: for all stream ciphers, decryption is the same function as encryption.</p></dd></dl></section><section><header><h3 id="weaker,-older-ciphers,-not-recommended-for-new-applications"><a href="#weaker,-older-ciphers,-not-recommended-for-new-applications" class="anchor"></a>Weaker, older ciphers, not recommended for new applications</h3></header><dl><dt class="spec value" id="val-des"><a href="#val-des" class="anchor"></a><code><span class="keyword">val</span> des : ?&#8288;mode:<a href="index.html#type-chaining_mode">chaining_mode</a> <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> ?&#8288;iv:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>DES is the Data Encryption Standard. Very popular in the past, but now completely insecure owing to its small key size (56 bits) which can easily be broken by brute-force enumeration. It should therefore be considered as weak encryption. Its block size is 64 bits (8 bytes). The arguments to the <code>des</code> function have the same meaning as for the <a href="index.html#val-aes"><code>Cryptokit.Cipher.aes</code></a> function. The key argument is a string of length 8 (64 bits); the least significant bit of each key byte is ignored.</p></dd></dl><dl><dt class="spec value" id="val-triple_des"><a href="#val-triple_des" class="anchor"></a><code><span class="keyword">val</span> triple_des : ?&#8288;mode:<a href="index.html#type-chaining_mode">chaining_mode</a> <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> ?&#8288;iv:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Triple DES with two or three DES keys. This is a popular variant of DES where each block is encrypted with a 56-bit key <code>k1</code>, decrypted with another 56-bit key <code>k2</code>, then re-encrypted with either <code>k1</code> or a third 56-bit key <code>k3</code>. This results in a 112-bit or 168-bit key length that resists brute-force attacks. However, the three encryptions required on each block make this cipher quite slow (4 times slower than AES). Moreover, the small block size (64 bits) opens the way to collision-based attacks. Triple DES should therefore be considered as relatively weak encryption. The arguments to the <code>triple_des</code> function have the same meaning as for the <a href="index.html#val-aes"><code>Cryptokit.Cipher.aes</code></a> function. The key argument is a string of length 16 or 24, representing the concatenation of the key parts <code>k1</code>, <code>k2</code>, and optionally <code>k3</code>. The least significant bit of each key byte is ignored.</p></dd></dl><dl><dt class="spec value" id="val-arcfour"><a href="#val-arcfour" class="anchor"></a><code><span class="keyword">val</span> arcfour : string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>ARCfour (``alleged RC4'') is a fast stream cipher that appears to produce equivalent results with the commercial RC4 cipher from RSA Data Security Inc. This company holds the RC4 trademark, and sells the real RC4 cipher. So, it is prudent not to use ARCfour in a commercial product.</p><p>ARCfour is popular for its speed: approximately 2 times faster than AES. It accepts any key length up to 2048 bits. However, the security of ARCfour is being questioned owing to several statistical biases in its output. It should not be used for new applications.</p><p>The ARCfour cipher is a stream cipher, not a block cipher. Hence, its natural block size is 1, and no padding is required. Chaining modes do not apply. A feature of stream ciphers is that the xor of two ciphertexts obtained with the same key is the xor of the corresponding plaintexts, which allows various attacks. Hence, the same key must never be reused.</p><p>The string argument is the key; its length must be between 1 and 256 inclusive. The direction argument is present for consistency with the other ciphers only, and is actually ignored: for all stream ciphers, decryption is the same function as encryption.</p></dd></dl><dl><dt class="spec value" id="val-blowfish"><a href="#val-blowfish" class="anchor"></a><code><span class="keyword">val</span> blowfish : ?&#8288;mode:<a href="index.html#type-chaining_mode">chaining_mode</a> <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> ?&#8288;iv:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-direction">direction</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Blowfish is a fast block cipher proposed by B.Schneier in 1994. It processes data by blocks of 64 bits (8 bytes), and supports keys of 32 to 448 bits.</p><p>The small block size (64 bits) of Blowfish opens the way to some collision-based attacks. Depending on the application, ciphers with larger block size should be preferred.</p><p>The string argument is the key; its length must be between 4 and 56.</p><p>The direction argument specifies whether encryption or decryption is to be performed.</p><p>The optional <code>mode</code> argument specifies a chaining mode, as described above; <code>CBC</code> is used by default.</p><p>The optional <code>pad</code> argument specifies a padding scheme to pad cleartext to an integral number of blocks. If no <code>pad</code> argument is given, no padding is performed and the length of the cleartext must be an integral number of blocks.</p><p>The optional <code>iv</code> argument is the initialization vector used by the chaining mode. It is ignored in ECB mode. If provided, it must be a string of the same size as the block size (8 bytes). If omitted, the null initialization vector (8 zero bytes) is used.</p><p>The <code>blowfish</code> function returns a transform that performs encryption or decryption, depending on the direction argument.</p></dd></dl></section></div></body></html>