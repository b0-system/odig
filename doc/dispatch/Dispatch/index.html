<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dispatch (dispatch.Dispatch)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">dispatch</a> &#x00BB; Dispatch</nav><h1>Module <code>Dispatch</code></h1><p>Path-based dispatching for client- and server-side applications.</p><p>Dispatch provides a basic mechanism for dispatching a request to a handler based on a conventionally heirarhical path name found in URIs. It can be used both for dispatching requests in a server, as well as handing changes to heirarchical fragments in a client-side application.</p></header><dl><dt class="spec type" id="type-tag"><a href="#type-tag" class="anchor"></a><code><span class="keyword">type</span> tag</code> = <code>[ </code><table class="variant"><tr id="type-tag.Lit" class="anchored"><td class="def constructor"><a href="#type-tag.Lit" class="anchor"></a><code>| </code><code>`Lit</code></td></tr><tr id="type-tag.Var" class="anchored"><td class="def constructor"><a href="#type-tag.Var" class="anchor"></a><code>| </code><code>`Var</code></td></tr></table><code> ]</code></dt><dd><p>The type tag for a path component. <code>`Lit</code> indiciates that the component should match exactly, while <code>`Var</code> indicates that the component can be anything and should be associated with the variable name provided in the tuple.</p></dd></dl><dl><dt class="spec type" id="type-typ"><a href="#type-typ" class="anchor"></a><code><span class="keyword">type</span> typ</code> = <code>[ </code><table class="variant"><tr id="type-typ.Prefix" class="anchored"><td class="def constructor"><a href="#type-typ.Prefix" class="anchor"></a><code>| </code><code>`Prefix</code></td></tr><tr id="type-typ.Exact" class="anchored"><td class="def constructor"><a href="#type-typ.Exact" class="anchor"></a><code>| </code><code>`Exact</code></td></tr></table><code> ]</code></dt><dd><p>The type of match for the route. <code>`Prefix</code> indicates that the route does not need to match the entirety of the path, while <code>`Exact</code> indicates an exact match.</p></dd></dl><dl><dt class="spec type" id="type-assoc"><a href="#type-assoc" class="anchor"></a><code><span class="keyword">type</span> assoc</code><code> = (string * string) list</code></dt><dd><p>Type alias for an association list of <code>string</code> to <code>string</code></p></dd></dl><dl><dt class="spec type" id="type-route"><a href="#type-route" class="anchor"></a><code><span class="keyword">type</span> 'a route</code><code> = (<a href="index.html#type-tag">tag</a> * string) list * <a href="index.html#type-typ">typ</a> * (<a href="index.html#type-assoc">assoc</a> <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> <span class="type-var">'a</span>)</code></dt><dd><p>The type of a route. The first tuple element specifies the matching rules for the path components, with the tag indicating the type of match. The interpretation of the corresponding string depends on the tag provided: for <code>(`Lit, lit)</code>, the path component must match the string <code>lit</code> exactly; for <code>(`Var, name)</code>, the path component can be anything and will be associated with <code>name</code> in the event of a successful match.</p><p>The second component of the tuple indicates the type of match that this route support, which can be either a prefix match (indicated by the <code>`Prefix</code> variant), or an exact match (indicated by the <code>`Exact</code> variant).</p><p>The third and final component is the handler function. On a successful route match, the matching information will be passed to the handler to produce a value of tyoe <code>'a</code> that will be returned.</p></dd></dl><dl><dt class="spec value" id="val-dispatch"><a href="#val-dispatch" class="anchor"></a><code><span class="keyword">val</span> dispatch : <span class="type-var">'a</span> <a href="index.html#type-route">route</a> list <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="../../result/Result/index.html#type-result">Result.result</a></code></dt><dt class="spec value" id="val-dispatch_exn"><a href="#val-dispatch_exn" class="anchor"></a><code><span class="keyword">val</span> dispatch_exn : <span class="type-var">'a</span> <a href="index.html#type-route">route</a> list <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>dispatch routes path</code> iterates through <code>routes</code> and selects the first one that matches <code>path</code>. It then applies the route handler to any component mappings and trailing path components (in the case of a prefix match) and returns the result. If none of the <code>routes</code> matches <code>path</code>, it will return an <code>Error</code> result.</p><p><code>dispatch_exn routes path</code> behaves just like <code>dispatch routes path</code> except will raise an exception using <code>failwith</code> in the case of no matches.</p></dd></dl><dl><dt class="spec value" id="val-to_dsl"><a href="#val-to_dsl" class="anchor"></a><code><span class="keyword">val</span> to_dsl : ((<a href="index.html#type-tag">tag</a> * string) list * <a href="index.html#type-typ">typ</a>) <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-of_dsl"><a href="#val-of_dsl" class="anchor"></a><code><span class="keyword">val</span> of_dsl : string <span>&#45;&gt;</span> (<a href="index.html#type-tag">tag</a> * string) list * <a href="index.html#type-typ">typ</a></code></dt><dd><p><code>to_dsl route_spec</code> is a string in the routing DSL that will beahve in the exact same way as <code>route_spec</code>.</p><p>A good way to become comfortable with the DSL is to load up this library in the REPL of your choice and translate route patterns to the DSL using the function <code>to_dsl</code>.</p></dd></dl><dl><dt class="spec module" id="module-DSL"><a href="#module-DSL" class="anchor"></a><code><span class="keyword">module</span> <a href="DSL/index.html">DSL</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A module that implements the dispatch operations for a DLS represented as a string literal. A more familiar interface for the Web world.</p></dd></dl></div></body></html>