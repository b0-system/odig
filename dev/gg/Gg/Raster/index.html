<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Raster (gg.Gg.Raster)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">gg</a> &#x00BB; <a href="../index.html">Gg</a> &#x00BB; Raster</nav><h1>Module <code>Gg.Raster</code></h1><p>Raster data.</p><p><b>WARNING.</b> This interface is subject to change in the future.</p><p>Raster data organizes data samples of any dimension in discrete 1D, 2D (images) or 3D space.</p><p>A sample has a <a href="Sample/index.html#type-semantics"><span><em>semantics</em></span></a> that defines its dimension and the meaning of its <em>components</em>. For example a 4D sample could represent a linear sRGBA sample. Samples are stored in a <a href="index.html#val-buffer"><span>linear buffer</span></a> of <em>scalars</em> of a given <a href="../Ba/index.html#type-scalar_type"><span>type</span></a>. A sample can use one scalar per component, can be packed in a single scalar or may have no direct obvious relationship to buffer scalars (compressed data). The <a href="Sample/index.html#type-format"><span>sample format</span></a> defines the semantics and scalar storage of a sample.</p><p>A <a href="index.html#type-t"><span><em>raster data</em></span></a> value is a collection of samples indexed by width, height and depth (i.e. x, y, z) stored in a buffer. It defines the sample data, the extents of the index and the sample format. The optional <a href="index.html#val-res"><span>resolution</span></a> in samples per meters of a raster data can specify its physical dimension.</p><p><b>Spatial convention.</b> If the sample index has to be interpreted spatially. It must be interpreted relative to the origin of a right-handed coordinate system. This means that the first sample, indexed by <code>(0,0,0)</code> is the bottom-left backmost sample (bottom-left sample for a 2D image).</p><p><b>Index sizes.</b> Index sizes are specified using <a href="../index.html#sizes"><span>size</span></a> types which are made of floats as it is more pratical in most scenarios. These floats should however be <em>integral</em> floats. The function <a href="index.html#val-v"><code>v</code></a>, <a href="Sample/index.html#val-scalar_count"><code>Sample.scalar_count</code></a> and <a href="index.html#val-sub"><code>sub</code></a> ensure this by applying <a href="../Float/index.html#val-round"><code>Float.round</code></a> to these values. This means that the <a href="index.html#rsize"><span>raster size functions</span></a> when called with <code>meters = false</code> will always return sizes that are integral floats that you can convert to integers safely without having to think about rounding issues. Note also that index sizes are always strictly positive.</p><nav class="toc"><ul><li><a href="#samples">Sample semantics and formats</a></li><li><a href="#raster">Raster data</a></li><li><a href="#rsize">Raster sizes and boxes</a></li><li><a href="#functions">Functions</a></li><li><a href="#preds">Predicates and comparisons</a></li><li><a href="#printers">Printers</a></li><li><a href="#resolution">Default resolution and conversions</a></li></ul></nav></header><section><header><h2 id="samples"><a href="#samples" class="anchor"></a>Sample semantics and formats</h2></header><dl><dt class="spec module" id="module-Sample"><a href="#module-Sample" class="anchor"></a><code><span class="keyword">module</span> <a href="Sample/index.html">Sample</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Sample semantics and formats.</p></dd></dl></section><section><header><h2 id="raster"><a href="#raster" class="anchor"></a>Raster data</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <a href="../index.html#type-raster">raster</a></code></dt><dd><p>The type for raster data.</p></dd></dl><dl><dt class="spec value" id="val-v"><a href="#val-v" class="anchor"></a><code><span class="keyword">val</span> v : ?&#8288;res:<a href="../index.html#type-v3">v3</a> <span>&#45;&gt;</span> ?&#8288;first:int <span>&#45;&gt;</span> ?&#8288;w_stride:int <span>&#45;&gt;</span> ?&#8288;h_stride:int <span>&#45;&gt;</span> [ `D1 of float | `D2 of <a href="../index.html#type-size2">size2</a> | `D3 of <a href="../index.html#type-size3">size3</a> ] <span>&#45;&gt;</span> <a href="Sample/index.html#type-format">Sample.format</a> <span>&#45;&gt;</span> <a href="../index.html#type-buffer">buffer</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>v res first w_stride h_stride size sf buf</code> is raster data with sample format <code>sf</code> and buffer <code>b</code>.</p><ul><li><code>size</code>, specify the index extents. height and depth if unspecified default to <code>1</code>. All extents must be strictly positive.</li><li><code>first</code>, <em>buffer scalar</em> index where the data of the first sample is stored.</li><li><code>w_stride</code>, number of <em>samples</em> (<b>not</b> buffer scalars) to skip to go from the first sample of a line to the first sample of the next line. Defaults to the index width.</li><li><code>h_stride</code>, number of <em>lines</em> to skip to go from the first line of a plane to the first line of the next plane. Defaults to the index height.</li><li><code>res</code>, is an optional sample resolution specification in samples per meters.</li></ul><p>For certain sample formats <code>first</code>, <code>w_stride</code> and <code>h_stride</code> can be used to specify subspaces in the collection of samples, see <a href="index.html#val-sub"><code>sub</code></a>.</p><p>The function <a href="index.html#val-scalar_strides"><code>scalar_strides</code></a> can be used to easily compute the linear buffer scalar index where a sample <code>(x,y,z)</code> starts.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the elements of <code>size</code> are not stricly positive, if <code>first</code> is negative, if <code>w_stride</code> or <code>h_stride</code> are smaller than the index width or height or if the scalar type of <code>sf</code> doesn't match <code>(Raster.buffer_scalar_type b)</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-res"><a href="#val-res" class="anchor"></a><code><span class="keyword">val</span> res : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-v3">v3</a> option</code></dt><dd><p><code>res r</code> is <code>r</code>'s resolution in sample per meters, if any.</p></dd></dl><dl><dt class="spec value" id="val-get_res"><a href="#val-get_res" class="anchor"></a><code><span class="keyword">val</span> get_res : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-v3">v3</a></code></dt><dd><p><code>get_res r</code> is <a href="index.html#val-res"><code>res</code></a> but </p><dl><dt>raises Invalid_argument</dt><dd><p>if there's no resolution.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-first"><a href="#val-first" class="anchor"></a><code><span class="keyword">val</span> first : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>first r</code> is the <em>buffer scalar</em> index where the first sample is stored.</p></dd></dl><dl><dt class="spec value" id="val-w_stride"><a href="#val-w_stride" class="anchor"></a><code><span class="keyword">val</span> w_stride : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>w_stride r</code> is the number of <em>samples</em> to skip to go from the first sample of a line to the first sample of the next line.</p></dd></dl><dl><dt class="spec value" id="val-h_stride"><a href="#val-h_stride" class="anchor"></a><code><span class="keyword">val</span> h_stride : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>h_stride r</code> is the number of <em>lines</em> to skip to go from the first line of a plane to the first line of the next plane.</p></dd></dl><dl><dt class="spec value" id="val-sample_format"><a href="#val-sample_format" class="anchor"></a><code><span class="keyword">val</span> sample_format : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Sample/index.html#type-format">Sample.format</a></code></dt><dd><p><code>sample_format r</code> is <code>r</code>'s sample format.</p></dd></dl><dl><dt class="spec value" id="val-buffer"><a href="#val-buffer" class="anchor"></a><code><span class="keyword">val</span> buffer : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-buffer">buffer</a></code></dt><dd><p><code>buffer r</code> is <code>r</code>'s format.</p></dd></dl></section><section><header><h2 id="rsize"><a href="#rsize" class="anchor"></a>Raster sizes and boxes</h2><p>In these functions have an optional <code>meter</code> argument that defaults to <code>false</code>. If <code>false</code> the result is in integral number of <em>samples</em>. If <code>true</code> the result is in <em>meters</em> according to the rasters' <a href="index.html#val-res"><span>resolution</span></a>. If the raster has no resolution, <a href="index.html#val-res_default"><code>Raster.res_default</code></a> is used in all dimensions.</p></header><dl><dt class="spec value" id="val-wi"><a href="#val-wi" class="anchor"></a><code><span class="keyword">val</span> wi : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>wi r</code> is <code>r</code>'s index width in number of samples.</p></dd></dl><dl><dt class="spec value" id="val-hi"><a href="#val-hi" class="anchor"></a><code><span class="keyword">val</span> hi : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>hi r</code> is <code>r</code>'s index height in number of samples.</p></dd></dl><dl><dt class="spec value" id="val-di"><a href="#val-di" class="anchor"></a><code><span class="keyword">val</span> di : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>d r</code> is <code>r</code>'s index height in number of samples.</p></dd></dl><dl><dt class="spec value" id="val-w"><a href="#val-w" class="anchor"></a><code><span class="keyword">val</span> w : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>w r</code> is <code>r</code>'s index width.</p></dd></dl><dl><dt class="spec value" id="val-h"><a href="#val-h" class="anchor"></a><code><span class="keyword">val</span> h : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>h r</code> is <code>r</code>'s index height.</p></dd></dl><dl><dt class="spec value" id="val-d"><a href="#val-d" class="anchor"></a><code><span class="keyword">val</span> d : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>d r</code> is <code>r</code>'s index depth.</p></dd></dl><dl><dt class="spec value" id="val-size1"><a href="#val-size1" class="anchor"></a><code><span class="keyword">val</span> size1 : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-size1">size1</a></code></dt><dd><p><code>size1 r</code> is <code>r</code>'s index width.</p></dd></dl><dl><dt class="spec value" id="val-size2"><a href="#val-size2" class="anchor"></a><code><span class="keyword">val</span> size2 : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-size2">size2</a></code></dt><dd><p><code>size2 r</code> is <code>r</code>'s index width and height.</p></dd></dl><dl><dt class="spec value" id="val-size3"><a href="#val-size3" class="anchor"></a><code><span class="keyword">val</span> size3 : ?&#8288;meters:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-size3">size3</a></code></dt><dd><p><code>size3 r</code> is <code>r</code>'s index width, height and depth.</p></dd></dl><dl><dt class="spec value" id="val-box1"><a href="#val-box1" class="anchor"></a><code><span class="keyword">val</span> box1 : ?&#8288;meters:bool <span>&#45;&gt;</span> ?&#8288;mid:bool <span>&#45;&gt;</span> ?&#8288;o:float <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-box1">box1</a></code></dt><dd><p><code>box1 meters mid o r</code> is a box with origin <code>o</code> and size <code>(size1
      meters r)</code>. If <code>mid</code> is <code>true</code> (defaults to <code>false</code>), <code>o</code> specifies the mid point of the box. <code>o</code> defaults to 0.</p></dd></dl><dl><dt class="spec value" id="val-box2"><a href="#val-box2" class="anchor"></a><code><span class="keyword">val</span> box2 : ?&#8288;meters:bool <span>&#45;&gt;</span> ?&#8288;mid:bool <span>&#45;&gt;</span> ?&#8288;o:<a href="../index.html#type-p2">p2</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-box2">box2</a></code></dt><dd><p><code>box2 meters mid o r</code> is a box with origin <code>o</code> and size <code>(size2
      meters r)</code>. If <code>mid</code> is <code>true</code> (defaults to <code>false</code>), <code>o</code> specifies the mid point of the box. <code>o</code> defaults to <a href="../P2/index.html#val-o"><code>P2.o</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-box3"><a href="#val-box3" class="anchor"></a><code><span class="keyword">val</span> box3 : ?&#8288;meters:bool <span>&#45;&gt;</span> ?&#8288;mid:bool <span>&#45;&gt;</span> ?&#8288;o:<a href="../index.html#type-p3">p3</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-box3">box3</a></code></dt><dd><p><code>box3 meters mid o r</code> is a box with origin <code>o</code> and size <code>(size3 meters r)</code>. If <code>mid</code> is <code>true</code> (defaults to <code>false</code>), <code>o</code> specifies the mid point of the box. <code>o</code> defaults to <a href="../P3/index.html#val-o"><code>P3.o</code></a>.</p></dd></dl></section><section><header><h2 id="functions"><a href="#functions" class="anchor"></a>Functions</h2></header><dl><dt class="spec value" id="val-dim"><a href="#val-dim" class="anchor"></a><code><span class="keyword">val</span> dim : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>dim r</code> is <code>r</code>'s index dimension from 1 to 3. Note that this is not derived from the case size given to <a href="index.html#val-v"><code>v</code></a> for creating <code>r</code>. It is derived from the size <code>(w,h,d)</code> as follows: <code>(w,1,1)</code> means 1, <code>(w,h,1)</code> with <code>h &gt; 1</code> means 2, <code>(w,h,d)</code> with <code>h,d &gt; 1</code> means 3.</p></dd></dl><dl><dt class="spec value" id="val-kind"><a href="#val-kind" class="anchor"></a><code><span class="keyword">val</span> kind : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `D1 | `D2 | `D3 ]</code></dt><dd><p><code>kind r</code> is like <a href="index.html#val-dim"><code>dim</code></a> but symbolically.</p></dd></dl><dl><dt class="spec value" id="val-sub"><a href="#val-sub" class="anchor"></a><code><span class="keyword">val</span> sub : [ `D1 of <a href="../index.html#type-box1">box1</a> | `D2 of <a href="../index.html#type-box2">box2</a> | `D3 of <a href="../index.html#type-box3">box3</a> ] <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>sub region</code> is a raster corresponding to a subset of the index of <code>r</code>. Both <code>r</code> and the resulting raster share the same buffer. The integral origin of the box defines the new sample origin of the raster data and its integral size the new size of the index.</p><p>If the dimension of the box is smaller than the raster the result is in the first line (<code>y = 0</code>) and/or layer (<code>z = 0</code>) of the raster <code>r</code>.</p><dl><dt>raises Invalid_argument,</dt><dd><p>if the sample format of <code>r</code> is packed, if the origin is out of bounds or if new size is larger than <code>r</code>'s size.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-scalar_strides"><a href="#val-scalar_strides" class="anchor"></a><code><span class="keyword">val</span> scalar_strides : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int * int * int</code></dt><dd><p><code>scalar_strides r</code> is <code>(x_stride, y_stride, z_stride)</code> where</p><ul><li><code>x_stride</code> is the number of buffer scalars from sample to sample.</li><li><code>y_stride</code> is the number of buffer scalars from line to line.</li><li><code>z_stride</code> is the number of buffer scalars from plane to plane.</li></ul><p>The buffer index where the sample <code>(x,y,z)</code> starts is given by:</p><pre><code class="ml">(Raster.first r) + z * z_stride + y * y_stride + x * x_stride</code></pre><dl><dt>raises Invalid_argument</dt><dd><p>if the sample format of <code>r</code> is packed.</p></dd></dl></dd></dl></section><section><header><h2 id="preds"><a href="#preds" class="anchor"></a>Predicates and comparisons</h2></header><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal r r'</code> is <code>r = r'</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare r r'</code> is <code>Pervasives.compare r r'</code>.</p></dd></dl></section><section><header><h2 id="printers"><a href="#printers" class="anchor"></a>Printers</h2></header><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp ppf t</code> prints a textual represenation of <code>t</code> on <code>ppf</code>. Doesn't print the buffer samples.</p></dd></dl></section><section><header><h2 id="resolution"><a href="#resolution" class="anchor"></a>Default resolution and conversions</h2></header><dl><dt class="spec value" id="val-res_default"><a href="#val-res_default" class="anchor"></a><code><span class="keyword">val</span> res_default : float</code></dt><dd><p><code>res_default</code> is 11811spm (300spi).</p></dd></dl><dl><dt class="spec value" id="val-spm_of_spi"><a href="#val-spm_of_spi" class="anchor"></a><code><span class="keyword">val</span> spm_of_spi : float <span>&#45;&gt;</span> float</code></dt><dd><p><code>spm_of_spi spi</code> is the samples per meter corresponding to the samples per inch <code>spi</code>.</p></dd></dl><dl><dt class="spec value" id="val-spm_to_spi"><a href="#val-spm_to_spi" class="anchor"></a><code><span class="keyword">val</span> spm_to_spi : float <span>&#45;&gt;</span> float</code></dt><dd><p><code>spm_to_spi spm</code> is the samples per inch corresponding to the samples per meters <code>spm</code>.</p></dd></dl></section></div></body></html>