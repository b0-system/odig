<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Foreign (ctypes.Foreign)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ctypes</a> &#x00BB; Foreign</nav><h1>Module <code>Foreign</code></h1><p>High-level bindings for C functions and values</p></header><dl><dt class="spec value" id="val-foreign"><a href="#val-foreign" class="anchor"></a><code><span class="keyword">val</span> foreign : ?&#8288;abi:<a href="../Libffi_abi/index.html#type-abi">Libffi_abi.abi</a> <span>&#45;&gt;</span> ?&#8288;from:<a href="../Dl/index.html#type-library">Dl.library</a> <span>&#45;&gt;</span> ?&#8288;stub:bool <span>&#45;&gt;</span> ?&#8288;check_errno:bool <span>&#45;&gt;</span> ?&#8288;release_runtime_lock:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <a href="../Ctypes/index.html#type-fn">Ctypes.fn</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>foreign name typ</code> exposes the C function of type <code>typ</code> named by <code>name</code> as an OCaml value.</p><p>The argument <code>?from</code>, if supplied, is a library handle returned by <a href="../Dl/index.html#val-dlopen"><code>Dl.dlopen</code></a>.</p><p>The argument <code>?stub</code>, if <code>true</code> (defaults to <code>false</code>), indicates that the function should not raise an exception if <code>name</code> is not found but return an OCaml value that raises an exception when called.</p><p>The value <code>?check_errno</code>, which defaults to <code>false</code>, indicates whether <a href="../../ocaml/Unix/index.html#exception-Unix_error"><code>Unix.Unix_error</code></a> should be raised if the C function modifies <code>errno</code>. Please note that a function that succeeds is allowed to change errno. So use this option with caution.</p><p>The value <code>?release_runtime_lock</code>, which defaults to <code>false</code>, indicates whether the OCaml runtime lock should be released during the call to the C function, allowing other threads to run. If the runtime lock is released then the C function must not access OCaml heap objects, such as arguments passed using <a href="../Ctypes/index.html#val-ocaml_string"><code>Ctypes.ocaml_string</code></a> and <a href="../Ctypes/index.html#val-ocaml_bytes"><code>Ctypes.ocaml_bytes</code></a>, and must not call back into OCaml.</p><dl><dt>raises Dl.DL_error</dt><dd><p>if <code>name</code> is not found in <code>?from</code> and <code>?stub</code> is <code>false</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-foreign_value"><a href="#val-foreign_value" class="anchor"></a><code><span class="keyword">val</span> foreign_value : ?&#8288;from:<a href="../Dl/index.html#type-library">Dl.library</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../Ctypes/index.html#type-typ">Ctypes.typ</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../Ctypes/index.html#type-ptr">Ctypes.ptr</a></code></dt><dd><p><code>foreign_value name typ</code> exposes the C value of type <code>typ</code> named by <code>name</code> as an OCaml value. The argument <code>?from</code>, if supplied, is a library handle returned by <a href="../Dl/index.html#val-dlopen"><code>Dl.dlopen</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-funptr"><a href="#val-funptr" class="anchor"></a><code><span class="keyword">val</span> funptr : ?&#8288;abi:<a href="../Libffi_abi/index.html#type-abi">Libffi_abi.abi</a> <span>&#45;&gt;</span> ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;check_errno:bool <span>&#45;&gt;</span> ?&#8288;runtime_lock:bool <span>&#45;&gt;</span> ?&#8288;thread_registration:bool <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <a href="../Ctypes/index.html#type-fn">Ctypes.fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <a href="../Ctypes/index.html#type-typ">Ctypes.typ</a></code></dt><dd><p>Construct a function pointer type from a function type.</p><p>The ctypes library, like C itself, distinguishes functions and function pointers. Functions are not first class: it is not possible to use them as arguments or return values of calls, or store them in addressable memory. Function pointers are first class, and so have none of these restrictions.</p><p>The value <code>?check_errno</code>, which defaults to <code>false</code>, indicates whether <a href="../../ocaml/Unix/index.html#exception-Unix_error"><code>Unix.Unix_error</code></a> should be raised if the C function modifies <code>errno</code>.</p><p>The value <code>?runtime_lock</code>, which defaults to <code>false</code>, indicates whether the OCaml runtime lock should be released during the call to the C function, allowing other threads to run. If the runtime lock is released then the C function must not access OCaml heap objects, such as arguments passed using <a href="../Ctypes/index.html#val-ocaml_string"><code>Ctypes.ocaml_string</code></a> and <a href="../Ctypes/index.html#val-ocaml_bytes"><code>Ctypes.ocaml_bytes</code></a>, and must not call back into OCaml. If the function pointer is used to call into OCaml from C then the <code>?runtime_lock</code> argument indicates whether the lock should be acquired and held during the call.</p><dl><dt>raises Dl.DL_error</dt><dd><p>if <code>name</code> is not found in <code>?from</code> and <code>?stub</code> is <code>false</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-funptr_opt"><a href="#val-funptr_opt" class="anchor"></a><code><span class="keyword">val</span> funptr_opt : ?&#8288;abi:<a href="../Libffi_abi/index.html#type-abi">Libffi_abi.abi</a> <span>&#45;&gt;</span> ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;check_errno:bool <span>&#45;&gt;</span> ?&#8288;runtime_lock:bool <span>&#45;&gt;</span> ?&#8288;thread_registration:bool <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <a href="../Ctypes/index.html#type-fn">Ctypes.fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) option <a href="../Ctypes/index.html#type-typ">Ctypes.typ</a></code></dt><dd><p>Construct a function pointer type from a function type.</p><p>This behaves like <a href="index.html#val-funptr"><code>funptr</code></a>, except that null pointers appear in OCaml as <code>None</code>.</p></dd></dl><dl><dt class="spec exception" id="exception-CallToExpiredClosure"><a href="#exception-CallToExpiredClosure" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">CallToExpiredClosure</span></code></dt><dd><p>A closure passed to C was collected by the OCaml garbage collector before it was called.</p></dd></dl></div></body></html>