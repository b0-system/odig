<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Observer (core_kernel.Core_kernel.Quickcheck_intf.Observer)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">core_kernel</a> &#x00BB; <a href="../../index.html">Core_kernel</a> &#x00BB; <a href="../index.html">Quickcheck_intf</a> &#x00BB; Observer</nav><h1>Module type <code>Quickcheck_intf.Observer</code></h1></header><aside><p>An <code>'a Quickcheck.Observer.t</code> represents a hash function on <code>'a</code>. Observers are used to construct distributions of random functions; see <code>Quickcheck.Generator.fn</code>.</p><p>Like generators, observers have a <code>~size</code> argument that is threaded through to bound the depth of recursion in potentially infinite cases. For finite values, <code>size</code> can be ignored.</p><p>For hashable types, one can construct an observer using <code>of_hash</code>. For other types, use the built-in observers and observer combinators below, or use <code>create</code> directly.</p></aside><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> -'a t</code></dt><dt class="spec type" id="type-gen"><a href="#type-gen" class="anchor"></a><code><span class="keyword">type</span> +'a gen</code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : (<span class="type-var">'a</span> <span>&#45;&gt;</span> size:<a href="../../../Core_kernel__/Import/index.html#type-int">Core_kernel__.Import.int</a> <span>&#45;&gt;</span> <a href="../../../../base/Base/Hash/index.html#type-state">Core_kernel__.Import.Hash.state</a> <span>&#45;&gt;</span> <a href="../../../../base/Base/Hash/index.html#type-state">Core_kernel__.Import.Hash.state</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-observe"><a href="#val-observe" class="anchor"></a><code><span class="keyword">val</span> observe : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> size:<a href="../../../Core_kernel__/Import/index.html#type-int">Core_kernel__.Import.int</a> <span>&#45;&gt;</span> <a href="../../../../base/Base/Hash/index.html#type-state">Core_kernel__.Import.Hash.state</a> <span>&#45;&gt;</span> <a href="../../../../base/Base/Hash/index.html#type-state">Core_kernel__.Import.Hash.state</a></code></dt><dt class="spec value" id="val-of_hash"><a href="#val-of_hash" class="anchor"></a><code><span class="keyword">val</span> of_hash : (<span class="keyword">module</span> <a href="../module-type-Deriving_hash/index.html">Deriving_hash</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-Deriving_hash/index.html#type-t">t</a> = <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_hash</code> creates an observer for any hashable type.</p></dd></dl><dl><dt class="spec value" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span class="keyword">val</span> bool : <a href="../../../Core_kernel__/Import/index.html#type-bool">Core_kernel__.Import.bool</a> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-char"><a href="#val-char" class="anchor"></a><code><span class="keyword">val</span> char : <a href="../../../Core_kernel__/Import/index.html#type-char">Core_kernel__.Import.char</a> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-doubleton"><a href="#val-doubleton" class="anchor"></a><code><span class="keyword">val</span> doubleton : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="../../../Core_kernel__/Import/index.html#type-bool">Core_kernel__.Import.bool</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>doubleton f</code> maps values to two &quot;buckets&quot; (as described in <code>t</code> above), depending on whether they satisfy <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-enum"><a href="#val-enum" class="anchor"></a><code><span class="keyword">val</span> enum : <a href="../../../Core_kernel__/Import/index.html#type-int">Core_kernel__.Import.int</a> <span>&#45;&gt;</span> f:(<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="../../../Core_kernel__/Import/index.html#type-int">Core_kernel__.Import.int</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>enum n ~f</code> maps values to <code>n</code> buckets, where <code>f</code> produces the index for a bucket from <code>0</code> to <code>n-1</code> for each value.</p></dd></dl><dl><dt class="spec value" id="val-of_list"><a href="#val-of_list" class="anchor"></a><code><span class="keyword">val</span> of_list : <span class="type-var">'a</span> <a href="../../../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a> <span>&#45;&gt;</span> equal:(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="../../../Core_kernel__/Import/index.html#type-bool">Core_kernel__.Import.bool</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_list list ~equal</code> maps values in <code>list</code> to separate buckets, and compares observed values to the elements of <code>list</code> using <code>equal</code>.</p></dd></dl><dl><dt class="spec value" id="val-fixed_point"><a href="#val-fixed_point" class="anchor"></a><code><span class="keyword">val</span> fixed_point : (<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Fixed point observer for recursive types. For example:</p><pre><code class="ml">let sexp_obs =
  fixed_point (fun sexp_t -&gt;
    unmap (variant2 string (list sexp_t))
      ~f:(function
        | Sexp.Atom atom -&gt; `A atom
        | Sexp.List list -&gt; `B list))</code></pre></dd></dl><dl><dt class="spec value" id="val-recursive"><a href="#val-recursive" class="anchor"></a><code><span class="keyword">val</span> recursive : (<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-variant2"><a href="#val-variant2" class="anchor"></a><code><span class="keyword">val</span> variant2 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `A of <span class="type-var">'a</span> | `B of <span class="type-var">'b</span> ] <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-variant3"><a href="#val-variant3" class="anchor"></a><code><span class="keyword">val</span> variant3 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `A of <span class="type-var">'a</span> | `B of <span class="type-var">'b</span> | `C of <span class="type-var">'c</span> ] <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-variant4"><a href="#val-variant4" class="anchor"></a><code><span class="keyword">val</span> variant4 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `A of <span class="type-var">'a</span> | `B of <span class="type-var">'b</span> | `C of <span class="type-var">'c</span> | `D of <span class="type-var">'d</span> ] <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-variant5"><a href="#val-variant5" class="anchor"></a><code><span class="keyword">val</span> variant5 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `A of <span class="type-var">'a</span> | `B of <span class="type-var">'b</span> | `C of <span class="type-var">'c</span> | `D of <span class="type-var">'d</span> | `E of <span class="type-var">'e</span> ] <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-variant6"><a href="#val-variant6" class="anchor"></a><code><span class="keyword">val</span> variant6 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `A of <span class="type-var">'a</span> | `B of <span class="type-var">'b</span> | `C of <span class="type-var">'c</span> | `D of <span class="type-var">'d</span> | `E of <span class="type-var">'e</span> | `F of <span class="type-var">'f</span> ] <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-of_predicate"><a href="#val-of_predicate" class="anchor"></a><code><span class="keyword">val</span> of_predicate : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="../../../Core_kernel__/Import/index.html#type-bool">Core_kernel__.Import.bool</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_predicate t1 t2 ~f</code> combines <code>t1</code> and <code>t2</code>, where <code>t1</code> observes values that satisfy <code>f</code> and <code>t2</code> observes values that do not satisfy <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-comparison"><a href="#val-comparison" class="anchor"></a><code><span class="keyword">val</span> comparison : compare:(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="../../../Core_kernel__/Import/index.html#type-int">Core_kernel__.Import.int</a>) <span>&#45;&gt;</span> eq:<span class="type-var">'a</span> <span>&#45;&gt;</span> lt:<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> gt:<span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>comparison ~compare ~eq ~lt ~gt</code> combines observers <code>lt</code> and <code>gt</code>, where <code>lt</code> observes values less than <code>eq</code> according to <code>compare</code>, and <code>gt</code> observes values greater than <code>eq</code> according to <code>compare</code>.</p></dd></dl><dl><dt class="spec value" id="val-singleton"><a href="#val-singleton" class="anchor"></a><code><span class="keyword">val</span> singleton : <a href="../../../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a> <span>&#45;&gt;</span> <span class="type-var">_</span> <a href="index.html#type-t">t</a></code></dt><dd><p>maps all values to a single bucket.</p></dd></dl><dl><dt class="spec value" id="val-unmap"><a href="#val-unmap" class="anchor"></a><code><span class="keyword">val</span> unmap : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>unmap t ~f</code> applies <code>f</code> to values before observing them using <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-tuple2"><a href="#val-tuple2" class="anchor"></a><code><span class="keyword">val</span> tuple2 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-tuple3"><a href="#val-tuple3" class="anchor"></a><code><span class="keyword">val</span> tuple3 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-tuple4"><a href="#val-tuple4" class="anchor"></a><code><span class="keyword">val</span> tuple4 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-tuple5"><a href="#val-tuple5" class="anchor"></a><code><span class="keyword">val</span> tuple5 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-tuple6"><a href="#val-tuple6" class="anchor"></a><code><span class="keyword">val</span> tuple6 : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'e</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'f</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span> * <span class="type-var">'f</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-fn"><a href="#val-fn" class="anchor"></a><code><span class="keyword">val</span> fn : <span class="type-var">'a</span> <a href="index.html#type-gen">gen</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dd><p>Observer for function type. <code>fn gen t</code> observes a function by generating random inputs from <code>gen</code>, applying the function, and observing the output using <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-of_fun"><a href="#val-of_fun" class="anchor"></a><code><span class="keyword">val</span> of_fun : (<a href="../../../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_fun f</code> produces an observer that lazily applies <code>f</code>.</p><p>It is recommended that <code>f</code> should not do a lot of expensive work and should not be memoized. Instead, spread out the work of generating an observer over many <code>of_fun</code> calls combined with, e.g., <code>variant</code> or <code>tuple</code>. This allows lazily generated observers to be garbage collected after each test and the relevant portions cheaply recomputed in subsequent tests, rather than accumulating without bound over time.</p></dd></dl></div></body></html>