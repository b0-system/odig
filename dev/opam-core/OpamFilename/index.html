<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamFilename (opam-core.OpamFilename)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-core</a> &#x00BB; OpamFilename</nav><h1>Module <code>OpamFilename</code></h1><p>Higher level file and directory name manipulation AND file operations, wrappers on OpamSystem using the filename type</p><nav class="toc"><ul><li><a href="#locking">Locking</a></li></ul></nav></header><dl><dt class="spec module" id="module-Base"><a href="#module-Base" class="anchor"></a><code><span class="keyword">module</span> <a href="Base/index.html">Base</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Basenames</p></dd></dl><dl><dt class="spec module" id="module-Dir"><a href="#module-Dir" class="anchor"></a><code><span class="keyword">module</span> <a href="Dir/index.html">Dir</a> : <a href="../OpamStd/index.html#module-type-ABSTRACT">OpamStd.ABSTRACT</a></code></dt><dd><p>Directory names</p></dd></dl><dl><dt class="spec value" id="val-cwd"><a href="#val-cwd" class="anchor"></a><code><span class="keyword">val</span> cwd : unit <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a></code></dt><dd><p>Return the current working directory</p></dd></dl><dl><dt class="spec value" id="val-rmdir"><a href="#val-rmdir" class="anchor"></a><code><span class="keyword">val</span> rmdir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Remove a directory</p></dd></dl><dl><dt class="spec value" id="val-cleandir"><a href="#val-cleandir" class="anchor"></a><code><span class="keyword">val</span> cleandir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Cleans the contents of a directory, but keeps the directory in place.</p></dd></dl><dl><dt class="spec value" id="val-rmdir_cleanup"><a href="#val-rmdir_cleanup" class="anchor"></a><code><span class="keyword">val</span> rmdir_cleanup : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Removes an empty directory, as well as any empty leading path components</p></dd></dl><dl><dt class="spec value" id="val-mkdir"><a href="#val-mkdir" class="anchor"></a><code><span class="keyword">val</span> mkdir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Create a directory</p></dd></dl><dl><dt class="spec value" id="val-rec_dirs"><a href="#val-rec_dirs" class="anchor"></a><code><span class="keyword">val</span> rec_dirs : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> list</code></dt><dd><p>List the sub-directory recursively</p></dd></dl><dl><dt class="spec value" id="val-dir_is_empty"><a href="#val-dir_is_empty" class="anchor"></a><code><span class="keyword">val</span> dir_is_empty : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-dirs"><a href="#val-dirs" class="anchor"></a><code><span class="keyword">val</span> dirs : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> list</code></dt><dd><p>List the sub-directory (do not recurse)</p></dd></dl><dl><dt class="spec value" id="val-in_dir"><a href="#val-in_dir" class="anchor"></a><code><span class="keyword">val</span> in_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Evaluate a function in a given directory</p></dd></dl><dl><dt class="spec value" id="val-env_of_list"><a href="#val-env_of_list" class="anchor"></a><code><span class="keyword">val</span> env_of_list : (string * string) list <span>&#45;&gt;</span> string array</code></dt><dd><p>Turns an assoc list into an array suitable to be provided as environment</p></dd></dl><dl><dt class="spec value" id="val-exec"><a href="#val-exec" class="anchor"></a><code><span class="keyword">val</span> exec : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> ?&#8288;env:(string * string) list <span>&#45;&gt;</span> ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;metadata:(string * string) list <span>&#45;&gt;</span> ?&#8288;keep_going:bool <span>&#45;&gt;</span> string list list <span>&#45;&gt;</span> unit</code></dt><dd><p>Execute a list of commands in a given directory</p></dd></dl><dl><dt class="spec value" id="val-move_dir"><a href="#val-move_dir" class="anchor"></a><code><span class="keyword">val</span> move_dir : src:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> dst:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Move a directory</p></dd></dl><dl><dt class="spec value" id="val-copy_dir"><a href="#val-copy_dir" class="anchor"></a><code><span class="keyword">val</span> copy_dir : src:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> dst:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copy directory <code>src</code> to <code>dst</code>, that is, recursively copy the contents of <code>src</code> into <code>dst</code>, overwriting any existing files.</p></dd></dl><dl><dt class="spec value" id="val-link_dir"><a href="#val-link_dir" class="anchor"></a><code><span class="keyword">val</span> link_dir : target:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> link:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Link a directory</p></dd></dl><dl><dt class="spec value" id="val-exists_dir"><a href="#val-exists_dir" class="anchor"></a><code><span class="keyword">val</span> exists_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Does the directory exist?</p></dd></dl><dl><dt class="spec value" id="val-opt_dir"><a href="#val-opt_dir" class="anchor"></a><code><span class="keyword">val</span> opt_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> option</code></dt><dd><p>Returns the argument as option, if the directory exists</p></dd></dl><dl><dt class="spec value" id="val-dirname_dir"><a href="#val-dirname_dir" class="anchor"></a><code><span class="keyword">val</span> dirname_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a></code></dt><dd><p>Return the parent directory</p></dd></dl><dl><dt class="spec value" id="val-basename_dir"><a href="#val-basename_dir" class="anchor"></a><code><span class="keyword">val</span> basename_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Base/index.html#type-t">Base.t</a></code></dt><dd><p>Return the deeper directory name</p></dd></dl><dl><dt class="spec value" id="val-to_list_dir"><a href="#val-to_list_dir" class="anchor"></a><code><span class="keyword">val</span> to_list_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> list</code></dt><dd><p>Turn a full path into a list of directory names</p></dd></dl><dl><dt class="spec value" id="val-raw_dir"><a href="#val-raw_dir" class="anchor"></a><code><span class="keyword">val</span> raw_dir : string <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a></code></dt><dd><p>Creation from a raw string, without resolving symlinks etc.</p></dd></dl><dl><dt class="spec value" id="val-with_tmp_dir"><a href="#val-with_tmp_dir" class="anchor"></a><code><span class="keyword">val</span> with_tmp_dir : (<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Execute a function in a temp directory</p></dd></dl><dl><dt class="spec value" id="val-with_tmp_dir_job"><a href="#val-with_tmp_dir_job" class="anchor"></a><code><span class="keyword">val</span> with_tmp_dir_job : (<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../OpamProcess/index.html#type-job">OpamProcess.job</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../OpamProcess/index.html#type-job">OpamProcess.job</a></code></dt><dd><p>Provide an automatically cleaned up temp directory to a job</p></dd></dl><dl><dt class="spec value" id="val-concat_and_resolve"><a href="#val-concat_and_resolve" class="anchor"></a><code><span class="keyword">val</span> concat_and_resolve : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a></code></dt><dd><p>Create a new Dir.t and resolve symlinks</p></dd></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../OpamStd/index.html#module-type-ABSTRACT">OpamStd.ABSTRACT</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-of_string"><a href="#val-of_string" class="anchor"></a><code><span class="keyword">val</span> of_string : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val</span> to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-to_json"><a href="#val-to_json" class="anchor"></a><code><span class="keyword">val</span> to_json : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../OpamJson/index.html#type-t">OpamJson.t</a></code></dt></dl><div class="spec module" id="module-Set"><a href="#module-Set" class="anchor"></a><code><span class="keyword">module</span> <a href="Set/index.html">Set</a> : <a href="../OpamStd/index.html#module-type-SET">OpamStd.SET</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../OpamStd/module-type-SET/index.html#type-elt">elt</a> = <a href="index.html#type-t">t</a></code></div><div class="spec module" id="module-Map"><a href="#module-Map" class="anchor"></a><code><span class="keyword">module</span> <a href="Map/index.html">Map</a> : <a href="../OpamStd/index.html#module-type-MAP">OpamStd.MAP</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../OpamStd/module-type-MAP/index.html#type-key">key</a> = <a href="index.html#type-t">t</a></code></div></details></div></div></div><dl><dt class="spec type" id="type-generic_file"><a href="#type-generic_file" class="anchor"></a><code><span class="keyword">type</span> generic_file</code><code> = </code><table class="variant"><tr id="type-generic_file.D" class="anchored"><td class="def constructor"><a href="#type-generic_file.D" class="anchor"></a><code>| </code><code><span class="constructor">D</span> <span class="keyword">of</span> <a href="Dir/index.html#type-t">Dir.t</a></code></td></tr><tr id="type-generic_file.F" class="anchored"><td class="def constructor"><a href="#type-generic_file.F" class="anchor"></a><code>| </code><code><span class="constructor">F</span> <span class="keyword">of</span> <a href="index.html#type-t">t</a></code></td></tr></table></dt><dd><p>Generic filename</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Base/index.html#type-t">Base.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Create a filename from a Dir.t and a basename</p></dd></dl><dl><dt class="spec value" id="val-of_basename"><a href="#val-of_basename" class="anchor"></a><code><span class="keyword">val</span> of_basename : <a href="Base/index.html#type-t">Base.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Create a file from a basename and the current working directory as dirname</p></dd></dl><dl><dt class="spec value" id="val-raw"><a href="#val-raw" class="anchor"></a><code><span class="keyword">val</span> raw : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Creation from a raw string, without resolving symlinks, etc.</p></dd></dl><dl><dt class="spec value" id="val-prettify"><a href="#val-prettify" class="anchor"></a><code><span class="keyword">val</span> prettify : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Prettify a filename:</p><ul><li>replace /path/to/opam/foo by &lt;opam&gt;/foo</li><li>replace /path/to/home/foo by ~/foo</li></ul></dd></dl><dl><dt class="spec value" id="val-prettify_dir"><a href="#val-prettify_dir" class="anchor"></a><code><span class="keyword">val</span> prettify_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Prettify a dirname.</p></dd></dl><dl><dt class="spec value" id="val-dirname"><a href="#val-dirname" class="anchor"></a><code><span class="keyword">val</span> dirname : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a></code></dt><dd><p>Return the directory name</p></dd></dl><dl><dt class="spec value" id="val-basename"><a href="#val-basename" class="anchor"></a><code><span class="keyword">val</span> basename : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Base/index.html#type-t">Base.t</a></code></dt><dd><p>Return the base name</p></dd></dl><dl><dt class="spec value" id="val-read"><a href="#val-read" class="anchor"></a><code><span class="keyword">val</span> read : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Retrieves the contents from the hard disk.</p></dd></dl><dl><dt class="spec value" id="val-open_in"><a href="#val-open_in" class="anchor"></a><code><span class="keyword">val</span> open_in : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/index.html#type-in_channel">Stdlib.in_channel</a></code></dt><dd><p>Open a channel from a given file.</p></dd></dl><dl><dt class="spec value" id="val-open_out"><a href="#val-open_out" class="anchor"></a><code><span class="keyword">val</span> open_out : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/index.html#type-out_channel">Stdlib.out_channel</a></code></dt><dt class="spec value" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val</span> remove : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Removes everything in <code>filename</code> if existed.</p></dd></dl><dl><dt class="spec value" id="val-write"><a href="#val-write" class="anchor"></a><code><span class="keyword">val</span> write : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Removes everything in <code>filename</code> if existed, then write <code>contents</code> instead.</p></dd></dl><dl><dt class="spec value" id="val-exists"><a href="#val-exists" class="anchor"></a><code><span class="keyword">val</span> exists : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns true if the file exists and is a regular file or a symlink to one</p></dd></dl><dl><dt class="spec value" id="val-opt_file"><a href="#val-opt_file" class="anchor"></a><code><span class="keyword">val</span> opt_file : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> option</code></dt><dd><p>Returns the argument as option if it exists and is either a regular file or a symlink to one</p></dd></dl><dl><dt class="spec value" id="val-check_suffix"><a href="#val-check_suffix" class="anchor"></a><code><span class="keyword">val</span> check_suffix : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a file has a given suffix</p></dd></dl><dl><dt class="spec value" id="val-add_extension"><a href="#val-add_extension" class="anchor"></a><code><span class="keyword">val</span> add_extension : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Adds a dot and the given file extension</p></dd></dl><dl><dt class="spec value" id="val-chop_extension"><a href="#val-chop_extension" class="anchor"></a><code><span class="keyword">val</span> chop_extension : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Remove the file extension</p></dd></dl><dl><dt class="spec value" id="val-rec_files"><a href="#val-rec_files" class="anchor"></a><code><span class="keyword">val</span> rec_files : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p>List all the filenames, recursively</p></dd></dl><dl><dt class="spec value" id="val-files"><a href="#val-files" class="anchor"></a><code><span class="keyword">val</span> files : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p>List all the filename. Do not recurse.</p></dd></dl><dl><dt class="spec value" id="val-with_contents"><a href="#val-with_contents" class="anchor"></a><code><span class="keyword">val</span> with_contents : (string <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Apply a function on the contents of a file</p></dd></dl><dl><dt class="spec value" id="val-copy_in"><a href="#val-copy_in" class="anchor"></a><code><span class="keyword">val</span> copy_in : ?&#8288;root:<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copy a file in a directory. If <code>root</code> is set, copy also the sub-directories. For instance, <code>copy_in ~root:&quot;/foo&quot; &quot;/foo/bar/gni&quot;
    &quot;/toto&quot;</code> creates <code>&quot;/toto/bar/gni&quot;</code>.</p></dd></dl><dl><dt class="spec value" id="val-move"><a href="#val-move" class="anchor"></a><code><span class="keyword">val</span> move : src:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dst:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Move a file</p></dd></dl><dl><dt class="spec value" id="val-readlink"><a href="#val-readlink" class="anchor"></a><code><span class="keyword">val</span> readlink : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Read a symlinked file</p></dd></dl><dl><dt class="spec value" id="val-is_symlink"><a href="#val-is_symlink" class="anchor"></a><code><span class="keyword">val</span> is_symlink : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Is a symlink?</p></dd></dl><dl><dt class="spec value" id="val-is_symlink_dir"><a href="#val-is_symlink_dir" class="anchor"></a><code><span class="keyword">val</span> is_symlink_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-is_exec"><a href="#val-is_exec" class="anchor"></a><code><span class="keyword">val</span> is_exec : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Is an executable?</p></dd></dl><dl><dt class="spec value" id="val-copy"><a href="#val-copy" class="anchor"></a><code><span class="keyword">val</span> copy : src:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dst:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Copy a file</p></dd></dl><dl><dt class="spec value" id="val-install"><a href="#val-install" class="anchor"></a><code><span class="keyword">val</span> install : ?&#8288;exec:bool <span>&#45;&gt;</span> src:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dst:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Installs a file to a destination. Optionnally set if the destination should be set executable</p></dd></dl><dl><dt class="spec value" id="val-link"><a href="#val-link" class="anchor"></a><code><span class="keyword">val</span> link : ?&#8288;relative:bool <span>&#45;&gt;</span> target:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> link:<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Symlink a file. If symlink is not possible on the system, use copy instead. With <code>relative</code>, creates a relative link through the closest common ancestor directory if possible. Otherwise, the symlink is absolute.</p></dd></dl><dl><dt class="spec value" id="val-is_archive"><a href="#val-is_archive" class="anchor"></a><code><span class="keyword">val</span> is_archive : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns true if the given file is an archive (zip or tar)</p></dd></dl><dl><dt class="spec value" id="val-extract"><a href="#val-extract" class="anchor"></a><code><span class="keyword">val</span> extract : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Extract an archive in a given directory (it rewrites the root to match <code>Dir.t</code> dir if needed)</p></dd></dl><dl><dt class="spec value" id="val-extract_job"><a href="#val-extract_job" class="anchor"></a><code><span class="keyword">val</span> extract_job : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> exn option <a href="../OpamProcess/index.html#type-job">OpamProcess.job</a></code></dt><dd><p>Same as <code>extract</code>, as an OpamProcess.job</p></dd></dl><dl><dt class="spec value" id="val-extract_in"><a href="#val-extract_in" class="anchor"></a><code><span class="keyword">val</span> extract_in : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Extract an archive in a given directory</p></dd></dl><dl><dt class="spec value" id="val-extract_in_job"><a href="#val-extract_in_job" class="anchor"></a><code><span class="keyword">val</span> extract_in_job : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> exn option <a href="../OpamProcess/index.html#type-job">OpamProcess.job</a></code></dt><dt class="spec value" id="val-extract_generic_file"><a href="#val-extract_generic_file" class="anchor"></a><code><span class="keyword">val</span> extract_generic_file : <a href="index.html#type-generic_file">generic_file</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Extract a generic file</p></dd></dl><dl><dt class="spec value" id="val-starts_with"><a href="#val-starts_with" class="anchor"></a><code><span class="keyword">val</span> starts_with : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a filename starts by a given Dir.t</p></dd></dl><dl><dt class="spec value" id="val-ends_with"><a href="#val-ends_with" class="anchor"></a><code><span class="keyword">val</span> ends_with : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a filename ends with a given suffix</p></dd></dl><dl><dt class="spec value" id="val-dir_starts_with"><a href="#val-dir_starts_with" class="anchor"></a><code><span class="keyword">val</span> dir_starts_with : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>dir starts_with pfx dir</code> Check whether <code>dir</code> starts with <code>pfx</code></p></dd></dl><dl><dt class="spec value" id="val-dir_ends_with"><a href="#val-dir_ends_with" class="anchor"></a><code><span class="keyword">val</span> dir_ends_with : string <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a dirname ends with a given suffix</p></dd></dl><dl><dt class="spec value" id="val-remove_prefix"><a href="#val-remove_prefix" class="anchor"></a><code><span class="keyword">val</span> remove_prefix : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Remove a prefix from a file name</p></dd></dl><dl><dt class="spec value" id="val-remove_prefix_dir"><a href="#val-remove_prefix_dir" class="anchor"></a><code><span class="keyword">val</span> remove_prefix_dir : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-remove_suffix"><a href="#val-remove_suffix" class="anchor"></a><code><span class="keyword">val</span> remove_suffix : <a href="Base/index.html#type-t">Base.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Remove a suffix from a filename</p></dd></dl><dl><dt class="spec value" id="val-patch"><a href="#val-patch" class="anchor"></a><code><span class="keyword">val</span> patch : ?&#8288;preprocess:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> exn option <a href="../OpamProcess/index.html#type-job">OpamProcess.job</a></code></dt><dd><p>Apply a patch in a directory. If <code>preprocess</code> is set to false, there is no CRLF translation. Returns <code>None</code> on success, the process error otherwise</p></dd></dl><dl><dt class="spec value" id="val-touch"><a href="#val-touch" class="anchor"></a><code><span class="keyword">val</span> touch : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Create an empty file</p></dd></dl><dl><dt class="spec value" id="val-chmod"><a href="#val-chmod" class="anchor"></a><code><span class="keyword">val</span> chmod : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>Change file permissions</p></dd></dl><dl><dt class="spec value" id="val-find_in_parents"><a href="#val-find_in_parents" class="anchor"></a><code><span class="keyword">val</span> find_in_parents : (<a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="Dir/index.html#type-t">Dir.t</a> option</code></dt><dd><p>Returns the closest parent of a directory (including itself) for which the predicate holds, if any</p></dd></dl><section><header><h3 id="locking"><a href="#locking" class="anchor"></a>Locking</h3></header><dl><dt class="spec value" id="val-flock"><a href="#val-flock" class="anchor"></a><code><span class="keyword">val</span> flock : [&lt; <a href="../OpamSystem/index.html#type-lock_flag">OpamSystem.lock_flag</a> ] <span>&#45;&gt;</span> ?&#8288;dontblock:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../OpamSystem/index.html#type-lock">OpamSystem.lock</a></code></dt><dd><p>See <code>OpamSystem.flock</code>. Prefer the higher level <code>with_flock</code> functions when possible</p></dd></dl><dl><dt class="spec value" id="val-with_flock"><a href="#val-with_flock" class="anchor"></a><code><span class="keyword">val</span> with_flock : [&lt; <a href="../OpamSystem/index.html#type-lock_flag">OpamSystem.lock_flag</a> ] <span>&#45;&gt;</span> ?&#8288;dontblock:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Calls <code>f</code> while holding a lock file. Ensures the lock is properly released on <code>f</code> exit. Raises <code>OpamSystem.Locked</code> if <code>dontblock</code> is set and the lock can't be acquired. <code>f</code> is passed the file_descr of the lock.</p></dd></dl><dl><dt class="spec value" id="val-with_flock_upgrade"><a href="#val-with_flock_upgrade" class="anchor"></a><code><span class="keyword">val</span> with_flock_upgrade : [&lt; <a href="../OpamSystem/index.html#type-actual_lock_flag">OpamSystem.actual_lock_flag</a> ] <span>&#45;&gt;</span> ?&#8288;dontblock:bool <span>&#45;&gt;</span> <a href="../OpamSystem/index.html#type-lock">OpamSystem.lock</a> <span>&#45;&gt;</span> (<a href="../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Calls <code>f</code> with the file lock upgraded to at least <code>flag</code>, then restores the previous lock level. Upgrade to <code>`Lock_write</code> should never be used in blocking mode as it would deadlock. Raises <code>OpamSystem.Locked</code> (but keeps the lock as is) if <code>dontblock</code> is set and the lock can't be upgraded.</p></dd></dl><dl><dt class="spec value" id="val-with_flock_write_then_read"><a href="#val-with_flock_write_then_read" class="anchor"></a><code><span class="keyword">val</span> with_flock_write_then_read : ?&#8288;dontblock:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Runs first function with a write lock on the given file, then releases it to a read lock and runs the second function.</p></dd></dl><div class="spec module" id="module-Op"><a href="#module-Op" class="anchor"></a><code><span class="keyword">module</span> <a href="Op/index.html">Op</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec module" id="module-Attribute"><a href="#module-Attribute" class="anchor"></a><code><span class="keyword">module</span> <a href="Attribute/index.html">Attribute</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Simple structure to hanle file attributes</p></dd></dl><dl><dt class="spec value" id="val-to_attribute"><a href="#val-to_attribute" class="anchor"></a><code><span class="keyword">val</span> to_attribute : <a href="Dir/index.html#type-t">Dir.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="Attribute/index.html#type-t">Attribute.t</a></code></dt><dd><p>Convert a filename to an attribute, relatively to a root</p></dd></dl></section></div></body></html>