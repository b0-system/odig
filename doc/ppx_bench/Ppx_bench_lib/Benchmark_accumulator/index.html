<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Benchmark_accumulator (ppx_bench.Ppx_bench_lib.Benchmark_accumulator)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">ppx_bench</a> &#x00BB; <a href="../index.html">Ppx_bench_lib</a> &#x00BB; Benchmark_accumulator</nav><header class="odoc-preamble"><h1>Module <code><span>Ppx_bench_lib.Benchmark_accumulator</span></code></h1><p>The point of <code>Benchmark_accumulator</code> is to provide a global place where inline benchmarking macros can register themselves. Once registered here, the benchmarks are retrieved and analyzed using <code>Core_bench</code>.</p><p>This module holds the registered benchmarks in a global hashtable indexed by library name. We care about the registered benchmarks if and only if the library is being used in a <code>inline_benchmarks_runner.exe</code>. To avoid building this hashtable in cases where we will not use it, this module peeks into the commandline args of the running program to decide if the benchmarks should be registered or not.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Current_libname" class="anchored"><a href="#module-Current_libname" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Current_libname/index.html">Current_libname</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Entry" class="anchored"><a href="#module-Entry" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Entry/index.html">Entry</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-add_environment_var" class="anchored"><a href="#val-add_environment_var" class="anchor"></a><code><span><span class="keyword">val</span> add_environment_var : bool</span></code></div><div class="spec-doc"><p><code>add_environment_var</code> returns true if the benchmarks should be added to the hashtable</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lookup_lib" class="anchored"><a href="#val-lookup_lib" class="anchor"></a><code><span><span class="keyword">val</span> lookup_lib : <span>libname:string <span class="arrow">&#45;&gt;</span></span> <span><a href="Entry/index.html#type-t">Entry.t</a> list</span></span></code></div><div class="spec-doc"><p><code>lookup_lib</code> returns all the benchmarks from the specified library</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_bench" class="anchored"><a href="#val-add_bench" class="anchor"></a><code><span><span class="keyword">val</span> add_bench : <span>name:string <span class="arrow">&#45;&gt;</span></span> <span>code:string <span class="arrow">&#45;&gt;</span></span> <span>filename:string <span class="arrow">&#45;&gt;</span></span>
<span>type_conv_path:string <span class="arrow">&#45;&gt;</span></span> <span>line:int <span class="arrow">&#45;&gt;</span></span> <span>startpos:int <span class="arrow">&#45;&gt;</span></span> <span>endpos:int <span class="arrow">&#45;&gt;</span></span> <span><a href="Entry/index.html#type-test_spec">Entry.test_spec</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>add_bench</code> registers benchmarks with the global hashtable maintained in <code>ppx_bench_lib</code>. This is meant to be called by the code generated for the BENCH and BENCH_INDEXED macros</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_bench_module" class="anchored"><a href="#val-add_bench_module" class="anchor"></a><code><span><span class="keyword">val</span> add_bench_module : <span>name:string <span class="arrow">&#45;&gt;</span></span> <span>code:string <span class="arrow">&#45;&gt;</span></span> <span>type_conv_path:string <span class="arrow">&#45;&gt;</span></span>
<span>filename:string <span class="arrow">&#45;&gt;</span></span> <span>line:int <span class="arrow">&#45;&gt;</span></span> <span>startpos:int <span class="arrow">&#45;&gt;</span></span> <span>endpos:int <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>add_bench_module</code> adds a bench module name to the benchmarks. This is called by BENCH_MODULE macro</p></div></div></div></body></html>