<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Blob (bin_prot.Bin_prot.Blob)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">bin_prot</a> &#x00BB; <a href="../index.html">Bin_prot</a> &#x00BB; Blob</nav><header class="odoc-preamble"><h1>Module <code><span>Bin_prot.Blob</span></code></h1></header><div class="odoc-content"><p><code>'a Blob.t</code> is type-equivalent to <code>'a</code>, but has different bin-prot serializers that prefix the representation with the size of <code>'a</code>.</p><p>To understand where this is useful, imagine we have an event type where many applications look at some parts of an event, but not all applications need to deal with all parts of an event. We might define:</p><pre><code>type 'a event =
  { time : Time.t
  ; source : string
  ; details : 'a
  } [@@deriving bin_io]</code></pre><p>Applications that need to understand all the details of an event could use:</p><pre><code>type concrete_event = Details.t Blob.t event [@@deriving bin_io] </code></pre><p>An application that filters events to downsteam consumers based on just <code>source</code> or <code>time</code> (but doesn't need to parse <code>details</code>) may use:</p><pre><code>type opaque_event = Blob.Opaque.Bigstring.t event [@@deriving bin_io] </code></pre><p>This has two advantages:</p><ul><li>(de)serializing messages is faster because potentially costly (de)serialization of <code>details</code> is avoided</li><li>the application can be compiled without any knowledge of any conrete <code>Details.t</code> type, so it's robust to changes in <code>Details.t</code></li></ul><p>An application that's happy to throw away <code>details</code> may use:</p><pre><code>type ignored_event = Blob.Ignored.t event [@@deriving bin_read] </code></pre><p>Whereas <code>opaque_event</code>s roundtrip, <code>ignored_event</code>s actually drop the bytes representing <code>details</code> when deserializing, and therefore do not roundtrip.</p><div class="odoc-spec"><div class="spec type" id="type-id" class="anchored"><a href="#type-id" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a id</span></span><span> = <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare" class="anchored"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../Binable/module-type-S1/index.html">Binable.S1</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="../Binable/module-type-S1/index.html#type-t">t</a></span> := <span><span class="type-var">'a</span> <a href="#type-id">id</a></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-bin_shape_t" class="anchored"><a href="#val-bin_shape_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_shape_t : <span><a href="../Shape/index.html#type-t">Shape.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Shape/index.html#type-t">Shape.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_size_t" class="anchored"><a href="#val-bin_size_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_size_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Size/index.html#type-sizer1">Size.sizer1</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_write_t" class="anchored"><a href="#val-bin_write_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_write_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Write/index.html#type-writer1">Write.writer1</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_read_t" class="anchored"><a href="#val-bin_read_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_read_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Read/index.html#type-reader1">Read.reader1</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-__bin_read_t__" class="anchored"><a href="#val-__bin_read_t__" class="anchor"></a><code><span><span class="keyword">val</span> __bin_read_t__ : <span><span>(<span class="type-var">'a</span>, <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Read/index.html#type-reader1">Read.reader1</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_writer_t" class="anchored"><a href="#val-bin_writer_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_writer_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Type_class/S1/index.html#type-writer">Type_class.S1.writer</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_reader_t" class="anchored"><a href="#val-bin_reader_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_reader_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Type_class/S1/index.html#type-reader">Type_class.S1.reader</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_t" class="anchored"><a href="#val-bin_t" class="anchor"></a><code><span><span class="keyword">val</span> bin_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="#type-id">id</a></span>)</span> <a href="../Type_class/S1/index.html#type-t">Type_class.S1.t</a></span></span></code></div></div></details></div><div class="odoc-spec"><div class="spec module" id="module-Opaque" class="anchored"><a href="#module-Opaque" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Opaque/index.html">Opaque</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An <code>Opaque.Bigstring.t</code> or <code>Opaque.String.t</code> is an arbitrary piece of bin-prot. The bin-prot (de-)serializers simply read/write the data, prefixed with its size.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Ignored" class="anchored"><a href="#module-Ignored" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Ignored/index.html">Ignored</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An <code>Ignored.t</code> is an unusable value with special bin-prot converters. The reader reads the size and drops that much data from the buffer. Writing is not supported, however the size of <code>t</code> is kept, so <code>bin_size_t</code> is available.</p></div></div></div></body></html>