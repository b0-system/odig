<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>RSA (cryptokit.Cryptokit.RSA)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cryptokit</a> &#x00BB; <a href="../index.html">Cryptokit</a> &#x00BB; RSA</nav><h1>Module <code>Cryptokit.RSA</code></h1><p>The <code>RSA</code> module implements RSA public-key cryptography. Public-key cryptography is asymmetric: two distinct keys are used for encrypting a message, then decrypting it. Moreover, while one of the keys must remain secret, the other can be made public, since it is computationally very hard to reconstruct the private key from the public key. This feature supports both public-key encryption (anyone can encode with the public key, but only the owner of the private key can decrypt) and digital signature (only the owner of the private key can sign, but anyone can check the signature with the public key).</p></header><dl><dt class="spec type" id="type-key"><a href="#type-key" class="anchor"></a><code><span class="keyword">type</span> key</code><code> = </code><code>{</code><table class="record"><tr id="type-key.size" class="anchored"><td class="def field"><a href="#type-key.size" class="anchor"></a><code>size : int;</code></td><td class="doc"><p>Size of the modulus <code>n</code>, in bits</p></td></tr><tr id="type-key.n" class="anchored"><td class="def field"><a href="#type-key.n" class="anchor"></a><code>n : string;</code></td><td class="doc"><p>Modulus <code>n = p.q</code></p></td></tr><tr id="type-key.e" class="anchored"><td class="def field"><a href="#type-key.e" class="anchor"></a><code>e : string;</code></td><td class="doc"><p>Public exponent <code>e</code></p></td></tr><tr id="type-key.d" class="anchored"><td class="def field"><a href="#type-key.d" class="anchor"></a><code>d : string;</code></td><td class="doc"><p>Private exponent <code>d</code></p></td></tr><tr id="type-key.p" class="anchored"><td class="def field"><a href="#type-key.p" class="anchor"></a><code>p : string;</code></td><td class="doc"><p>Prime factor <code>p</code> of <code>n</code></p></td></tr><tr id="type-key.q" class="anchored"><td class="def field"><a href="#type-key.q" class="anchor"></a><code>q : string;</code></td><td class="doc"><p>The other prime factor <code>q</code> of <code>n</code></p></td></tr><tr id="type-key.dp" class="anchored"><td class="def field"><a href="#type-key.dp" class="anchor"></a><code>dp : string;</code></td><td class="doc"><p><code>dp</code> is <code>d mod (p-1)</code></p></td></tr><tr id="type-key.dq" class="anchored"><td class="def field"><a href="#type-key.dq" class="anchor"></a><code>dq : string;</code></td><td class="doc"><p><code>dq</code> is <code>d mod (q-1)</code></p></td></tr><tr id="type-key.qinv" class="anchored"><td class="def field"><a href="#type-key.qinv" class="anchor"></a><code>qinv : string;</code></td><td class="doc"><p><code>qinv</code> is a multiplicative inverse of <code>q</code> modulo <code>p</code></p></td></tr></table><code>}</code></dt><dd><p>The type of RSA keys. Components <code>size</code>, <code>n</code> and <code>e</code> define the public part of the key. Components <code>size</code>, <code>n</code> and <code>d</code> define the private part of the key. To speed up private key operations through the use of the Chinese remainder theorem (CRT), additional components <code>p</code>, <code>q</code>, <code>dp</code>, <code>dq</code> and <code>qinv</code> are provided. These are part of the private key.</p></dd></dl><dl><dt class="spec value" id="val-wipe_key"><a href="#val-wipe_key" class="anchor"></a><code><span class="keyword">val</span> wipe_key : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Erase all components of a RSA key.</p></dd></dl><dl><dt class="spec value" id="val-new_key"><a href="#val-new_key" class="anchor"></a><code><span class="keyword">val</span> new_key : ?&#8288;rng:<a href="../Random/class-type-rng/index.html">Random.rng</a> <span>&#45;&gt;</span> ?&#8288;e:int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-key">key</a></code></dt><dd><p>Generate a new, random RSA key. The non-optional <code>int</code> argument is the desired size for the modulus, in bits (e.g. 2048). The optional <code>rng</code> argument specifies a random number generator to use for generating the key; it defaults to <a href="../Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>. The optional <code>e</code> argument specifies the public exponent desired. If not specified, <code>e</code> is chosen randomly. Small values of <code>e</code> such as <code>e = 65537</code> significantly speeds up encryption and signature checking compared with a random <code>e</code>. Very small values of <code>e</code> such as <code>e = 3</code> can weaken security and are best avoided. The result of <code>new_key</code> is a complete RSA key with all components defined: public, private, and private for use with the CRT.</p></dd></dl><dl><dt class="spec value" id="val-encrypt"><a href="#val-encrypt" class="anchor"></a><code><span class="keyword">val</span> encrypt : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>encrypt k msg</code> encrypts the string <code>msg</code> with the public part of key <code>k</code> (components <code>n</code> and <code>e</code>). <code>msg</code> must be smaller than <code>key.n</code> when both strings are viewed as natural numbers in big-endian notation. In practice, <code>msg</code> should be of length <code>key.size / 8 - 1</code>, using padding if necessary. If you need to encrypt longer plaintexts using RSA, encrypt them with a symmetric cipher, using a randomly-generated key, and encrypt only that key with RSA.</p></dd></dl><dl><dt class="spec value" id="val-decrypt"><a href="#val-decrypt" class="anchor"></a><code><span class="keyword">val</span> decrypt : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>encrypt k msg</code> encrypts the string <code>msg</code> with the public part of key <code>k</code> (components <code>n</code> and <code>e</code>). <code>msg</code> must be smaller than <code>key.n</code> when both strings are viewed as natural numbers in big-endian notation. In practice, <code>msg</code> should be of length <code>key.size / 8 - 1</code>, using padding if necessary. If you need to encrypt longer plaintexts using RSA, encrypt them with a symmetric cipher, using a randomly-generated key, and encrypt only that key with RSA.</p><p><code>decrypt k msg</code> decrypts the ciphertext string <code>msg</code> with the private part of key <code>k</code> (components <code>n</code> and <code>d</code>). The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-decrypt_CRT"><a href="#val-decrypt_CRT" class="anchor"></a><code><span class="keyword">val</span> decrypt_CRT : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>decrypt k msg</code> decrypts the ciphertext string <code>msg</code> with the private part of key <code>k</code> (components <code>n</code> and <code>d</code>). The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p><p><code>decrypt_CRT k msg</code> decrypts the ciphertext string <code>msg</code> with the CRT private part of key <code>k</code> (components <code>n</code>, <code>p</code>, <code>q</code>, <code>dp</code>, <code>dq</code> and <code>qinv</code>). The use of the Chinese remainder theorem (CRT) allows significantly faster decryption than <a href="index.html#val-decrypt"><code>Cryptokit.RSA.decrypt</code></a>, at no loss in security. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span class="keyword">val</span> sign : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>decrypt_CRT k msg</code> decrypts the ciphertext string <code>msg</code> with the CRT private part of key <code>k</code> (components <code>n</code>, <code>p</code>, <code>q</code>, <code>dp</code>, <code>dq</code> and <code>qinv</code>). The use of the Chinese remainder theorem (CRT) allows significantly faster decryption than <a href="index.html#val-decrypt"><code>Cryptokit.RSA.decrypt</code></a>, at no loss in security. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p><p><code>sign k msg</code> encrypts the plaintext string <code>msg</code> with the private part of key <code>k</code> (components <code>n</code> and <code>d</code>), thus performing a digital signature on <code>msg</code>. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>. If you need to sign longer messages, compute a cryptographic hash of the message and sign only the hash with RSA.</p></dd></dl><dl><dt class="spec value" id="val-sign_CRT"><a href="#val-sign_CRT" class="anchor"></a><code><span class="keyword">val</span> sign_CRT : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>sign k msg</code> encrypts the plaintext string <code>msg</code> with the private part of key <code>k</code> (components <code>n</code> and <code>d</code>), thus performing a digital signature on <code>msg</code>. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>. If you need to sign longer messages, compute a cryptographic hash of the message and sign only the hash with RSA.</p><p><code>sign_CRT k msg</code> encrypts the plaintext string <code>msg</code> with the CRT private part of key <code>k</code> (components <code>n</code>, <code>p</code>, <code>q</code>, <code>dp</code>, <code>dq</code> and <code>qinv</code>), thus performing a digital signature on <code>msg</code>. The use of the Chinese remainder theorem (CRT) allows significantly faster signature than <a href="index.html#val-sign"><code>Cryptokit.RSA.sign</code></a>, at no loss in security. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-unwrap_signature"><a href="#val-unwrap_signature" class="anchor"></a><code><span class="keyword">val</span> unwrap_signature : <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>sign_CRT k msg</code> encrypts the plaintext string <code>msg</code> with the CRT private part of key <code>k</code> (components <code>n</code>, <code>p</code>, <code>q</code>, <code>dp</code>, <code>dq</code> and <code>qinv</code>), thus performing a digital signature on <code>msg</code>. The use of the Chinese remainder theorem (CRT) allows significantly faster signature than <a href="index.html#val-sign"><code>Cryptokit.RSA.sign</code></a>, at no loss in security. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p><p><code>unwrap_signature k msg</code> decrypts the ciphertext string <code>msg</code> with the public part of key <code>k</code> (components <code>n</code> and <code>d</code>), thus extracting the plaintext that was signed by the sender. The size of <code>msg</code> is limited as described for <a href="index.html#val-encrypt"><code>Cryptokit.RSA.encrypt</code></a>.</p></dd></dl></div></body></html>