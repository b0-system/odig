<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cobj (omod.Omod_support.Cobj)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">omod</a> &#x00BB; <a href="../index.html">Omod_support</a> &#x00BB; Cobj</nav><h1>Module <code>Omod_support.Cobj</code></h1><p>Compilation objects</p><nav class="toc"><ul><li><a href="#pkg_ids">Package identifiers</a></li><li><a href="#deps">Dependencies</a></li><li><a href="#specs">Specifications</a></li><li><a href="#cobjs">Compilation objects</a></li><li><a href="#pred">Predicates</a></li><li><a href="#fmt">Formatters</a></li><li><a href="#indexes-and-dependency-resolvers">Indexes and dependency resolvers</a></li></ul></nav></header><section><header><h2 id="pkg_ids"><a href="#pkg_ids" class="anchor"></a>Package identifiers</h2></header><dl><dt class="spec type" id="type-pkg_id"><a href="#type-pkg_id" class="anchor"></a><code><span class="keyword">type</span> pkg_id</code><code> = string * <a href="../../Omod/index.html#type-fpath">Omod.fpath</a></code></dt><dd><p>The type for package identifiers. A package name and its root directory.</p></dd></dl><dl><dt class="spec value" id="val-pp_pkg_id"><a href="#val-pp_pkg_id" class="anchor"></a><code><span class="keyword">val</span> pp_pkg_id : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-pkg_id">pkg_id</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_pkg_id</code> formats package identifiers.</p></dd></dl></section><section><header><h2 id="deps"><a href="#deps" class="anchor"></a>Dependencies</h2></header><dl><dt class="spec type" id="type-dep"><a href="#type-dep" class="anchor"></a><code><span class="keyword">type</span> dep</code><code> = string * <a href="../Digest/index.html#type-t">Digest.t</a> option</code></dt><dd><p>The type for compilation object dependencies. A module name and an optional interface digest.</p></dd></dl><dl><dt class="spec value" id="val-pp_dep"><a href="#val-pp_dep" class="anchor"></a><code><span class="keyword">val</span> pp_dep : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-dep">dep</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_dep</code> formats a dependency.</p></dd></dl></section><section><header><h2 id="specs"><a href="#specs" class="anchor"></a>Specifications</h2></header><dl><dt class="spec value" id="val-spec_of_string"><a href="#val-spec_of_string" class="anchor"></a><code><span class="keyword">val</span> spec_of_string : string <span>&#45;&gt;</span> (string option * string * string list, string) <a href="../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></code></dt><dd><p><code>spec_of_string s</code> parses a compilation object specification from <code>s</code>. This parses the <code>[PKG.]M(\@VARIANT)+</code> syntax.</p></dd></dl></section><section><header><h2 id="cobjs"><a href="#cobjs" class="anchor"></a>Compilation objects</h2></header><dl><dt class="spec type" id="type-kind"><a href="#type-kind" class="anchor"></a><code><span class="keyword">type</span> kind</code><code> = </code><table class="variant"><tr id="type-kind.Cmi" class="anchored"><td class="def constructor"><a href="#type-kind.Cmi" class="anchor"></a><code>| </code><code><span class="constructor">Cmi</span></code></td></tr><tr id="type-kind.Cmo" class="anchored"><td class="def constructor"><a href="#type-kind.Cmo" class="anchor"></a><code>| </code><code><span class="constructor">Cmo</span></code></td></tr><tr id="type-kind.Cmx" class="anchored"><td class="def constructor"><a href="#type-kind.Cmx" class="anchor"></a><code>| </code><code><span class="constructor">Cmx</span></code></td></tr></table></dt><dd><p>The type for kind of compilation objects.</p></dd></dl><dl><dt class="spec value" id="val-kind_of_string"><a href="#val-kind_of_string" class="anchor"></a><code><span class="keyword">val</span> kind_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-kind">kind</a> option</code></dt><dd><p><code>kind_of_string s</code> parses <code>s</code> into a kind.</p></dd></dl><dl><dt class="spec value" id="val-kind_to_string"><a href="#val-kind_to_string" class="anchor"></a><code><span class="keyword">val</span> kind_to_string : <a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>kind_to_string k</code> is <code>k</code> as a string.</p></dd></dl><dl><dt class="spec value" id="val-exts"><a href="#val-exts" class="anchor"></a><code><span class="keyword">val</span> exts : <a href="../../Omod/Private/String/Set/index.html#type-t">Omod.Private.String.Set.t</a></code></dt><dd><p><code>exts</code> are the file extensions of compilation objects.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The type for compilation objects.</p></dd></dl><dl><dt class="spec value" id="val-v"><a href="#val-v" class="anchor"></a><code><span class="keyword">val</span> v : kind:<a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> pkg_id:<a href="index.html#type-pkg_id">pkg_id</a> <span>&#45;&gt;</span> name:string <span>&#45;&gt;</span> iface_digest:<a href="../Digest/index.html#type-t">Digest.t</a> option <span>&#45;&gt;</span> iface_deps:<a href="index.html#type-dep">dep</a> list <span>&#45;&gt;</span> in_archive:bool <span>&#45;&gt;</span> path:<a href="../../Omod/index.html#type-fpath">Omod.fpath</a> <span>&#45;&gt;</span> path_loads:<a href="index.html#type-t">t</a> list <a href="../../../ocaml/Stdlib/Lazy/index.html#type-t">Stdlib.Lazy.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>v</code> is a compilation object with the given parameters, see the documentation of accessors for semantics.</p></dd></dl><dl><dt class="spec value" id="val-add_file"><a href="#val-add_file" class="anchor"></a><code><span class="keyword">val</span> add_file : pkg_id:<a href="index.html#type-pkg_id">pkg_id</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="../../Omod/index.html#type-fpath">Omod.fpath</a> <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a> list, string) <a href="../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></code></dt><dd><p><code>add_file ~pkg_id acc f</code> adds the compilation objects of file <code>f</code> in package <code>pkg_id</code> to <code>acc</code>. If <code>f</code>'s extension doesn't match a supported compilation object file this is <code>acc</code>.</p></dd></dl><dl><dt class="spec value" id="val-kind"><a href="#val-kind" class="anchor"></a><code><span class="keyword">val</span> kind : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-kind">kind</a></code></dt><dd><p><code>kind c</code> is <code>c</code>'s <a href="index.html#type-kind"><span>kind</span></a>.</p></dd></dl><dl><dt class="spec value" id="val-pkg_id"><a href="#val-pkg_id" class="anchor"></a><code><span class="keyword">val</span> pkg_id : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-pkg_id">pkg_id</a></code></dt><dd><p><code>pkg_id c</code> is <code>c</code>'s package identifier.</p></dd></dl><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>name c</code> is <code>c</code>'s capitalized module name (more precisely compilation unit name).</p></dd></dl><dl><dt class="spec value" id="val-variant"><a href="#val-variant" class="anchor"></a><code><span class="keyword">val</span> variant : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>variant c</code> is <code>c</code>'s variant.</p></dd></dl><dl><dt class="spec value" id="val-iface_digest"><a href="#val-iface_digest" class="anchor"></a><code><span class="keyword">val</span> iface_digest : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Digest/index.html#type-t">Digest.t</a> option</code></dt><dd><p><code>iface_digest c</code> is <code>c</code>'s interface digest (if any).</p></dd></dl><dl><dt class="spec value" id="val-iface_deps"><a href="#val-iface_deps" class="anchor"></a><code><span class="keyword">val</span> iface_deps : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-dep">dep</a> list</code></dt><dd><p><code>iface_deps c</code> is <code>c</code>'s interface dependencies.</p></dd></dl><dl><dt class="spec value" id="val-in_archive"><a href="#val-in_archive" class="anchor"></a><code><span class="keyword">val</span> in_archive : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>in_archive c</code> is <code>true</code> if <a href="index.html#val-path"><code>path</code></a> is an object archive.</p></dd></dl><dl><dt class="spec value" id="val-path"><a href="#val-path" class="anchor"></a><code><span class="keyword">val</span> path : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Omod/index.html#type-fpath">Omod.fpath</a></code></dt><dd><p><code>path c</code> is <code>c</code>'s file path.</p></dd></dl><dl><dt class="spec value" id="val-path_loads"><a href="#val-path_loads" class="anchor"></a><code><span class="keyword">val</span> path_loads : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p><code>path_loads c</code> are all the objects that are loaded whenever <a href="index.html#val-path"><code>path</code></a> is loaded (includes <code>c</code> itself). For paths that point to archives this has all the objects of the archive.</p></dd></dl><dl><dt class="spec value" id="val-to_dep"><a href="#val-to_dep" class="anchor"></a><code><span class="keyword">val</span> to_dep : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-dep">dep</a></code></dt><dd><p><code>to_dep c</code> is <code>c</code> as an interface dependency.</p></dd></dl></section><section><header><h2 id="pred"><a href="#pred" class="anchor"></a>Predicates</h2></header><dl><dt class="spec value" id="val-is_kind"><a href="#val-is_kind" class="anchor"></a><code><span class="keyword">val</span> is_kind : <a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>is_kind k c</code> is <code>true</code> iff <code>kind c = k</code>.</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal c c'</code> tests <code>c</code> and <code>c'</code> for equality (all components must match).</p></dd></dl><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare</code> is a total order compatible with <a href="index.html#val-equal"><code>equal</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-ui_compare"><a href="#val-ui_compare" class="anchor"></a><code><span class="keyword">val</span> ui_compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>ui_compare</code> orders by name, package, variant and path.</p></dd></dl></section><section><header><h2 id="fmt"><a href="#fmt" class="anchor"></a>Formatters</h2></header><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp</code> formats a compilation object.</p></dd></dl></section><section><header><h2 id="indexes-and-dependency-resolvers"><a href="#indexes-and-dependency-resolvers" class="anchor"></a>Indexes and dependency resolvers</h2></header><dl><dt class="spec module" id="module-Index"><a href="#module-Index" class="anchor"></a><code><span class="keyword">module</span> <a href="Index/index.html">Index</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Compilation object indexes.</p></dd></dl><dl><dt class="spec type" id="type-res"><a href="#type-res" class="anchor"></a><code><span class="keyword">type</span> res</code><code> = <a href="index.html#type-t">t</a> <a href="../../Omod/Private/String/Map/index.html#type-t">Omod.Private.String.Map.t</a></code></dt><dd><p>The type for dependency resolutions. Maps module names to their resolved object.</p></dd></dl><dl><dt class="spec value" id="val-resolve_deps"><a href="#val-resolve_deps" class="anchor"></a><code><span class="keyword">val</span> resolve_deps : variants:<a href="../../Omod/Private/String/Set/index.html#type-t">Omod.Private.String.Set.t</a> <span>&#45;&gt;</span> sat:(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> kind:<a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> <a href="Index/index.html#type-t">Index.t</a> <span>&#45;&gt;</span> root_alts:<a href="index.html#type-t">t</a> list list <span>&#45;&gt;</span> (<a href="index.html#type-res">res</a> list, string) <a href="../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></code></dt><dd><p><code>resolve_deps ~variants ~sat ~kind i roots</code> is a list of resolutions that recursively resolve the dependencies of the alternative root object roots <code>root_alts</code> to compilation objects of kind <code>kind</code> and satisfying <code>sat</code> using the twists of <a href="Index/index.html#val-cobjs_for_dep_res"><code>Index.cobjs_for_dep_res</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-fold_res"><a href="#val-fold_res" class="anchor"></a><code><span class="keyword">val</span> fold_res : <a href="index.html#type-res">res</a> <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>fold_res res f acc</code> folds <code>f</code> with <code>acc</code> over the partial dependency order of <code>res</code> </p><dl><dt>raises Invalid_argument</dt><dd><p>if the dependencies of objects in <code>res</code> are not defined in <code>res</code>, this can't happen if the map is a result of <a href="index.html#val-resolve_deps"><code>resolve_deps</code></a>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-loads"><a href="#val-loads" class="anchor"></a><code><span class="keyword">val</span> loads : variants:<a href="../../Omod/Private/String/Set/index.html#type-t">Omod.Private.String.Set.t</a> <span>&#45;&gt;</span> sat:(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> kind:<a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> <a href="Index/index.html#type-t">Index.t</a> <span>&#45;&gt;</span> root_alts:<a href="index.html#type-t">t</a> list list <span>&#45;&gt;</span> (<a href="../../Omod/index.html#type-fpath">Omod.fpath</a> list list, string) <a href="../../../ocaml/Stdlib/index.html#type-result">Stdlib.result</a></code></dt><dd><p><code>loads ~sat ~kind i root_alts</code> resolves the alternative root objects roots <code>root_alts</code> to alternative load sequences of object paths of that have objects of kind <code>kind</code> or <code>Cmi</code>s (mli-only modules). All the objects involved in the load sequence satisfy <code>sat</code>.</p></dd></dl></section></div></body></html>