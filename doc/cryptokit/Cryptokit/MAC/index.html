<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>MAC (cryptokit.Cryptokit.MAC)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cryptokit</a> &#x00BB; <a href="../index.html">Cryptokit</a> &#x00BB; MAC</nav><h1>Module <code>Cryptokit.MAC</code></h1><p>The <code>MAC</code> module implements message authentication codes, also known as keyed hash functions. These are hash functions parameterized by a secret key. In addition to being one-way and collision-resistant, a MAC has the property that without knowing the secret key, it is computationally infeasible to find the hash for a known text, even if many pairs of (text, MAC) are known to the attacker. Thus, MAC can be used to authenticate the sender of a text: the receiver of a (text, MAC) pair can recompute the MAC from the text, and if it matches the transmitted MAC, be reasonably certain that the text was authentified by someone who possesses the secret key.</p><p>The module <code>MAC</code> provides five MAC functions based on the hashes SHA-1, SHA256, SHA512, RIPEMD160 and MD5, and five MAC functions based on the block ciphers AES, DES, and Triple-DES.</p></header><dl><dt class="spec value" id="val-hmac_sha1"><a href="#val-hmac_sha1" class="anchor"></a><code><span class="keyword">val</span> hmac_sha1 : string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_sha1 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-1. The returned hash values are 160 bits (20 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 20 bytes is recommended.</p></dd></dl><dl><dt class="spec value" id="val-hmac_sha256"><a href="#val-hmac_sha256" class="anchor"></a><code><span class="keyword">val</span> hmac_sha256 : string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_sha1 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-1. The returned hash values are 160 bits (20 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 20 bytes is recommended.</p><p><code>hmac_sha256 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-256. The returned hash values are 256 bits (32 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 32 bytes is recommended.</p></dd></dl><dl><dt class="spec value" id="val-hmac_sha512"><a href="#val-hmac_sha512" class="anchor"></a><code><span class="keyword">val</span> hmac_sha512 : string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_sha256 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-256. The returned hash values are 256 bits (32 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 32 bytes is recommended.</p><p><code>hmac_sha512 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-512. The returned hash values are 512 bits (64 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 64 bytes is recommended.</p></dd></dl><dl><dt class="spec value" id="val-hmac_ripemd160"><a href="#val-hmac_ripemd160" class="anchor"></a><code><span class="keyword">val</span> hmac_ripemd160 : string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_sha512 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to SHA-512. The returned hash values are 512 bits (64 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 64 bytes is recommended.</p><p><code>hmac_ripemd160 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to RIPEMD-160. The returned hash values are 160 bits (20 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 20 bytes is recommended.</p></dd></dl><dl><dt class="spec value" id="val-hmac_md5"><a href="#val-hmac_md5" class="anchor"></a><code><span class="keyword">val</span> hmac_md5 : string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_ripemd160 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to RIPEMD-160. The returned hash values are 160 bits (20 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 20 bytes is recommended.</p><p><code>hmac_md5 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to MD5. The returned hash values are 128 bits (16 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 16 bytes is recommended.</p></dd></dl><dl><dt class="spec value" id="val-aes_cmac"><a href="#val-aes_cmac" class="anchor"></a><code><span class="keyword">val</span> aes_cmac : ?&#8288;iv:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>hmac_md5 key</code> returns a MAC based on the HMAC construction (RFC2104) applied to MD5. The returned hash values are 128 bits (16 bytes) long. The <code>key</code> argument is the MAC key; it can have any length, but a minimal length of 16 bytes is recommended.</p><p><code>aes_cmac key</code> returns a MAC based on AES encryption in CMAC mode, also known as OMAC1 mode. The input data is encrypted using AES in CBC mode, with a special treatment of the final block that makes this MAC suitable for input data of variable length. The final value of the initialization vector is the MAC value. Thus, the returned hash values are 128 bit (16 bytes) long. The <code>key</code> argument is the MAC key; it must have length 16, 24, or 32. The optional <code>iv</code> argument is the first value of the initialization vector, and defaults to 0.</p></dd></dl><dl><dt class="spec value" id="val-aes"><a href="#val-aes" class="anchor"></a><code><span class="keyword">val</span> aes : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>aes_cmac key</code> returns a MAC based on AES encryption in CMAC mode, also known as OMAC1 mode. The input data is encrypted using AES in CBC mode, with a special treatment of the final block that makes this MAC suitable for input data of variable length. The final value of the initialization vector is the MAC value. Thus, the returned hash values are 128 bit (16 bytes) long. The <code>key</code> argument is the MAC key; it must have length 16, 24, or 32. The optional <code>iv</code> argument is the first value of the initialization vector, and defaults to 0.</p><p><code>aes key</code> returns a MAC based on AES encryption in CBC mode. Unlike <code>aes_cmac</code>, there is no special treatment for the final block, except padding it as per the optional <code>pad</code> argument. This makes this MAC weak when used with input data of variable length. (It is fine for data of fixed length, though.) The returned hash values are 128 bit (16 bytes) long. The <code>key</code> argument is the MAC key; it must have length 16, 24, or 32. The optional <code>iv</code> argument is the first value of the initialization vector, and defaults to 0. The optional <code>pad</code> argument specifies a padding scheme to pad input to an integral number of 16-byte blocks.</p></dd></dl><dl><dt class="spec value" id="val-des"><a href="#val-des" class="anchor"></a><code><span class="keyword">val</span> des : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>aes key</code> returns a MAC based on AES encryption in CBC mode. Unlike <code>aes_cmac</code>, there is no special treatment for the final block, except padding it as per the optional <code>pad</code> argument. This makes this MAC weak when used with input data of variable length. (It is fine for data of fixed length, though.) The returned hash values are 128 bit (16 bytes) long. The <code>key</code> argument is the MAC key; it must have length 16, 24, or 32. The optional <code>iv</code> argument is the first value of the initialization vector, and defaults to 0. The optional <code>pad</code> argument specifies a padding scheme to pad input to an integral number of 16-byte blocks.</p><p><code>des key</code> returns a MAC based on DES encryption in CBC mode. The construction is identical to that used for the <code>aes</code> MAC. The key size is 64 bits (8 bytes), of which only 56 are used. The returned hash value has length 8 bytes. Due to the small hash size and key size, this MAC is weak.</p></dd></dl><dl><dt class="spec value" id="val-triple_des"><a href="#val-triple_des" class="anchor"></a><code><span class="keyword">val</span> triple_des : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>des key</code> returns a MAC based on DES encryption in CBC mode. The construction is identical to that used for the <code>aes</code> MAC. The key size is 64 bits (8 bytes), of which only 56 are used. The returned hash value has length 8 bytes. Due to the small hash size and key size, this MAC is weak.</p><p><code>des key</code> returns a MAC based on triple DES encryption in CBC mode. The construction is identical to that used for the <code>aes</code> MAC. The key size is 16 or 24 bytes. The returned hash value has length 8 bytes. The key size is sufficient to protect against brute-force attacks, but the small hash size means that this MAC is not collision-resistant.</p></dd></dl><dl><dt class="spec value" id="val-des_final_triple_des"><a href="#val-des_final_triple_des" class="anchor"></a><code><span class="keyword">val</span> des_final_triple_des : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p><code>des key</code> returns a MAC based on triple DES encryption in CBC mode. The construction is identical to that used for the <code>aes</code> MAC. The key size is 16 or 24 bytes. The returned hash value has length 8 bytes. The key size is sufficient to protect against brute-force attacks, but the small hash size means that this MAC is not collision-resistant.</p><p><code>des_final_triple_des key</code> returns a MAC that uses DES CBC with the first 8 bytes of <code>key</code> as key. The final initialization vector is then DES-decrypted with bytes 8 to 15 of <code>key</code>, and DES-encrypted again with either the last 8 bytes of <code>key</code> (if a triple-length key is provided) or the first 8 bytes of <code>key</code> (if a double-length key is provided). Thus, the key is 16 or 24 bytes long, of which 112 or 168 bits are used. The overall construction has the same key size as a triple DES MAC, but runs faster because triple encryption is not performed on all data blocks, but only on the final MAC.</p></dd></dl></div></body></html>