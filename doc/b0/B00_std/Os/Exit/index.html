<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Exit (b0.B00_std.Os.Exit)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">b0</a> &#x00BB; <a href="../../index.html">B00_std</a> &#x00BB; <a href="../index.html">Os</a> &#x00BB; Exit</nav><header class="odoc-preamble"><h1>Module <code><span>Os.Exit</span></code></h1><p>Program exit.</p></header><nav class="odoc-toc"><ul><li><a href="#exitspec">Specifying exits</a></li><li><a href="#exitexit">Exiting exits</a></li><li><a href="#sigexit">Signal exit hooks</a></li></ul></nav><div class="odoc-content"><h2 id="exitspec"><a href="#exitspec" class="anchor"></a>Specifying exits</h2><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><table><tr id="type-t.Code" class="anchored"><td class="def variant constructor"><a href="#type-t.Code" class="anchor"></a><code><span>| </span><span><span class="constructor">Code</span> : int <span class="arrow">&#45;&gt;</span> <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>exit</code> with code.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.Exec" class="anchored"><td class="def variant constructor"><a href="#type-t.Exec" class="anchor"></a><code><span>| </span><span><span class="constructor">Exec</span> : <span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, string)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">result</a></span>)</span> <span class="arrow">&#45;&gt;</span> <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>exit with <code>execv</code></p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>The type for specifying program exits. Either an exit code or a function (should be) calling <code>B00_std</code>.Cmd.execv.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-code" class="anchored"><a href="#val-code" class="anchor"></a><code><span><span class="keyword">val</span> code : <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>code c</code> is <code>Code c</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-exec" class="anchored"><a href="#val-exec" class="anchor"></a><code><span><span class="keyword">val</span> exec : <span>?env:<a href="../Env/index.html#type-assignments">Env.assignments</a> <span class="arrow">&#45;&gt;</span></span> <span>?cwd:<a href="../../Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cmd/index.html#type-t">Cmd.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>exec ?env ?cwd file argv</code> is an <code>Exec _</code>. That has a call to <a href="../Cmd/index.html#val-execv"><code>Os.Cmd.execv</code></a> with the corresponding arguments.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_code" class="anchored"><a href="#val-get_code" class="anchor"></a><code><span><span class="keyword">val</span> get_code : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>get_code e</code> is the exit code of <code>e</code>. Raises <code>Invalid_argument</code> if <code>e</code> is <a href="#type-t.Exec"><code>Exec</code></a>.</p></div></div><h2 id="exitexit"><a href="#exitexit" class="anchor"></a>Exiting exits</h2><div class="odoc-spec"><div class="spec value" id="val-exit" class="anchored"><a href="#val-exit" class="anchor"></a><code><span><span class="keyword">val</span> exit : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, string)</span> <a href="../../../../ocaml/Stdlib/index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>exit e</code> exits according to <code>e</code>:</p><ul><li>If <code>e</code> is <code>Code c</code>, <a href="../../../../ocaml/Stdlib/index.html#val-exit"><code>Stdlib.exit</code></a><code> c</code> is called and the function never returns.</li><li>If <code>e</code> is <code>Exec execv</code>, <code>execv</code> is called. This can only return with an <code>Error _</code>. In that case log it and call the function again with an error code - this guarantees termination.</li></ul></div></div><h2 id="sigexit"><a href="#sigexit" class="anchor"></a>Signal exit hooks</h2><div class="odoc-spec"><div class="spec value" id="val-on_sigint" class="anchored"><a href="#val-on_sigint" class="anchor"></a><code><span><span class="keyword">val</span> on_sigint : <span>hook:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>on_sigint ~hook f</code> calls <code>f ()</code> and returns its value. If <code>SIGINT</code> is signalled during that time <code>hook</code> is called followed by <code>exit 130</code> – that is the exit code a <code>SIGINT</code> would produce.</p><p><code>on_sigint</code> replaces an existing signal handler for <code>Sys</code>.sigint during time of the function call. It is restored when the function returns.</p><p><b>Note.</b> Since <a href="../../../../ocaml/Stdlib/index.html#val-exit"><code>Stdlib.exit</code></a> is called <a href="../../../../ocaml/Stdlib/index.html#val-at_exit"><code>Stdlib.at_exit</code></a> functions are called if a <code>SIGINT</code> occurs during the call to <code>f</code>. This is not the case on an unhandled <code>SIGINT</code>.</p></div></div></div></body></html>