<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Term (notty.Notty_unix.Term)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">notty</a> &#x00BB; <a href="../index.html">Notty_unix</a> &#x00BB; Term</nav><header class="odoc-preamble"><h1>Module <code><span>Notty_unix.Term</span></code></h1><p>Terminal IO abstraction for fullscreen, interactive applications.</p><p>This module provides both input and output. It assumes exclusive ownership of the IO streams between <span class="xref-unresolved">initialization</span> and <span class="xref-unresolved">shutdown</span>.</p></header><nav class="odoc-toc"><ul><li><a href="#construction-and-destruction">Construction and destruction</a></li><li><a href="#cmds">Commands</a></li><li><a href="#events">Events</a></li><li><a href="#properties">Properties</a></li><li><a href="#window-size-change-notifications">Window size change notifications</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Representation of the terminal, giving structured access to IO.</p></div></div><h2 id="construction-and-destruction"><a href="#construction-and-destruction" class="anchor"></a>Construction and destruction</h2><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>?dispose:bool <span class="arrow">&#45;&gt;</span></span> <span>?nosig:bool <span class="arrow">&#45;&gt;</span></span> <span>?mouse:bool <span class="arrow">&#45;&gt;</span></span> <span>?bpaste:bool <span class="arrow">&#45;&gt;</span></span> <span>?input:<a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span>
<span>?output:<a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ~dispose ~nosig ~mouse ~input ~output ()</code> creates a fresh <a href="#type-t">terminal</a>. It has the following side effects:</p><ul><li><code>Unix.tcsetattr</code> is applied to <code>input</code> to disable <em>echo</em> and <em>canonical mode</em>.</li><li><code>output</code> is set to <em>alternate screen mode</em>, and the cursor is hidden. Mouse and <em>bracketed paste</em> reporting are (optionally) enabled.</li><li><code>SIGWINCH</code> signal, normally ignored, is handled.</li></ul><p><code>~dispose</code> arranges for automatic <a href="#val-release">cleanup</a> of the terminal before the process terminates. The downside is that a reference to this terminal is retained until the program exits. Defaults to <code>true</code>.</p><p><code>~nosig</code> additionally turns off signal delivery and flow control (<em>isig</em> and <em>ixon</em>) on input. Inhibits automatic handling of <em>CTRL-{C,Z,\,S,Q}</em>. Defaults to <code>true</code>.</p><p><code>~mouse</code> activates mouse reporting. Defaults to <code>true</code>.</p><p><code>~bpaste</code> activates bracketed paste reporting. Defaults to <code>true</code>.</p><p><code>~input</code> is the input file descriptor. Defaults to <code>stdin</code>.</p><p><code>~output</code> is the output file descriptor. Defaults to <code>stdout</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-release" class="anchored"><a href="#val-release" class="anchor"></a><code><span><span class="keyword">val</span> release : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Dispose of this terminal. Original behavior of input fd is reinstated, cursor is restored, mouse reporting disabled, and alternate mode is terminated.</p><p>It is an error to use the <a href="#cmds">commands</a> on a released terminal, and will raise <code>Invalid_argument</code>, while <code>release</code> itself is idempotent.</p></div></div><h2 id="cmds"><a href="#cmds" class="anchor"></a>Commands</h2><div class="odoc-spec"><div class="spec value" id="val-image" class="anchored"><a href="#val-image" class="anchor"></a><code><span><span class="keyword">val</span> image : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Notty/index.html#type-image">Notty.image</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>image t i</code> sets <code>i</code> as <code>t</code>'s current image and redraws the terminal.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-refresh" class="anchored"><a href="#val-refresh" class="anchor"></a><code><span><span class="keyword">val</span> refresh : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>refresh t</code> redraws the terminal using the current image.</p><p>Useful if the output might have become garbled.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-cursor" class="anchored"><a href="#val-cursor" class="anchor"></a><code><span><span class="keyword">val</span> cursor : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(int * int)</span> option</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>cursor t pos</code> sets and redraws the cursor.</p><p><code>None</code> hides it. <code>Some (x, y)</code> places it at column <code>x</code> and row <code>y</code>, with the origin at <code>(0, 0)</code>, mapping to the upper-left corner.</p></div></div><h2 id="events"><a href="#events" class="anchor"></a>Events</h2><div class="odoc-spec"><div class="spec value" id="val-event" class="anchored"><a href="#val-event" class="anchor"></a><code><span><span class="keyword">val</span> event : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>[ <a href="../../Notty/Unescape/index.html#type-event">Notty.Unescape.event</a> <span><span>| `Resize</span> of int * int</span> <span>| `End</span> ]</span></span></code></div><div class="spec-doc"><p>Wait for a new event. <code>event t</code> can be:</p><ul><li><code>#Unescape.event</code>, an <a href="../../Notty/Unescape/index.html#type-event"><code>event</code></a> from the input fd;</li><li><code>`End</code> if the input fd is closed, or the terminal was released; or</li><li><code>`Resize (cols * rows)</code> giving the current size of the output tty, if a <code>SIGWINCH</code> was delivered before or during this call to <code>event</code>.</li></ul><p><b>Note</b> <code>event</code> is buffered. Calls can either block or immediately return. Use <a href="#val-pending"><code>pending</code></a> to detect when the next call would not block.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pending" class="anchored"><a href="#val-pending" class="anchor"></a><code><span><span class="keyword">val</span> pending : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>pending t</code> is <code>true</code> if the next call to <a href="#val-event"><code>event</code></a> would not block and the terminal has not yet been released.</p></div></div><h2 id="properties"><a href="#properties" class="anchor"></a>Properties</h2><div class="odoc-spec"><div class="spec value" id="val-size" class="anchored"><a href="#val-size" class="anchor"></a><code><span><span class="keyword">val</span> size : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int * int</span></code></div><div class="spec-doc"><p><code>size t</code> is the current size of the terminal's output tty.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fds" class="anchored"><a href="#val-fds" class="anchor"></a><code><span><span class="keyword">val</span> fds : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> * <a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a></span></code></div><div class="spec-doc"><p><code>fds t</code> are <code>t</code>'s input and output file descriptors.</p></div></div><h2 id="window-size-change-notifications"><a href="#window-size-change-notifications" class="anchor"></a>Window size change notifications</h2><div class="odoc-spec"><div class="spec module" id="module-Winch" class="anchored"><a href="#module-Winch" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Winch/index.html">Winch</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Manual <code>SIGWINCH</code> handling.</p></div></div></div></body></html>