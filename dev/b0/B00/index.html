<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>B00 (b0.B00)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">b0</a> &#x00BB; B00</nav><h1>Module <code>B00</code></h1><p>Build kernel</p><p><b>WARNING.</b> This is an unstable API use at your own risk.</p><p>Concepts kept:</p><ul><li>Treat build operations as pure functions that affect the file system and memoize their results.</li><li>Parallelize build operations by synchronizing on the files they read and writes.</li><li>Tight control over tool lookup and build environment.</li></ul><p>Concepts dropped and to be seen how we can recover them at a higher level:</p><ul><li>Build aims for cross compilation (build/host OS distinction). This should be capturable as two separate <a href="Memo/index.html"><code>Memo</code></a>s.</li><li>Build units (named sets of build operation with metadata)</li><li>Build operation synchronisation, only files for now, we had unit-level. Did introduce <a href="Memo/Fut/index.html"><code>Memo.Fut</code></a> for odig.</li><li>Build configuration.</li><li>Build unit/config definition localisation (multiple B0.ml files)</li><li>Build directory structuring and forced clean builds</li><li>Build metadata, unit and file level, packages.</li></ul><p><b>TODO.</b></p><ul><li>The concept of response file in <a href="Tool/index.html"><code>Tool</code></a> should likely appear at the <a href="Op/index.html#val-spawn"><code>Op.spawn</code></a> level aswell so that we can simply have the sequence of <a href="Op/index.html#type-t"><code>Op.t</code></a> value for a potential build log (otherwise <span class="xref-unresolved" title="unresolved reference to &quot;Op.spawn_args&quot;"><a href="index.html#module-Op"><code>Op</code></a>.spawn_args</span> becomes the line with the response file which is not meanigfull)</li><li>Operations, b0 also had file deletion and copy maybe add them aswell. Copy can be expressed in terms of read/write but maybe better to have as a primitive for concurency. Delete doesn't fit well in the &quot;file ready&quot; model, but could be useful for concurrency.</li><li>Spawn redirection should maybe create the paths of the file they write to.</li></ul><p><em>d84b938b — <a href="UNDEFINED">homepage</a></em></p><nav class="toc"><ul><li><a href="#b00">B00</a></li><li><a href="#b01">B01</a></li></ul></nav></header><section><header><h2 id="b00"><a href="#b00" class="anchor"></a>B00</h2></header><dl><dt class="spec module" id="module-File_cache"><a href="#module-File_cache" class="anchor"></a><code><span class="keyword">module</span> <a href="File_cache/index.html">File_cache</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>File caches.</p></dd></dl><dl><dt class="spec module" id="module-Op"><a href="#module-Op" class="anchor"></a><code><span class="keyword">module</span> <a href="Op/index.html">Op</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Build operations.</p></dd></dl><dl><dt class="spec module" id="module-Op_cache"><a href="#module-Op_cache" class="anchor"></a><code><span class="keyword">module</span> <a href="Op_cache/index.html">Op_cache</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Operation cache.</p></dd></dl><dl><dt class="spec module" id="module-Guard"><a href="#module-Guard" class="anchor"></a><code><span class="keyword">module</span> <a href="Guard/index.html">Guard</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Build operations guards.</p></dd></dl><dl><dt class="spec module" id="module-Exec"><a href="#module-Exec" class="anchor"></a><code><span class="keyword">module</span> <a href="Exec/index.html">Exec</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Build operation executors.</p></dd></dl></section><section><header><h2 id="b01"><a href="#b01" class="anchor"></a>B01</h2></header><dl><dt class="spec module" id="module-Env"><a href="#module-Env" class="anchor"></a><code><span class="keyword">module</span> <a href="Env/index.html">Env</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Build environment.</p></dd></dl><dl><dt class="spec module" id="module-Tool"><a href="#module-Tool" class="anchor"></a><code><span class="keyword">module</span> <a href="Tool/index.html">Tool</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Command line tools.</p></dd></dl><dl><dt class="spec module" id="module-Memo"><a href="#module-Memo" class="anchor"></a><code><span class="keyword">module</span> <a href="Memo/index.html">Memo</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Build memoizer.</p></dd></dl></section></div></body></html>