<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>mac_final_triple (cryptokit.Cryptokit.Block.mac_final_triple)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">cryptokit</a> &#x00BB; <a href="../../index.html">Cryptokit</a> &#x00BB; <a href="../index.html">Block</a> &#x00BB; mac_final_triple</nav><h1>Class <code>Block.mac_final_triple</code></h1></header><div class="doc"><p>Build a MAC (keyed hash function) from the given block cipher. The block cipher is run in CBC mode, and the MAC value is the final value of the initialization vector. Thus, the hash size of the resulting hash is the block size of the block cipher. The optional argument <code>iv</code> specifies the first initialization vector, with a default of all zeroes. The optional argument <code>pad</code> specifies a padding scheme to be applied to the input data; if not provided, no padding is performed.</p><p>Build a MAC (keyed hash function) from the given block ciphers <code>c1</code>, <code>c2</code> and <code>c3</code>. The input is run through <code>c1</code> in CBC mode, as described for <a href="../class-mac/index.html"><code>Cryptokit.Block.mac</code></a>. The final initialization vector is then super-enciphered by <code>c2</code>, then by <code>c3</code>, to provide the final MAC. This construction results in a MAC that is as nearly as fast as <a href="../class-mac/index.html"><code>Cryptokit.Block.mac</code></a> <code>c1</code>, but more resistant against brute-force key search because of the additional final encryption through <code>c2</code> and <code>c3</code>.</p></div><aside><p>A &lt;I&gt;hash&lt;/I&gt; is a function that maps arbitrarily-long character sequences to small, fixed-size strings.</p></aside><dl><dt class="spec method" id="method-add_substring"><a href="#method-add_substring" class="anchor"></a><code><span class="keyword">method </span>add_substring : bytes <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_substring b pos len</code> adds <code>len</code> characters from byte array <code>b</code>, starting at character number <code>pos</code>, to the running hash computation.</p></dd></dl><dl><dt class="spec method" id="method-add_string"><a href="#method-add_string" class="anchor"></a><code><span class="keyword">method </span>add_string : string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_substring b pos len</code> adds <code>len</code> characters from byte array <code>b</code>, starting at character number <code>pos</code>, to the running hash computation.</p><p><code>add_string str</code> adds all characters of string <code>str</code> to the running hash computation.</p></dd></dl><dl><dt class="spec method" id="method-add_char"><a href="#method-add_char" class="anchor"></a><code><span class="keyword">method </span>add_char : char <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_string str</code> adds all characters of string <code>str</code> to the running hash computation.</p><p><code>add_char c</code> adds character <code>c</code> to the running hash computation.</p></dd></dl><dl><dt class="spec method" id="method-add_byte"><a href="#method-add_byte" class="anchor"></a><code><span class="keyword">method </span>add_byte : int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_char c</code> adds character <code>c</code> to the running hash computation.</p><p><code>add_byte b</code> adds the character having code <code>b</code> to the running hash computation. <code>b</code> must be between <code>0</code> and <code>255</code> inclusive.</p></dd></dl><dl><dt class="spec method" id="method-result"><a href="#method-result" class="anchor"></a><code><span class="keyword">method </span>result : string</code></dt><dd><p><code>add_byte b</code> adds the character having code <code>b</code> to the running hash computation. <code>b</code> must be between <code>0</code> and <code>255</code> inclusive.</p><p>Terminate the hash computation and return the hash value for the input data provided via the <code>add_*</code> methods. The hash value is a string of length <code>hash_size</code> characters. After calling <code>result</code>, the hash can no longer accept additional data. Hence, do not call any of the <code>add_*</code> methods after <code>result</code>.</p></dd></dl><dl><dt class="spec method" id="method-hash_size"><a href="#method-hash_size" class="anchor"></a><code><span class="keyword">method </span>hash_size : int</code></dt><dd><p>Terminate the hash computation and return the hash value for the input data provided via the <code>add_*</code> methods. The hash value is a string of length <code>hash_size</code> characters. After calling <code>result</code>, the hash can no longer accept additional data. Hence, do not call any of the <code>add_*</code> methods after <code>result</code>.</p><p>Return the size of hash values produced by this hash function, in bytes.</p></dd></dl><dl><dt class="spec method" id="method-wipe"><a href="#method-wipe" class="anchor"></a><code><span class="keyword">method </span>wipe : unit</code></dt><dd><p>Return the size of hash values produced by this hash function, in bytes.</p><p>Erase all internal buffers and data structures of this hash, overwriting them with zeroes. See <a href="../../class-type-transform/index.html#method-wipe"><code>Cryptokit.transform.wipe</code></a>.</p></dd></dl></div></body></html>