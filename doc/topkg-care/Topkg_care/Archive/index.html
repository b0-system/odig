<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Archive (topkg-care.Topkg_care.Archive)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">topkg-care</a> &#x00BB; <a href="../index.html">Topkg_care</a> &#x00BB; Archive</nav><header class="odoc-preamble"><h1>Module <code><span>Topkg_care.Archive</span></code></h1><p>Archive file creation.</p></header><nav class="odoc-toc"><ul><li><a href="#ustar-archives">Ustar archives</a></li><li><a href="#bzip2-compression-and-unarchiving">Bzip2 compression and unarchiving</a></li></ul></nav><div class="odoc-content"><h2 id="ustar-archives"><a href="#ustar-archives" class="anchor"></a>Ustar archives</h2><div class="odoc-spec"><div class="spec value" id="val-tar" class="anchored"><a href="#val-tar" class="anchor"></a><code><span><span class="keyword">val</span> tar : <span><a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span>exclude_paths:<a href="../../../fpath/Fpath/index.html#type-set">Fpath.set</a> <span class="arrow">&#45;&gt;</span></span> <span>root:<a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span>mtime:int <span class="arrow">&#45;&gt;</span></span> <span><span>(string, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>tar dir ~exclude_paths ~root ~mtime</code> is a (us)tar archive that contains the file hierarchy <code>dir</code> except the relative hierarchies present in <code>exclude_paths</code>. In the archive, members of <code>dir</code> are rerooted at <code>root</code> and sorted according to <a href="../../../fpath/Fpath/index.html#val-compare"><code>Fpath.compare</code></a>. They have their modification time set to <code>mtime</code> and their file permissions are <code>0o775</code> for directories and files executable by the user and <code>0o664</code> for other files. No other file metadata is preserved.</p><p><b>Note.</b> This is a pure OCaml implementation, no <code>tar</code> tool is needed.</p></div></div><h2 id="bzip2-compression-and-unarchiving"><a href="#bzip2-compression-and-unarchiving" class="anchor"></a>Bzip2 compression and unarchiving</h2><div class="odoc-spec"><div class="spec value" id="val-ensure_bzip2" class="anchored"><a href="#val-ensure_bzip2" class="anchor"></a><code><span><span class="keyword">val</span> ensure_bzip2 : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>ensure_bzip2 ()</code> makes sure the <code>bzip2</code> utility is available.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bzip2" class="anchored"><a href="#val-bzip2" class="anchor"></a><code><span><span class="keyword">val</span> bzip2 : <span>string <span class="arrow">&#45;&gt;</span></span> <span>dst:<a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>bzip2 s dst</code> compresses <code>s</code> to <code>dst</code> using bzip2.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ensure_tar" class="anchored"><a href="#val-ensure_tar" class="anchor"></a><code><span><span class="keyword">val</span> ensure_tar : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>ensure_tar ()</code> makes sure the <code>tar</code> utility is available.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-untbz" class="anchored"><a href="#val-untbz" class="anchor"></a><code><span><span class="keyword">val</span> untbz : <span>?clean:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a>, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>untbz ~clean ar</code> untars the tar bzip2 archive <code>ar</code> in the same directory as <code>ar</code> and returns a base directory for <code>ar</code>. If <code>clean</code> is <code>true</code> (defaults to <code>false</code>) first delete the base directory if it exists.</p></div></div></div></body></html>