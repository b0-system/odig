<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Text (topkg-care.Topkg_care.Text)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">topkg-care</a> &#x00BB; <a href="../index.html">Topkg_care</a> &#x00BB; Text</nav><header class="odoc-preamble"><h1>Module <code><span>Topkg_care.Text</span></code></h1><p>Text processing helpers.</p></header><nav class="odoc-toc"><ul><li><a href="#marked-up-text-files">Marked-up text files</a></li><li><a href="#toy-change-log-parsing">Toy change log parsing</a></li><li><a href="#toy-uri-parsing">Toy URI parsing</a></li><li><a href="#edit-and-page-text">Edit and page text</a></li></ul></nav><div class="odoc-content"><h2 id="marked-up-text-files"><a href="#marked-up-text-files" class="anchor"></a>Marked-up text files</h2><p><b>Warning.</b> Some of the following functions are not serious and can break on certain valid inputs in all sorts of fashion. To understand breakage bear in mind that they operate line-wise.</p><div class="odoc-spec"><div class="spec type" id="type-flavour" class="anchored"><a href="#type-flavour" class="anchor"></a><code><span><span class="keyword">type</span> flavour</span><span> = </span><span>[ </span></code><table><tr id="type-flavour.Markdown" class="anchored"><td class="def constructor"><a href="#type-flavour.Markdown" class="anchor"></a><code><span>| </span></code><code><span>`Markdown</span></code></td></tr><tr id="type-flavour.Asciidoc" class="anchored"><td class="def constructor"><a href="#type-flavour.Asciidoc" class="anchor"></a><code><span>| </span></code><code><span>`Asciidoc</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for text document formats.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-flavour_of_fpath" class="anchored"><a href="#val-flavour_of_fpath" class="anchor"></a><code><span><span class="keyword">val</span> flavour_of_fpath : <span><a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-flavour">flavour</a> option</span></span></code></div><div class="spec-doc"><p><code>flavour_of_fpath p</code> determines a flavour according to the extension of <code>p</code> as follows:</p><ul><li><code>Some `Markdown</code> for <code>.md</code></li><li><code>Some `Asciidoc</code> for <code>.asciidoc</code> or <code>.adoc</code></li><li><code>None</code> otherwise</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-head" class="anchored"><a href="#val-head" class="anchor"></a><code><span><span class="keyword">val</span> head : <span>?flavour:<a href="#type-flavour">flavour</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * string)</span> option</span></span></code></div><div class="spec-doc"><p><code>head ~flavour text</code> extracts the <em>head</em> of the document <code>text</code> of flavour <code>flavour</code> (defaults to <code>`Markdown</code>).</p><p>The head is defined as follows:</p><ul><li>Anything before the first header is discarded.</li><li>The first header is kept in the first component</li><li>Everything that follows until the next header of the same or greater level is kept discarding trailing blank lines.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-header_title" class="anchored"><a href="#val-header_title" class="anchor"></a><code><span><span class="keyword">val</span> header_title : <span>?flavour:<a href="#type-flavour">flavour</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>header_title ~flavour text</code> extract the title of a header <code>text</code> of flavour <code>flavour</code> (defaults to <code>`Markdown</code>).</p></div></div><h2 id="toy-change-log-parsing"><a href="#toy-change-log-parsing" class="anchor"></a>Toy change log parsing</h2><div class="odoc-spec"><div class="spec value" id="val-change_log_last_entry" class="anchored"><a href="#val-change_log_last_entry" class="anchor"></a><code><span><span class="keyword">val</span> change_log_last_entry : <span>?flavour:<a href="#type-flavour">flavour</a> <span class="arrow">&#45;&gt;</span></span>
<span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span>(string * string)</span>)</span> option</span></span></code></div><div class="spec-doc"><p><code>change_log_last_version ~flavour text</code> tries to parse the last change log entry of <code>text</code> (i.e. the <a href="#val-head"><code>head</code></a> of <code>text</code>) into <code>Some (version, (header, text))</code>, where <code>(header,text)</code> is the result of <a href="#val-head"><code>head</code></a> and <code>version</code> a version number extracted from <code>header</code> (see <code>topkg-log(2)</code> for details).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-change_log_file_last_entry" class="anchored"><a href="#val-change_log_file_last_entry" class="anchor"></a><code><span><span class="keyword">val</span> change_log_file_last_entry : <span><a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span>(string * string)</span>, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>change_log_file_last_entry file</code> tries to parse the last change log entry of the file <code>file</code> using <a href="#val-flavour_of_fpath"><code>flavour_of_fpath</code></a> and and <a href="#val-change_log_last_entry"><code>change_log_last_entry</code></a>.</p></div></div><h2 id="toy-uri-parsing"><a href="#toy-uri-parsing" class="anchor"></a>Toy URI parsing</h2><div class="odoc-spec"><div class="spec value" id="val-split_uri" class="anchored"><a href="#val-split_uri" class="anchor"></a><code><span><span class="keyword">val</span> split_uri : <span>?rel:bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * string * string)</span> option</span></span></code></div><div class="spec-doc"><p><code>split_uri uri</code> splits <code>uri</code> into a triple <code>(scheme, host, path)</code>. If <code>rel</code> is <code>true</code> (defaults to <code>false</code>), a leading <code>&quot;/&quot;</code> in <code>path</code> is removed.</p></div></div><h2 id="edit-and-page-text"><a href="#edit-and-page-text" class="anchor"></a>Edit and page text</h2><div class="odoc-spec"><div class="spec value" id="val-edit_file" class="anchored"><a href="#val-edit_file" class="anchor"></a><code><span><span class="keyword">val</span> edit_file : <span><a href="../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(int, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>edit_file f</code> invokes the tool mentioned in the <code>EDITOR</code> environment variable with <code>f</code> and returns the exit code of the program.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_pager" class="anchored"><a href="#val-find_pager" class="anchor"></a><code><span><span class="keyword">val</span> find_pager : <span>don't:bool <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../../bos/Bos_setup/Cmd/index.html#type-t">Bos_setup.Cmd.t</a> option</span>, <a href="../../../bos/Bos_setup/R/index.html#type-msg">Bos_setup.R.msg</a>)</span> <a href="../../../bos/Bos_setup/index.html#type-result">Bos_setup.result</a></span></span></code></div><div class="spec-doc"><p><code>find ~no_pager</code> is an optional pager command. If <code>don't</code> is <code>true</code> returns <code>None</code>. Otherwise first consults the <code>PAGER</code> environment variable, then tries <code>less</code> or <code>more</code> in that order. If the <code>TERM</code> environment variable is <code>&quot;dumb&quot;</code> or undefined unconditionaly returns <code>None</code>.</p></div></div></div></body></html>