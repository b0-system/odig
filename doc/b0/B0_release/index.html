<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>B0_release (b0.B0_release)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">b0</a> &#x00BB; B0_release</nav><header class="odoc-preamble"><h1>Module <code><span>B0_release</span></code></h1><p>B0 software release helpers.</p></header><nav class="odoc-toc"><ul><li><a href="#release_meta">Release metadata</a></li><li><a href="#version">Versions</a></li><li><a href="#src">Source archives</a></li><li><a href="#changes">Change logs</a></li><li><a href="#cmdlets">Cmdlets</a></li></ul></nav><div class="odoc-content"><h2 id="release_meta"><a href="#release_meta" class="anchor"></a>Release metadata</h2><div class="odoc-spec"><div class="spec module" id="module-Meta" class="anchored"><a href="#module-Meta" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Meta/index.html">Meta</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Metadata keys for releases.</p></div></div><h2 id="version"><a href="#version" class="anchor"></a>Versions</h2><div class="odoc-spec"><div class="spec value" id="val-version_of_pack" class="anchored"><a href="#val-version_of_pack" class="anchor"></a><code><span><span class="keyword">val</span> version_of_pack : <span>?commit_ish:<a href="../B00_vcs/index.html#type-commit_ish">B00_vcs.commit_ish</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../B0_pack/index.html#type-t">B0_pack.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string, string)</span> <a href="../../ocaml/Stdlib/index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>version_of_pack p</code> looks for a VCS in the scope directory of <code>p</code> and gets its <a href="../B00_vcs/index.html#val-latest_tag">latest annotated tag</a> reachable from <code>commit_ish</code> (defaults to <code>&quot;HEAD&quot;</code>) and drops an initial <code>'v'</code> or <code>'V'</code>. <b>TODO.</b> add a meta key to prevent v drop.</p></div></div><h2 id="src"><a href="#src" class="anchor"></a>Source archives</h2><div class="odoc-spec"><div class="spec value" id="val-src_archive_name_of_pack" class="anchored"><a href="#val-src_archive_name_of_pack" class="anchor"></a><code><span><span class="keyword">val</span> src_archive_name_of_pack : <span><a href="../B0_pack/index.html#type-t">B0_pack.t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>src_archive_name_of_meta m</code> is the value or <a href="Meta/index.html#val-src_archive_name"><code>Meta.src_archive_name</code></a> or the pack's basename if absent, unless this is &quot;default&quot; in which case the basename of the pack's scope is taken.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-src_archive_ext_of_pack" class="anchored"><a href="#val-src_archive_ext_of_pack" class="anchor"></a><code><span><span class="keyword">val</span> src_archive_ext_of_pack : <span><a href="../B0_pack/index.html#type-t">B0_pack.t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>src_archive_ext_of_pack p</code> is the value of <a href="Meta/index.html#val-src_archive_ext"><code>Meta.src_archive_ext</code></a> of <code>p</code> or <code>&quot;.tbz&quot;</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-src_archive_url_of_pack" class="anchored"><a href="#val-src_archive_url_of_pack" class="anchor"></a><code><span><span class="keyword">val</span> src_archive_url_of_pack : <span>version:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../B0_pack/index.html#type-t">B0_pack.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(string, string)</span> <a href="../../ocaml/Stdlib/index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>src_url_of_meta ~version p</code> derives a source URL for the pack <code>p</code>. This looks up <a href="Meta/index.html#val-src_archive_url"><code>Meta.src_archive_url</code></a> <code>p</code> and substitute the variables as follows:</p><ul><li><code>%‌%ARCHIVE_NAME%‌%</code> with the value of <a href="#val-src_archive_name_of_pack"><code>src_archive_name_of_pack</code></a>.</li><li><code>%‌%ARCHIVE_EXT%‌%</code> with the value of <code>src_archive_name_of_ext</code>.</li><li><code>%‌%VERSION%‌%</code> with the value of <code>version</code></li><li><code>%‌%VERSION_NUM%‌%</code> with the value of <code>version</code> with an initial <code>v</code> or <code>V</code> chopped.</li></ul><p>If <a href="Meta/index.html#val-src_archive_url"><code>Meta.src_archive_url</code></a> is absent, let <code>%%HOMEPAGE%%</code> be the value of <a href="../B0_meta/index.html#val-homepage"><code>B0_meta.homepage</code></a> and <code>%%REPO%%</code> be the value of <a href="../B0_meta/index.html#val-repo"><code>B0_meta.repo</code></a> without the final <code>.git</code> and initial <code>git+</code> Then:</p><ul><li><p>If the hostname of <a href="../B0_meta/index.html#val-homepage"><code>B0_meta.homepage</code></a> is github the following URL pattern is used:</p><pre>%‌%REPO%‌%/releases/download/%‌%VERSION%‌%/\
%‌%ARCHIVE_NAME%‌%-%‌%VERSION_NUM%‌%‌%‌%ARCHIVE_EXT%‌%</pre></li><li><p>Otherwise the following URL pattern is used:</p><pre>%‌%HOMEPAGE%‌%/releases/\
%‌%ARCHIVE_NAME%‌%-%‌%VERSION_NUM%‌%‌%‌%ARCHIVE_EXT%‌%</pre></li></ul></div></div><h2 id="changes"><a href="#changes" class="anchor"></a>Change logs</h2><div class="odoc-spec"><div class="spec value" id="val-changes_file_of_pack" class="anchored"><a href="#val-changes_file_of_pack" class="anchor"></a><code><span><span class="keyword">val</span> changes_file_of_pack : <span><a href="../B0_pack/index.html#type-t">B0_pack.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../B00_std/Fpath/index.html#type-t">B00_std.Fpath.t</a> option</span>, string)</span> <a href="../../ocaml/Stdlib/index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>changes_file_of_pack p</code> looks for a <code>CHANGES.md</code> file located in the scope directory of <code>p</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-changes_latest_of_file" class="anchored"><a href="#val-changes_latest_of_file" class="anchor"></a><code><span><span class="keyword">val</span> changes_latest_of_file : <span><a href="../B00_std/Fpath/index.html#type-t">B00_std.Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span>(string * string)</span> option</span>, string)</span> <a href="../../ocaml/Stdlib/index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>changes_latest_of_file f</code> extracts the latest release notes as the <a href="../B00_cmark/index.html#val-first_section">first markdown section</a> of file <code>f</code>.</p></div></div><h2 id="cmdlets"><a href="#cmdlets" class="anchor"></a>Cmdlets</h2><div class="odoc-spec"><div class="spec module" id="module-Cmdlet" class="anchored"><a href="#module-Cmdlet" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Cmdlet/index.html">Cmdlet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><code>.release.*</code> Cmdlets</p></div></div></div></body></html>