<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Fut (brr.Fut)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">brr</a> &#x00BB; Fut</nav><header class="odoc-preamble"><h1>Module <code><span>Fut</span></code></h1><p>Future values.</p><p>A future <code>'a Fut.t</code> is an undetermined value of type <code>'a</code> that becomes determined at an arbitrary point in the future. The future acts as a placeholder for the value while it is undetermined.</p><p><code>Brr</code> uses future values <code>('a, 'b) result Fut.t</code> to type the resolution and rejection case of JavaScript promises. Since most rejection cases given by browser APIs are simply <a href="../Jv/Error/index.html#type-t"><code>Jv.Error.t</code></a> values, the dedicated <a href="#type-or_error"><code>Fut.or_error</code></a> type alias can be used for that.</p><p><a href="#type-t"><code>Fut.t</code></a> values are <em>indirectly</em> implemented as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> objects that never reject. You can't substitute them directly for JavaScript promises and vice-versa, use <a href="#val-of_promise"><code>of_promise</code></a> and <a href="#val-to_promise"><code>to_promise</code></a> to convert between them.</p></header><nav class="odoc-toc"><ul><li><a href="#futs">Futures</a></li><li><a href="#fut">Future results</a></li><li><a href="#promises">Converting with JavaScript promises</a></li><li><a href="#syntax">Future syntaxes</a></li></ul></nav><div class="odoc-content"><h2 id="futs"><a href="#futs" class="anchor"></a>Futures</h2><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>The type for futures with value of type <code>'a</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span> * <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span></span></code></div><div class="spec-doc"><p><code>create ()</code> is <code>(f, set</code> with <code>f</code> the future value and <code>set</code> the function to <code>set</code> it. The latter can be called only once, a <a href="../Jv/index.html#exception-Error"><code>Jv.Error</code></a> is thrown otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-await" class="anchored"><a href="#val-await" class="anchor"></a><code><span><span class="keyword">val</span> await : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>await f k</code> waits for <code>f</code> to determine <code>v</code> and continues with <code>k
    v</code>. If the future never determines <code>k</code> is not invoked. <code>k</code> must not raise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>return v</code> is a future that determines <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map fn f</code> is <code>return (fn v)</code> with <code>v</code> the value determined by <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bind" class="anchored"><a href="#val-bind" class="anchor"></a><code><span><span class="keyword">val</span> bind : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bind f fn</code> is the future <code>fn v</code> with <code>v</code> the value determined by <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pair" class="anchored"><a href="#val-pair" class="anchor"></a><code><span><span class="keyword">val</span> pair : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>pair f0 f1</code> is the future that determines with the value of <code>f0</code> and <code>f1</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_list" class="anchored"><a href="#val-of_list" class="anchor"></a><code><span><span class="keyword">val</span> of_list : <span><span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>of_list fs</code> determines with the values of all future <code>fs</code> in the same order.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tick" class="anchored"><a href="#val-tick" class="anchor"></a><code><span><span class="keyword">val</span> tick : <span>ms:int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>tick ~ms</code> determines <code>()</code> <code>ms</code> milliseconds after creation using <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout"><code>setTimeout</code></a>.</p></div></div><h2 id="fut"><a href="#fut" class="anchor"></a>Future results</h2><div class="odoc-spec"><div class="spec type" id="type-result" class="anchored"><a href="#type-result" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> <span>('a, 'b) result</span></span><span> = <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../../ocaml/Stdlib/index.html#type-result">result</a></span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>The type for future values that may error.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-or_error" class="anchored"><a href="#type-or_error" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a or_error</span></span><span> = <span><span>(<span class="type-var">'a</span>, <a href="../Jv/Error/index.html#type-t">Jv.Error.t</a>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p>The type for future values that error with a JavaScript error.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ok" class="anchored"><a href="#val-ok" class="anchor"></a><code><span><span class="keyword">val</span> ok : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>ok v</code> is <code>return (Ok v)</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-error" class="anchored"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>error e</code> is <code>return (Error e)</code>.</p></div></div><h2 id="promises"><a href="#promises" class="anchor"></a>Converting with JavaScript promises</h2><div class="odoc-spec"><div class="spec value" id="val-of_promise" class="anchored"><a href="#val-of_promise" class="anchor"></a><code><span><span class="keyword">val</span> of_promise : <span>ok:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-or_error">or_error</a></span></span></code></div><div class="spec-doc"><p><code>of_promise ~ok p</code> is <code>of_promise' ~ok ~error:Jv.to_error. p</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_promise" class="anchored"><a href="#val-to_promise" class="anchor"></a><code><span><span class="keyword">val</span> to_promise : <span>ok:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-or_error">or_error</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a></span></code></div><div class="spec-doc"><p><code>to_promise p</code> is <code>to_promise' ~ok ~error:Jv.of_error p</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_promise'" class="anchored"><a href="#val-of_promise'" class="anchor"></a><code><span><span class="keyword">val</span> of_promise' : <span>ok:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span>error:<span>(<span><a href="../Jv/index.html#type-t">Jv.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>of_promise ~ok ~error p</code> is a future for the promise <code>p</code>. The future determines with <code>Ok (ok v)</code> if <code>p</code> resolves with <code>v</code> and with <code>Error (error e)</code> if <code>p</code> rejects with <code>e</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_promise'" class="anchored"><a href="#val-to_promise'" class="anchor"></a><code><span><span class="keyword">val</span> to_promise' : <span>ok:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span>error:<span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/index.html#type-t">Jv.t</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="#type-result">result</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../Jv/Promise/index.html#type-t">Jv.Promise.t</a></span></code></div><div class="spec-doc"><p><code>to_promise f</code> is a JavaScript promise for the future <code>f</code> that resolves the promise with <code>ok v</code> if the future determines with <code>Ok
    v</code> and rejects with <code>e</code> if the future determines with <code>Error
    e</code>.</p></div></div><h2 id="syntax"><a href="#syntax" class="anchor"></a>Future syntaxes</h2><div class="odoc-spec"><div class="spec module" id="module-Syntax" class="anchored"><a href="#module-Syntax" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Syntax/index.html">Syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Future syntax.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Result_syntax" class="anchored"><a href="#module-Result_syntax" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Result_syntax/index.html">Result_syntax</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Future result syntax.</p></div></div></div></body></html>