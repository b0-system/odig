<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pkg (omod.Omod_support.Pkg)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">omod</a> &#x00BB; <a href="../index.html">Omod_support</a> &#x00BB; Pkg</nav><h1>Module <code>Omod_support.Pkg</code></h1><p>Packages.</p><p>Packages represents sets of compilation objects indexed from a root <a href="../Conf/index.html#val-libdir"><code>Conf.libdir</code></a>.</p><nav class="toc"><ul><li><a href="#pkg">Packages</a></li><li><a href="#signature">Package signatures</a></li><li><a href="#info">Package information</a></li><li><a href="#db">Package databases</a></li></ul></nav></header><section><header><h2 id="pkg"><a href="#pkg" class="anchor"></a>Packages</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <a href="../Cobj/index.html#type-pkg_id">Cobj.pkg_id</a></code></dt><dd><p>The type for packages.</p></dd></dl><dl><dt class="spec value" id="val-of_dir"><a href="#val-of_dir" class="anchor"></a><code><span class="keyword">val</span> of_dir : ?&#8288;err:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> <a href="../../Omod/index.html#type-fpath">Omod.fpath</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p><code>of_dir ~err dir</code> are the packages found in <code>dir</code>. This is simply all the directory names inside <code>dir</code> and an <code>ocaml</code> package which points to <code>ocamlc -where</code>. <code>err</code> is used to report file system errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>).</p></dd></dl><dl><dt class="spec value" id="val-find_cobjs"><a href="#val-find_cobjs" class="anchor"></a><code><span class="keyword">val</span> find_cobjs : ?&#8288;err:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> ?&#8288;acc:<a href="../Cobj/index.html#type-t">Cobj.t</a> list <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Cobj/index.html#type-t">Cobj.t</a> list</code></dt><dd><p><code>find_cobjs ~err ~note ~acc pkg</code> are the compilation objects contained in pkg <code>pkg</code> added to <code>acc</code> (defaults to <code>[]</code>). <code>err</code> is used to report errors (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>).</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal p0 p1</code> is <code>true</code> iff <code>p0</code> and <code>p1</code> have the same identifiers.</p></dd></dl><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare</code> is a total order on packages compatible with <a href="index.html#val-equal"><code>equal</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp</code> formats package identifiers.</p></dd></dl><dl><dt class="spec value" id="val-pp_name"><a href="#val-pp_name" class="anchor"></a><code><span class="keyword">val</span> pp_name : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_name</code> formats the name of package identifiers.</p></dd></dl><dl><dt class="spec module" id="module-Set"><a href="#module-Set" class="anchor"></a><code><span class="keyword">module</span> <a href="Set/index.html">Set</a> : <a href="../../../ocaml/Stdlib/Set/index.html#module-type-S">Stdlib.Set.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../ocaml/Stdlib/Set/module-type-S/index.html#type-elt">elt</a> = <a href="index.html#type-t">t</a></code></dt><dd><p>Package identifier sets.</p></dd></dl><dl><dt class="spec module" id="module-Map"><a href="#module-Map" class="anchor"></a><code><span class="keyword">module</span> <a href="Map/index.html">Map</a> : <a href="../../../ocaml/Stdlib/Map/index.html#module-type-S">Stdlib.Map.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../ocaml/Stdlib/Map/module-type-S/index.html#type-key">key</a> = <a href="index.html#type-t">t</a></code></dt><dd><p>Package identifier maps.</p></dd></dl></section><section><header><h2 id="signature"><a href="#signature" class="anchor"></a>Package signatures</h2></header><dl><dt class="spec type" id="type-signature"><a href="#type-signature" class="anchor"></a><code><span class="keyword">type</span> signature</code><code> = <a href="../Digest/index.html#type-t">Digest.t</a></code></dt><dd><p>The type for package signatures.</p></dd></dl><dl><dt class="spec value" id="val-signature"><a href="#val-signature" class="anchor"></a><code><span class="keyword">val</span> signature : ?&#8288;err:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-signature">signature</a></code></dt><dd><p><code>signature ~err pkg</code> is a signature for package <code>pkg</code>. This is the digest of the mtimes of all the cobjs of <code>pkg</code>. <code>err</code> is used to report error (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>).</p></dd></dl></section><section><header><h2 id="info"><a href="#info" class="anchor"></a>Package information</h2></header><dl><dt class="spec type" id="type-info"><a href="#type-info" class="anchor"></a><code><span class="keyword">type</span> info</code></dt><dd><p>The type for package information.</p></dd></dl><dl><dt class="spec value" id="val-info"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : signature:<a href="index.html#type-signature">signature</a> <span>&#45;&gt;</span> cobjs:<a href="../Cobj/index.html#type-t">Cobj.t</a> list <span>&#45;&gt;</span> <a href="index.html#type-info">info</a></code></dt><dd><p><code>info ~signature ~cobjs</code> is information for a package.</p></dd></dl><dl><dt class="spec value" id="val-info_signature"><a href="#val-info_signature" class="anchor"></a><code><span class="keyword">val</span> info_signature : <a href="index.html#type-info">info</a> <span>&#45;&gt;</span> <a href="index.html#type-signature">signature</a></code></dt><dd><p><code>info_signature i</code> is the package's signature.</p></dd></dl><dl><dt class="spec value" id="val-info_cobjs"><a href="#val-info_cobjs" class="anchor"></a><code><span class="keyword">val</span> info_cobjs : <a href="index.html#type-info">info</a> <span>&#45;&gt;</span> <a href="../Cobj/index.html#type-t">Cobj.t</a> list</code></dt><dd><p><code>info_signature i</code> is the package's compilation objects.</p></dd></dl><dl><dt class="spec value" id="val-pp_info"><a href="#val-pp_info" class="anchor"></a><code><span class="keyword">val</span> pp_info : <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-info">info</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_info</code> formats package information.</p></dd></dl></section><section><header><h2 id="db"><a href="#db" class="anchor"></a>Package databases</h2></header><dl><dt class="spec type" id="type-db"><a href="#type-db" class="anchor"></a><code><span class="keyword">type</span> db</code><code> = <a href="index.html#type-info">info</a> <a href="Map/index.html#type-t">Map.t</a></code></dt><dd><p>The type for package databases. Maps package names to their information.</p></dd></dl><dl><dt class="spec value" id="val-db"><a href="#val-db" class="anchor"></a><code><span class="keyword">val</span> db : ?&#8288;err:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> ?&#8288;note:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> ?&#8288;progress:bool <span>&#45;&gt;</span> ?&#8288;init:<a href="index.html#type-db">db</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="index.html#type-db">db</a></code></dt><dd><p><code>db ~err ~note ~progress ~init pkgs</code> is database <code>init</code> (dfeaults to <a href="Map/index.html#val-empty"><code>Map.empty</code></a>) with packages <code>pkgs</code> added. Their information is computed by the function using <code>err</code> to report errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>), <code>note</code> to report indexing operations (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>) and <code>progress</code> to indicate if progress should be reported on <code>note</code> (defaults to <code>false</code>).</p></dd></dl><dl><dt class="spec value" id="val-db_to_name_db"><a href="#val-db_to_name_db" class="anchor"></a><code><span class="keyword">val</span> db_to_name_db : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a> * <a href="index.html#type-info">info</a>) <a href="../../Omod/Private/String/Map/index.html#type-t">Omod.Private.String.Map.t</a></code></dt><dd><p><code>db_to_name_db db</code> maps package names (rather than identifiers) to their information.</p></dd></dl><dl><dt class="spec value" id="val-db_to_cobj_index"><a href="#val-db_to_cobj_index" class="anchor"></a><code><span class="keyword">val</span> db_to_cobj_index : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> <a href="../Cobj/Index/index.html#type-t">Cobj.Index.t</a></code></dt><dd><p><code>db_to_cobj_index db</code> is a compilatino object with the contents of the packages of <code>db</code>.</p></dd></dl><dl><dt class="spec type" id="type-diff"><a href="#type-diff" class="anchor"></a><code><span class="keyword">type</span> diff</code> = <code>[ </code><table class="variant"><tr id="type-diff.New" class="anchored"><td class="def constructor"><a href="#type-diff.New" class="anchor"></a><code>| </code><code>`New <span class="keyword">of</span> <a href="index.html#type-t">t</a> * <a href="index.html#type-signature">signature</a></code></td></tr><tr id="type-diff.Changed" class="anchored"><td class="def constructor"><a href="#type-diff.Changed" class="anchor"></a><code>| </code><code>`Changed <span class="keyword">of</span> <a href="index.html#type-t">t</a> * <a href="index.html#type-signature">signature</a></code></td></tr><tr id="type-diff.Gone" class="anchored"><td class="def constructor"><a href="#type-diff.Gone" class="anchor"></a><code>| </code><code>`Gone <span class="keyword">of</span> <a href="index.html#type-t">t</a></code></td></tr></table><code> ]</code></dt></dl><aside><p>The type for package database differences.</p><ul><li><code>`New (pkg, sg)</code>, package <code>pkg</code> with signature <code>sg</code> is new.</li><li><code>`Gone pkg</code>, package <code>pkg</code> was removed.</li><li><code>`Changed (pkg, sg)</code>, package <code>pkg</code> changed to signature <code>sg</code>.</li></ul></aside><dl><dt class="spec value" id="val-pp_diff"><a href="#val-pp_diff" class="anchor"></a><code><span class="keyword">val</span> pp_diff : <a href="index.html#type-diff">diff</a> <a href="../../Omod/Private/Fmt/index.html#type-t">Omod.Private.Fmt.t</a></code></dt><dd><p><code>pp_diff</code> formats package database differences.</p></dd></dl><dl><dt class="spec value" id="val-diff"><a href="#val-diff" class="anchor"></a><code><span class="keyword">val</span> diff : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> (<a href="index.html#type-t">t</a> * <a href="index.html#type-signature">signature</a>) list <span>&#45;&gt;</span> <a href="index.html#type-diff">diff</a> list</code></dt><dd><p><code>diff db sgs</code> is the list of difference between <code>db</code> and package signatures <code>sgs</code>.</p></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val</span> update : ?&#8288;err:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> ?&#8288;note:<a href="../Log/index.html#type-t">Log.t</a> <span>&#45;&gt;</span> ?&#8288;progress:bool <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> <a href="index.html#type-diff">diff</a> list <span>&#45;&gt;</span> <a href="index.html#type-db">db</a></code></dt><dd><p><code>udpate ~err ~note ~progress db diffs</code> is <code>db</code> updated according to <code>diffs</code>. <code>err</code> is used to report errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>), <code>note</code> to report indexing operations (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>) and <code>progress</code> to indicate if progress should be reported on <code>note</code> (defaults to <code>false</code>).</p></dd></dl></section></div></body></html>