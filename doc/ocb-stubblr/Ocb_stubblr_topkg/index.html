<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ocb_stubblr_topkg (ocb-stubblr.Ocb_stubblr_topkg)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">ocb-stubblr</a> &#x00BB; Ocb_stubblr_topkg</nav><header class="odoc-preamble"><h1>Module <code><span>Ocb_stubblr_topkg</span></code></h1><p>Hook up <a href="../Ocb_stubblr/index.html"><code>Ocb_stubblr</code></a> with <code>topkg</code>.</p></header><nav class="odoc-toc"><ul><li><a href="#activating-ocb-stubblr">Activating <code>ocb-stubblr</code></a></li><li><a href="#install-helpers">Install helpers</a></li><li><a href="#usage">Usage</a><ul><li><a href="#making-ocb-stubblr-available-from-myocamlbuild.ml">Making <code>ocb-stubblr</code> available from <code>myocamlbuild.ml</code></a></li><li><a href="#mirage">Mirage</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="activating-ocb-stubblr"><a href="#activating-ocb-stubblr" class="anchor"></a>Activating <code>ocb-stubblr</code></h2><div class="odoc-spec"><div class="spec value" id="val-build_arg" class="anchored"><a href="#val-build_arg" class="anchor"></a><code><span><span class="keyword">val</span> build_arg : <a href="../../topkg/Topkg/Cmd/index.html#type-t">Topkg.Cmd.t</a></span></code></div><div class="spec-doc"><p><code>build_arg</code> is the command-line parameter that needs to be passed to <code>ocamlbuild</code> in order to access <a href="../Ocb_stubblr/index.html"><code>Ocb_stubblr</code></a> inside <code>myocamlbuild.ml</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-build_cmd" class="anchored"><a href="#val-build_cmd" class="anchor"></a><code><span><span class="keyword">val</span> build_cmd : <span><a href="../../topkg/Topkg/Conf/index.html#type-t">Topkg.Conf.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../topkg/Topkg/Conf/index.html#type-os">Topkg.Conf.os</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../topkg/Topkg/Cmd/index.html#type-t">Topkg.Cmd.t</a></span></code></div><div class="spec-doc"><p><code>build_cmd c os</code> is the default <code>Topkg</code>.build_cmd extended with <a href="#val-build_arg"><code>build_arg</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-cmd" class="anchored"><a href="#val-cmd" class="anchor"></a><code><span><span class="keyword">val</span> cmd : <span><a href="../../topkg/Topkg/Conf/index.html#type-t">Topkg.Conf.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../topkg/Topkg/Conf/index.html#type-os">Topkg.Conf.os</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../topkg/Topkg/index.html#type-fpath">Topkg.fpath</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../topkg/Topkg/index.html#type-result">Topkg.result</a></span></span></code></div><div class="spec-doc"><p><code>cmd c os files</code> is a full invocation of <a href="#val-build_cmd"><code>build_cmd</code></a>.</p></div></div><h2 id="install-helpers"><a href="#install-helpers" class="anchor"></a>Install helpers</h2><div class="odoc-spec"><div class="spec value" id="val-mirage" class="anchored"><a href="#val-mirage" class="anchor"></a><code><span><span class="keyword">val</span> mirage : <span>?xen:bool <span class="arrow">&#45;&gt;</span></span> <span>?fs:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../topkg/Topkg/index.html#type-fpath">Topkg.fpath</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../topkg/Topkg/Pkg/index.html#type-install">Topkg.Pkg.install</a></span></code></div><div class="spec-doc"><p><code>mirage ?xen ?fs clib</code> installs Mirage-specific <a href="../Ocb_stubblr/index.html#multilib">multi-lib</a> variants of the given <code>.clib</code> file.</p><p><code>xen</code> enables <code>mirage-xen</code> target. Defaults to <code>false</code>.</p><p><code>fs</code> enables <code>mirage-freestanding</code> target. Defaults to <code>false</code>.</p></div></div><h2 id="usage"><a href="#usage" class="anchor"></a>Usage</h2><p>In <code>pkg.ml</code>:</p><h3 id="making-ocb-stubblr-available-from-myocamlbuild.ml"><a href="#making-ocb-stubblr-available-from-myocamlbuild.ml" class="anchor"></a>Making <code>ocb-stubblr</code> available from <code>myocamlbuild.ml</code></h3><pre><code>#require &quot;ocb-stubblr.topkg&quot;

let build = Pkg.build ~cmd:Ocb_stubblr_topkg.cmd ()

let () = Pkg.describe ~build ...</code></pre><h3 id="mirage"><a href="#mirage" class="anchor"></a>Mirage</h3><pre><code>Pkg.describe ... @@ fun c -&gt;
...
Ok [ ...; mirage ~xen ~fs &quot;path/to/libstubs.clib&quot;]</code></pre></div></body></html>