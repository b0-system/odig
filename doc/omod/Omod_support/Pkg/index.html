<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pkg (omod.Omod_support.Pkg)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">omod</a> &#x00BB; <a href="../index.html">Omod_support</a> &#x00BB; Pkg</nav><header class="odoc-preamble"><h1>Module <code><span>Omod_support.Pkg</span></code></h1><p>Packages.</p><p>Packages represents sets of compilation objects indexed from a root <a href="../Conf/index.html#val-libdir"><code>Conf.libdir</code></a>.</p></header><nav class="odoc-toc"><ul><li><a href="#pkg">Packages</a></li><li><a href="#signature">Package signatures</a></li><li><a href="#info">Package information</a></li><li><a href="#db">Package databases</a></li></ul></nav><div class="odoc-content"><h2 id="pkg"><a href="#pkg" class="anchor"></a>Packages</h2><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <a href="../Cobj/index.html#type-pkg_id">Cobj.pkg_id</a></span></code></div><div class="spec-doc"><p>The type for packages.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_dir" class="anchored"><a href="#val-of_dir" class="anchor"></a><code><span><span class="keyword">val</span> of_dir : <span>?err:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Omod/index.html#type-fpath">Omod.fpath</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> list</span></span></code></div><div class="spec-doc"><p><code>of_dir ~err dir</code> are the packages found in <code>dir</code>. This is simply all the directory names inside <code>dir</code> and an <code>ocaml</code> package which points to <code>ocamlc -where</code>. <code>err</code> is used to report file system errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_cobjs" class="anchored"><a href="#val-find_cobjs" class="anchor"></a><code><span><span class="keyword">val</span> find_cobjs : <span>?err:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?acc:<span><a href="../Cobj/index.html#type-t">Cobj.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cobj/index.html#type-t">Cobj.t</a> list</span></span></code></div><div class="spec-doc"><p><code>find_cobjs ~err ~note ~acc pkg</code> are the compilation objects contained in pkg <code>pkg</code> added to <code>acc</code> (defaults to <code>[]</code>). <code>err</code> is used to report errors (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal" class="anchored"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>equal p0 p1</code> is <code>true</code> iff <code>p0</code> and <code>p1</code> have the same identifiers.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-compare" class="anchored"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>compare</code> is a total order on packages compatible with <a href="#val-equal"><code>equal</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp</code> formats package identifiers.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_name" class="anchored"><a href="#val-pp_name" class="anchor"></a><code><span><span class="keyword">val</span> pp_name : <span><a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp_name</code> formats the name of package identifiers.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Set" class="anchored"><a href="#module-Set" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Set/index.html">Set</a></span><span> : <a href="../../../ocaml/Stdlib/Set/module-type-S/index.html">Set.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../ocaml/Stdlib/Set/module-type-S/index.html#type-elt">elt</a> = <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Package identifier sets.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Map" class="anchored"><a href="#module-Map" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Map/index.html">Map</a></span><span> : <a href="../../../ocaml/Stdlib/Map/module-type-S/index.html">Map.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../ocaml/Stdlib/Map/module-type-S/index.html#type-key">key</a> = <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Package identifier maps.</p></div></div><h2 id="signature"><a href="#signature" class="anchor"></a>Package signatures</h2><div class="odoc-spec"><div class="spec type" id="type-signature" class="anchored"><a href="#type-signature" class="anchor"></a><code><span><span class="keyword">type</span> signature</span><span> = <a href="../Digest/index.html#type-t">Digest.t</a></span></code></div><div class="spec-doc"><p>The type for package signatures.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-signature" class="anchored"><a href="#val-signature" class="anchor"></a><code><span><span class="keyword">val</span> signature : <span>?err:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-signature">signature</a></span></code></div><div class="spec-doc"><p><code>signature ~err pkg</code> is a signature for package <code>pkg</code>. This is the digest of the mtimes of all the cobjs of <code>pkg</code>. <code>err</code> is used to report error (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>).</p></div></div><h2 id="info"><a href="#info" class="anchor"></a>Package information</h2><div class="odoc-spec"><div class="spec type" id="type-info" class="anchored"><a href="#type-info" class="anchor"></a><code><span><span class="keyword">type</span> info</span></code></div><div class="spec-doc"><p>The type for package information.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span><span class="keyword">val</span> info : <span>signature:<a href="#type-signature">signature</a> <span class="arrow">&#45;&gt;</span></span> <span>cobjs:<span><a href="../Cobj/index.html#type-t">Cobj.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-info">info</a></span></code></div><div class="spec-doc"><p><code>info ~signature ~cobjs</code> is information for a package.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info_signature" class="anchored"><a href="#val-info_signature" class="anchor"></a><code><span><span class="keyword">val</span> info_signature : <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-signature">signature</a></span></code></div><div class="spec-doc"><p><code>info_signature i</code> is the package's signature.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info_cobjs" class="anchored"><a href="#val-info_cobjs" class="anchor"></a><code><span><span class="keyword">val</span> info_cobjs : <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Cobj/index.html#type-t">Cobj.t</a> list</span></span></code></div><div class="spec-doc"><p><code>info_signature i</code> is the package's compilation objects.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_info" class="anchored"><a href="#val-pp_info" class="anchor"></a><code><span><span class="keyword">val</span> pp_info : <span><a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Format.formatter</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-info">info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp_info</code> formats package information.</p></div></div><h2 id="db"><a href="#db" class="anchor"></a>Package databases</h2><div class="odoc-spec"><div class="spec type" id="type-db" class="anchored"><a href="#type-db" class="anchor"></a><code><span><span class="keyword">type</span> db</span><span> = <span><a href="#type-info">info</a> <a href="Map/index.html#type-t">Map.t</a></span></span></code></div><div class="spec-doc"><p>The type for package databases. Maps package names to their information.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-db" class="anchored"><a href="#val-db" class="anchor"></a><code><span><span class="keyword">val</span> db : <span>?err:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?note:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?progress:bool <span class="arrow">&#45;&gt;</span></span> <span>?init:<a href="#type-db">db</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-db">db</a></span></code></div><div class="spec-doc"><p><code>db ~err ~note ~progress ~init pkgs</code> is database <code>init</code> (dfeaults to <code>Map</code>.empty) with packages <code>pkgs</code> added. Their information is computed by the function using <code>err</code> to report errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>), <code>note</code> to report indexing operations (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>) and <code>progress</code> to indicate if progress should be reported on <code>note</code> (defaults to <code>false</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-db_to_name_db" class="anchored"><a href="#val-db_to_name_db" class="anchor"></a><code><span><span class="keyword">val</span> db_to_name_db : <span><a href="#type-db">db</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-t">t</a> * <a href="#type-info">info</a>)</span> <a href="../../Omod/Private/String/Map/index.html#type-t">Omod.Private.String.Map.t</a></span></span></code></div><div class="spec-doc"><p><code>db_to_name_db db</code> maps package names (rather than identifiers) to their information.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-db_to_cobj_index" class="anchored"><a href="#val-db_to_cobj_index" class="anchor"></a><code><span><span class="keyword">val</span> db_to_cobj_index : <span><a href="#type-db">db</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Cobj/Index/index.html#type-t">Cobj.Index.t</a></span></code></div><div class="spec-doc"><p><code>db_to_cobj_index db</code> is a compilatino object with the contents of the packages of <code>db</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-diff" class="anchored"><a href="#type-diff" class="anchor"></a><code><span><span class="keyword">type</span> diff</span><span> = </span><span>[ </span></code><table><tr id="type-diff.New" class="anchored"><td class="def constructor"><a href="#type-diff.New" class="anchor"></a><code><span>| </span></code><code><span>`New <span class="keyword">of</span> <a href="#type-t">t</a> * <a href="#type-signature">signature</a></span></code></td></tr><tr id="type-diff.Changed" class="anchored"><td class="def constructor"><a href="#type-diff.Changed" class="anchor"></a><code><span>| </span></code><code><span>`Changed <span class="keyword">of</span> <a href="#type-t">t</a> * <a href="#type-signature">signature</a></span></code></td></tr><tr id="type-diff.Gone" class="anchored"><td class="def constructor"><a href="#type-diff.Gone" class="anchor"></a><code><span>| </span></code><code><span>`Gone <span class="keyword">of</span> <a href="#type-t">t</a></span></code></td></tr></table><code><span> ]</span></code></div></div><p>The type for package database differences.</p><ul><li><code>`New (pkg, sg)</code>, package <code>pkg</code> with signature <code>sg</code> is new.</li><li><code>`Gone pkg</code>, package <code>pkg</code> was removed.</li><li><code>`Changed (pkg, sg)</code>, package <code>pkg</code> changed to signature <code>sg</code>.</li></ul><div class="odoc-spec"><div class="spec value" id="val-pp_diff" class="anchored"><a href="#val-pp_diff" class="anchor"></a><code><span><span class="keyword">val</span> pp_diff : <span><a href="#type-diff">diff</a> <a href="../../Omod/Private/Fmt/index.html#type-t">Omod.Private.Fmt.t</a></span></span></code></div><div class="spec-doc"><p><code>pp_diff</code> formats package database differences.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-diff" class="anchored"><a href="#val-diff" class="anchor"></a><code><span><span class="keyword">val</span> diff : <span><a href="#type-db">db</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="#type-t">t</a> * <a href="#type-signature">signature</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-diff">diff</a> list</span></span></code></div><div class="spec-doc"><p><code>diff db sgs</code> is the list of difference between <code>db</code> and package signatures <code>sgs</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-update" class="anchored"><a href="#val-update" class="anchor"></a><code><span><span class="keyword">val</span> update : <span>?err:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?note:<a href="../Log/index.html#type-t">Log.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?progress:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-db">db</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-diff">diff</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-db">db</a></span></code></div><div class="spec-doc"><p><code>udpate ~err ~note ~progress db diffs</code> is <code>db</code> updated according to <code>diffs</code>. <code>err</code> is used to report errors (defaults to <a href="../Log/index.html#val-err"><code>Log.err</code></a>), <code>note</code> to report indexing operations (defaults to <a href="../Log/index.html#val-nil"><code>Log.nil</code></a>) and <code>progress</code> to indicate if progress should be reported on <code>note</code> (defaults to <code>false</code>).</p></div></div></div></body></html>