<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bi_outbuf (biniou.Bi_outbuf)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">biniou</a> &#x00BB; Bi_outbuf</nav><h1>Module <code>Bi_outbuf</code></h1><p>Output buffer</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><code>{</code><table class="record"><tr id="type-t.o_s" class="anchored"><td class="def field"><a href="#type-t.o_s" class="anchor"></a><code><span class="keyword">mutable</span> o_s : bytes;</code></td><td class="doc"><p>Buffer string</p></td></tr><tr id="type-t.o_max_len" class="anchored"><td class="def field"><a href="#type-t.o_max_len" class="anchor"></a><code><span class="keyword">mutable</span> o_max_len : int;</code></td><td class="doc"><p>Same as <code>String.length s</code></p></td></tr><tr id="type-t.o_len" class="anchored"><td class="def field"><a href="#type-t.o_len" class="anchor"></a><code><span class="keyword">mutable</span> o_len : int;</code></td><td class="doc"><p>Length of the data present in the buffer = current position in the buffer</p></td></tr><tr id="type-t.o_offs" class="anchored"><td class="def field"><a href="#type-t.o_offs" class="anchor"></a><code><span class="keyword">mutable</span> o_offs : int;</code></td><td class="doc"><p>Length of data written and flushed out of the buffer. The total number of bytes written to the buffer is therefore <code>o_offs + o_len</code>.</p></td></tr><tr id="type-t.o_init_len" class="anchored"><td class="def field"><a href="#type-t.o_init_len" class="anchor"></a><code>o_init_len : int;</code></td><td class="doc"><p>Initial length of the buffer</p></td></tr><tr id="type-t.o_make_room" class="anchored"><td class="def field"><a href="#type-t.o_make_room" class="anchor"></a><code>o_make_room : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit;</code></td><td class="doc"><p><code>make_room buf n</code> must provide space for at least the requested number of bytes <code>n</code>, typically by reallocating a larger buffer string or by flushing the data to a channel. This function is only called when there is not enough space for <code>n</code> bytes.</p></td></tr><tr id="type-t.o_shared" class="anchored"><td class="def field"><a href="#type-t.o_shared" class="anchor"></a><code><span class="keyword">mutable</span> o_shared : <a href="../Bi_share/Wr/index.html#type-tbl">Bi_share.Wr.tbl</a>;</code></td><td class="doc"><p>Hash table used to map shared objects to positions in the input stream.</p></td></tr><tr id="type-t.o_shared_init_len" class="anchored"><td class="def field"><a href="#type-t.o_shared_init_len" class="anchor"></a><code>o_shared_init_len : int;</code></td><td class="doc"><p>Initial length of the <code>o_shared</code> table.</p></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-really_extend"><a href="#val-really_extend" class="anchor"></a><code><span class="keyword">val</span> really_extend : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>Default make_room function: reallocate a larger buffer string.</p></dd></dl><dl><dt class="spec value" id="val-flush_to_channel"><a href="#val-flush_to_channel" class="anchor"></a><code><span class="keyword">val</span> flush_to_channel : <a href="../../ocaml/Stdlib/index.html#type-out_channel">Stdlib.out_channel</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>Alternate make_room function: write to an out_channel.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : ?&#8288;make_room:(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> ?&#8288;shrlen:int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Create a buffer. The default <code>make_room</code> function is <code>really_extend</code>.</p><dl><dt>parameter shrlen</dt><dd><p>initial size of the table used to store shared values.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-contents"><a href="#val-contents" class="anchor"></a><code><span class="keyword">val</span> contents : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Returns the data currently in the buffer.</p></dd></dl><dl><dt class="spec value" id="val-create_channel_writer"><a href="#val-create_channel_writer" class="anchor"></a><code><span class="keyword">val</span> create_channel_writer : ?&#8288;len:int <span>&#45;&gt;</span> ?&#8288;shrlen:int <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/index.html#type-out_channel">Stdlib.out_channel</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-flush_channel_writer"><a href="#val-flush_channel_writer" class="anchor"></a><code><span class="keyword">val</span> flush_channel_writer : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pair of convenience functions for creating a buffer that flushes data to an out_channel when it is full.</p></dd></dl><dl><dt class="spec value" id="val-create_output_writer"><a href="#val-create_output_writer" class="anchor"></a><code><span class="keyword">val</span> create_output_writer : ?&#8288;len:int <span>&#45;&gt;</span> ?&#8288;shrlen:int <span>&#45;&gt;</span> &lt; output : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int; .. &gt; <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-flush_output_writer"><a href="#val-flush_output_writer" class="anchor"></a><code><span class="keyword">val</span> flush_output_writer : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pair of convenience functions for creating a buffer that flushes data to an object when it is full.</p></dd></dl><dl><dt class="spec value" id="val-extend"><a href="#val-extend" class="anchor"></a><code><span class="keyword">val</span> extend : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>Guarantee that the buffer string has enough room for n additional bytes.</p></dd></dl><dl><dt class="spec value" id="val-alloc"><a href="#val-alloc" class="anchor"></a><code><span class="keyword">val</span> alloc : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int</code></dt><dd><p><code>alloc buf n</code> makes room for <code>n</code> bytes and returns the position of the first byte in the buffer string <code>buf.s</code>. It behaves as if <code>n</code> arbitrary bytes were added and it is the user's responsibility to set them to some meaningful values by accessing <code>buf.s</code> directly.</p></dd></dl><dl><dt class="spec value" id="val-add_bytes"><a href="#val-add_bytes" class="anchor"></a><code><span class="keyword">val</span> add_bytes : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> unit</code></dt><dd><p>Add bytes to the buffer.</p><dl><dt>since</dt><dd>1.2.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-add_subbytes"><a href="#val-add_subbytes" class="anchor"></a><code><span class="keyword">val</span> add_subbytes : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_subbytes dst src srcpos len</code> copies <code>len</code> bytes from bytes <code>src</code> to buffer <code>dst</code> starting from position <code>srcpos</code>.</p><dl><dt>since</dt><dd>1.2.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-add_string"><a href="#val-add_string" class="anchor"></a><code><span class="keyword">val</span> add_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p>Add a string to the buffer.</p></dd></dl><dl><dt class="spec value" id="val-add_substring"><a href="#val-add_substring" class="anchor"></a><code><span class="keyword">val</span> add_substring : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_substring dst src srcpos len</code> copies <code>len</code> bytes from string <code>src</code> to buffer <code>dst</code> starting from position <code>srcpos</code>.</p></dd></dl><dl><dt class="spec value" id="val-add_char"><a href="#val-add_char" class="anchor"></a><code><span class="keyword">val</span> add_char : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Add a byte to the buffer.</p></dd></dl><dl><dt class="spec value" id="val-add_char2"><a href="#val-add_char2" class="anchor"></a><code><span class="keyword">val</span> add_char2 : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Add two bytes to the buffer.</p></dd></dl><dl><dt class="spec value" id="val-add_char4"><a href="#val-add_char4" class="anchor"></a><code><span class="keyword">val</span> add_char4 : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> char <span>&#45;&gt;</span> char <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Add four bytes to the buffer.</p></dd></dl><dl><dt class="spec value" id="val-unsafe_add_char"><a href="#val-unsafe_add_char" class="anchor"></a><code><span class="keyword">val</span> unsafe_add_char : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> unit</code></dt><dd><p>Add a byte to the buffer without checking that there is enough room for it.</p></dd></dl><dl><dt class="spec value" id="val-clear"><a href="#val-clear" class="anchor"></a><code><span class="keyword">val</span> clear : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Remove any data present in the buffer and in the table holding shared objects.</p></dd></dl><dl><dt class="spec value" id="val-reset"><a href="#val-reset" class="anchor"></a><code><span class="keyword">val</span> reset : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Remove any data present in the buffer and reset it to its original size. Remove any data present in the table holding shared objects and reset it to its original size.</p></dd></dl></div></body></html>