<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Qrc (qrc.Qrc)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">qrc</a> &#x00BB; Qrc</nav><header class="odoc-preamble"><h1>Module <code><span>Qrc</span></code></h1><p>QR code encoder.</p><p>Consult the <a href="#notes_limits">limitations</a> and an encoding <a href="#example">example</a>.</p><p><b>References.</b></p><p>ISO/IEC 18004:2015. <em>QR Code bar code symbology specification</em>.</p></header><nav class="odoc-toc"><ul><li><a href="#matrices">Matrices</a></li><li><a href="#props">Properties</a></li><li><a href="#encoding">Encoding</a></li><li><a href="#notes_limits">Notes and limitations</a><ul><li><a href="#encoding_2">Encoding</a></li></ul></li><li><a href="#example">Example</a></li></ul></nav><div class="odoc-content"><h2 id="matrices"><a href="#matrices" class="anchor"></a>Matrices</h2><div class="odoc-spec"><div class="spec module" id="module-Matrix" class="anchored"><a href="#module-Matrix" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Matrix/index.html">Matrix</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>QR 2D matrices.</p></div></div><h2 id="props"><a href="#props" class="anchor"></a>Properties</h2><div class="odoc-spec"><div class="spec type" id="type-version" class="anchored"><a href="#type-version" class="anchor"></a><code><span><span class="keyword">type</span> version</span><span> = </span><span>[ </span></code><table><tr id="type-version.V" class="anchored"><td class="def constructor"><a href="#type-version.V" class="anchor"></a><code><span>| </span></code><code><span>`V <span class="keyword">of</span> int</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for QR code versions, from 1 to 40.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-ec_level" class="anchored"><a href="#type-ec_level" class="anchor"></a><code><span><span class="keyword">type</span> ec_level</span><span> = </span><span>[ </span></code><table><tr id="type-ec_level.L" class="anchored"><td class="def constructor"><a href="#type-ec_level.L" class="anchor"></a><code><span>| </span></code><code><span>`L</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>7%</p><span class="comment-delim">*)</span></td></tr><tr id="type-ec_level.M" class="anchored"><td class="def constructor"><a href="#type-ec_level.M" class="anchor"></a><code><span>| </span></code><code><span>`M</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>15%</p><span class="comment-delim">*)</span></td></tr><tr id="type-ec_level.Q" class="anchored"><td class="def constructor"><a href="#type-ec_level.Q" class="anchor"></a><code><span>| </span></code><code><span>`Q</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>25%</p><span class="comment-delim">*)</span></td></tr><tr id="type-ec_level.H" class="anchored"><td class="def constructor"><a href="#type-ec_level.H" class="anchor"></a><code><span>| </span></code><code><span>`H</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>30%</p><span class="comment-delim">*)</span></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for QR code error correction levels. Four levels respectively allowing 7%, 15%, 25% and 30% recovery of the QR code.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-mode" class="anchored"><a href="#type-mode" class="anchor"></a><code><span><span class="keyword">type</span> mode</span><span> = </span><span>[ </span></code><table><tr id="type-mode.Byte" class="anchored"><td class="def constructor"><a href="#type-mode.Byte" class="anchor"></a><code><span>| </span></code><code><span>`Byte</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>byte data</p><span class="comment-delim">*)</span></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for (supported) data encoding modes.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Gf_256" class="anchored"><a href="#module-Gf_256" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Gf_256/index.html">Gf_256</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Arithmetic over galois field GF(2<sup>8</sup>).</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Prop" class="anchored"><a href="#module-Prop" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Prop/index.html">Prop</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>QR code properties.</p></div></div><h2 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h2><div class="odoc-spec"><div class="spec value" id="val-encode" class="anchored"><a href="#val-encode" class="anchor"></a><code><span><span class="keyword">val</span> encode : <span>?mask:int <span class="arrow">&#45;&gt;</span></span> <span>?version:<a href="#type-version">version</a> <span class="arrow">&#45;&gt;</span></span> <span>?mode:<a href="#type-mode">mode</a> <span class="arrow">&#45;&gt;</span></span> <span>?ec_level:<a href="#type-ec_level">ec_level</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="Matrix/index.html#type-t">Matrix.t</a> option</span></span></code></div><div class="spec-doc"><p><code>encode ~version ~mode ~ec_level data</code> is a QR matrix encoding bytes <code>data</code> with:</p><ul><li><code>ec_level</code>, the error correction level, defaults to <code>`M</code>.</li><li><code>version</code>, the version of the QR code. If unspecified the minimal needed version for the given <code>ec_level</code> is used.</li><li><code>mode</code> is the encoding mode. If unspecified it is guessed, but guess what, only <code>`Byte</code> mode is supported.</li><li><code>mask</code> can be used to force the data mask. This should not be used, the best mask to please your scanner is automatically selected as mandated by the standard.</li></ul><p><code>None</code> is returned if <code>data</code> is too large to be fit the specified QR code parameters. Use <a href="Prop/index.html#val-mode_capacity"><code>Prop.mode_capacity</code></a> to find data capacity for given QR code properties beforehand.</p><p><b>Note.</b> Sometimes once the <code>version</code> and <code>ec_level</code> constraints are satisfied for <code>data</code> we can fit the data in a higher <code>ec_level</code> with the same <code>version</code> (i.e. same matrix width). In that case that higher error correction level is used instead of the given or default <code>ec_level</code>.</p></div></div><h2 id="notes_limits"><a href="#notes_limits" class="anchor"></a>Notes and limitations</h2><h3 id="encoding_2"><a href="#encoding_2" class="anchor"></a>Encoding</h3><ul><li>Only the (universal) byte mode data encoding is supported. This may mean larger QR codes if you are trying to encode only decimal digits, only decimal digits and uppercase US-ASCII letters or only Kanji characters.</li><li>For textual data, using UTF-8 with <code>`Bytes</code> should work reasonably well. The module does not implement the ECI scheme to specify the encoding. Signals from the interwebs seem to indicate it's better to let scanners auto-discover the encoding as some do not understand the ECI scheme.</li><li>Structured append, i.e. data represented by up to 16 linked QR codes, is not supported – who does ?</li></ul><h2 id="example"><a href="#example" class="anchor"></a>Example</h2><p>The following generates a QR code matrix for the given <code>data</code> bytes and outputs it as an SVG image on <code>stdout</code>.</p><pre><code>let output_svg_qr data = match Qrc.encode data with
| None -&gt; prerr_endline &quot;Data capacity exceeded!&quot;
| Some m -&gt; print_endline (Qrc.Matrix.to_svg m)</code></pre></div></body></html>