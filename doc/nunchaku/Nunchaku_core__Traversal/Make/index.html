<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (nunchaku.Nunchaku_core__Traversal.Make)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">nunchaku</a> &#x00BB; <a href="../index.html">Nunchaku_core__Traversal</a> &#x00BB; Make</nav><h1>Module <code>Nunchaku_core__Traversal.Make</code></h1></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-T/index.html">T</a> : <a href="../../Nunchaku_core/TermInner/index.html#module-type-S">Nunchaku_core.TermInner.S</a></code></li><li><code><a href="argument-2-Arg/index.html">Arg</a> : <a href="../index.html#module-type-ARG">ARG</a></code></li><li><code><a href="argument-3-State/index.html">State</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></li></ul><h3 class="heading">Signature</h3><dl><dt class="spec type" id="type-term"><a href="#type-term" class="anchor"></a><code><span class="keyword">type</span> term</code><code> = <a href="argument-1-T/index.html#type-t">T.t</a></code></dt><dt class="spec type" id="type-ty"><a href="#type-ty" class="anchor"></a><code><span class="keyword">type</span> ty</code><code> = <a href="argument-1-T/index.html#type-t">T.t</a></code></dt><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>A stateful object used for traversing a problem, eventually building a new list of statements</p></dd></dl><dl><dt class="spec type" id="type-dispatch"><a href="#type-dispatch" class="anchor"></a><code><span class="keyword">type</span> dispatch</code><code> = </code><code>{</code><table class="record"><tr id="type-dispatch.do_term" class="anchored"><td class="def field"><a href="#type-dispatch.do_term" class="anchor"></a><code>do_term : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> <a href="index.html#type-term">term</a> <span>&#45;&gt;</span> <a href="index.html#type-term">term</a>;</code></td></tr><tr id="type-dispatch.do_goal_or_axiom" class="anchored"><td class="def field"><a href="#type-dispatch.do_goal_or_axiom" class="anchor"></a><code>do_goal_or_axiom : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> [ `Goal | `Axiom ] <span>&#45;&gt;</span> <a href="index.html#type-term">term</a> <span>&#45;&gt;</span> <a href="index.html#type-term">term</a>) option;</code></td></tr><tr id="type-dispatch.do_def" class="anchored"><td class="def field"><a href="#type-dispatch.do_def" class="anchor"></a><code>do_def : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-rec_def">Nunchaku_core.Statement.rec_def</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-rec_def">Nunchaku_core.Statement.rec_def</a>;</code></td></tr><tr id="type-dispatch.do_pred" class="anchored"><td class="def field"><a href="#type-dispatch.do_pred" class="anchor"></a><code>do_pred : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> [ `Wf | `Not_wf ] <span>&#45;&gt;</span> [ `Pred | `Copred ] <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-pred_def">Nunchaku_core.Statement.pred_def</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-pred_def">Nunchaku_core.Statement.pred_def</a>;</code></td></tr><tr id="type-dispatch.do_copy" class="anchored"><td class="def field"><a href="#type-dispatch.do_copy" class="anchor"></a><code>do_copy : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> loc:<a href="../../Nunchaku_core/Location/index.html#type-t">Nunchaku_core.Location.t</a> option <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-copy">Nunchaku_core.Statement.copy</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-copy">Nunchaku_core.Statement.copy</a>) option;</code></td></tr><tr id="type-dispatch.do_spec" class="anchored"><td class="def field"><a href="#type-dispatch.do_spec" class="anchor"></a><code>do_spec : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> loc:<a href="../../Nunchaku_core/Location/index.html#type-t">Nunchaku_core.Location.t</a> option <span>&#45;&gt;</span> <a href="../../Nunchaku_core/ID/index.html#type-t">Nunchaku_core.ID.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-spec_defs">Nunchaku_core.Statement.spec_defs</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-spec_defs">Nunchaku_core.Statement.spec_defs</a>) option;</code></td></tr><tr id="type-dispatch.do_data" class="anchored"><td class="def field"><a href="#type-dispatch.do_data" class="anchor"></a><code>do_data : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> [ `Data | `Codata ] <span>&#45;&gt;</span> <a href="index.html#type-term">term</a> <a href="../../Nunchaku_core/Statement/index.html#type-data_type">Nunchaku_core.Statement.data_type</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> <a href="index.html#type-term">term</a> <a href="../../Nunchaku_core/Statement/index.html#type-data_type">Nunchaku_core.Statement.data_type</a>) option;</code></td></tr><tr id="type-dispatch.do_ty_def" class="anchored"><td class="def field"><a href="#type-dispatch.do_ty_def" class="anchor"></a><code>do_ty_def : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> ?&#8288;loc:<a href="../../Nunchaku_core/Location/index.html#type-t">Nunchaku_core.Location.t</a> <span>&#45;&gt;</span> <a href="index.html#type-ty">ty</a> <a href="../../Nunchaku_core/Statement/index.html#type-defined">Nunchaku_core.Statement.defined</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> <a href="index.html#type-ty">ty</a> <a href="../../Nunchaku_core/Statement/index.html#type-defined">Nunchaku_core.Statement.defined</a>) option;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : ?&#8288;size:int <span>&#45;&gt;</span> ?&#8288;max_depth:int <span>&#45;&gt;</span> env:(<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Env/index.html#type-t">Nunchaku_core.Env.t</a> <span>&#45;&gt;</span> state:<a href="argument-3-State/index.html#type-t">State.t</a> <span>&#45;&gt;</span> dispatch:<a href="index.html#type-dispatch">dispatch</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>create a new traversal object.</p><dl><dt>parameter env</dt><dd><p>the environment in which symbols are defined</p></dd></dl><dl><dt>parameter dispatch</dt><dd><p>how to deal with definitions of symbols. Fields that are not specified are dealt with generically</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-env"><a href="#val-env" class="anchor"></a><code><span class="keyword">val</span> env : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Env/index.html#type-t">Nunchaku_core.Env.t</a></code></dt><dt class="spec value" id="val-state"><a href="#val-state" class="anchor"></a><code><span class="keyword">val</span> state : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="argument-3-State/index.html#type-t">State.t</a></code></dt><dt class="spec value" id="val-has_processed"><a href="#val-has_processed" class="anchor"></a><code><span class="keyword">val</span> has_processed : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Nunchaku_core/ID/index.html#type-t">Nunchaku_core.ID.t</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Has <a href="index.html#val-mark_processed"><code>mark_processed</code></a> already been called with those arguments?</p></dd></dl><dl><dt class="spec value" id="val-mark_processed"><a href="#val-mark_processed" class="anchor"></a><code><span class="keyword">val</span> mark_processed : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Nunchaku_core/ID/index.html#type-t">Nunchaku_core.ID.t</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>To be used by callbacks in <a href="index.html#type-dispatch"><code>dispatch</code></a> to indicate that some additional IDs have been processed (e.g. the conversion functions of copy types)</p></dd></dl><dl><dt class="spec value" id="val-processed"><a href="#val-processed" class="anchor"></a><code><span class="keyword">val</span> processed : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="../../Nunchaku_core/ID/index.html#type-t">Nunchaku_core.ID.t</a> * <a href="argument-2-Arg/index.html#type-t">Arg.t</a>) <a href="../../../sequence/Sequence/index.html#type-t">Sequence.t</a></code></dt><dd><p>All processed pairs</p></dd></dl><dl><dt class="spec value" id="val-call_dep"><a href="#val-call_dep" class="anchor"></a><code><span class="keyword">val</span> call_dep : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> depth:int <span>&#45;&gt;</span> <a href="../../Nunchaku_core/ID/index.html#type-t">Nunchaku_core.ID.t</a> <span>&#45;&gt;</span> <a href="argument-2-Arg/index.html#type-t">Arg.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>call_dep t id arg</code> is to be called during term traversal (typically, in <a href="index.html#type-dispatch.do_term"><code>dispatch.do_term</code></a>) to indicate the will of traversing the pair <code>(id,arg)</code></p></dd></dl><dl><dt class="spec exception" id="exception-CannotTraverse"><a href="#exception-CannotTraverse" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">CannotTraverse</span></code></dt></dl><dl><dt class="spec value" id="val-traverse_stmt"><a href="#val-traverse_stmt" class="anchor"></a><code><span class="keyword">val</span> traverse_stmt : ?&#8288;after_env:((<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Env/index.html#type-t">Nunchaku_core.Env.t</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-t">Nunchaku_core.Statement.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Traverse the given statement, adding its translation to the result, updating the environment, etc.</p><dl><dt>raises CannotTraverse</dt><dd><p>if <a href="index.html#val-get_statements"><code>get_statements</code></a> was called already</p></dd></dl><dl><dt>parameter after_env</dt><dd><p>called once the environment is updated, but before the statment is actually traversed</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-get_statements"><a href="#val-get_statements" class="anchor"></a><code><span class="keyword">val</span> get_statements : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="index.html#type-term">term</a>, <a href="index.html#type-ty">ty</a>) <a href="../../Nunchaku_core/Statement/index.html#type-t">Nunchaku_core.Statement.t</a> <a href="../../../containers/CCVector/index.html#type-vector">CCVector.vector</a></code></dt><dd><p><code>get_statements t</code> sorts topologically and merges the pieces of statements previously added by <code>push_rec</code>, <code>push_pred</code>, etc. and returns a valid list of statements. Once <a href="index.html#val-get_statements"><code>get_statements</code></a> has been called, <a href="index.html#val-traverse_stmt"><code>traverse_stmt</code></a> will raise</p></dd></dl><dl><dt class="spec value" id="val-max_depth_reached"><a href="#val-max_depth_reached" class="anchor"></a><code><span class="keyword">val</span> max_depth_reached : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt></dl></div></body></html>