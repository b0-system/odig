<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Opt (batteries.BatOptParse.Opt)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">batteries</a> &#x00BB; <a href="../index.html">BatOptParse</a> &#x00BB; Opt</nav><header class="odoc-preamble"><h1>Module <code><span>BatOptParse.Opt</span></code></h1><p>This module contains the basic functions and types for defining new option types and accessing the values of options.</p></header><nav class="odoc-toc"><ul><li><a href="#exceptions">Exceptions</a></li><li><a href="#types">Types</a></li><li><a href="#option-value-retrieval">Option value retrieval</a></li><li><a href="#option-creation">Option creation</a></li></ul></nav><div class="odoc-content"><h6 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h6><div class="odoc-spec"><div class="spec exception" id="exception-No_value" class="anchored"><a href="#exception-No_value" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">No_value</span></span></code></div><div class="spec-doc"><p><code>No_value</code> gets raised by <code>OptParse</code>.Opt.get when an option value is not available.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Option_error" class="anchored"><a href="#exception-Option_error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Option_error</span> <span class="keyword">of</span> string * string</span></code></div><div class="spec-doc"><p>This exception signals that an option value is invalid. The first string contains the option string ('-x' or '--long-name') and the second string contains an error message.</p><p>This exception is only used when implementing custom option types and can never &quot;escape&quot; the scope of a <code>OptParse</code>.OptParser.parse. The user should therefore not attempt to catch it.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Option_help" class="anchored"><a href="#exception-Option_help" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Option_help</span></span></code></div><div class="spec-doc"><p>When an option wants to display a usage message, this exception may be raised. It can never &quot;escape&quot; the scope of a <code>OptParse</code>.OptParser.parse call and the user should therefore not attempt to catch it.</p></div></div><h6 id="types"><a href="#types" class="anchor"></a>Types</h6><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span><span> = </span><span>{</span></code><table><tr id="type-t.option_set" class="anchored"><td class="def record field"><a href="#type-t.option_set" class="anchor"></a><code><span>option_set : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr><tr id="type-t.option_set_value" class="anchored"><td class="def record field"><a href="#type-t.option_set_value" class="anchor"></a><code><span>option_set_value : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr><tr id="type-t.option_get" class="anchored"><td class="def record field"><a href="#type-t.option_get" class="anchor"></a><code><span>option_get : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span>;</span></code></td></tr><tr id="type-t.option_metavars" class="anchored"><td class="def record field"><a href="#type-t.option_metavars" class="anchor"></a><code><span>option_metavars : <span>string list</span>;</span></code></td></tr><tr id="type-t.option_defhelp" class="anchored"><td class="def record field"><a href="#type-t.option_defhelp" class="anchor"></a><code><span>option_defhelp : <span>string option</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Option type.</p><p><code>option_set</code> is a closure which converts and records the value of an option so that it can be retrieved with a later call to the <code>option_get</code> closure. It is called with the option name which was given on the command line and a list of strings, each representing one of the argument values given on the command line. It may raise <code>Option_error</code> if the value is invalid (for whatever reason).</p><p><code>option_set_value</code> is a closure which sets the value of an option to a particular value.</p><p><code>option_get</code> is a closure which retrieves the recorded value of the option. If the option value has not been set from the command line, the default value is used. If there is no default value, then <code>None</code> should be returned.</p><p><code>option_metavars</code> is a list of &quot;meta-variables&quot; (arguments) which this option accepts. This is mainly for display purposes, but the length of this list determines how many arguments the option parser accepts for this option (currently only lists of length 0 or 1 are supported).</p><p><code>option_defhelp</code> is the default help string (if any). It is used for displaying help messages whenever the user does <b>not</b> specify a help string manually when adding this option. Using a non-None value here only makes sense for completely generic options like <code>OptParse</code>.StdOpt.help_option.</p></div></div><h6 id="option-value-retrieval"><a href="#option-value-retrieval" class="anchor"></a>Option value retrieval</h6><div class="odoc-spec"><div class="spec value" id="val-get" class="anchored"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Get the value of an option.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>the value of the option. If the option has not been encountered while parsing the command line, the default value is returned.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">No_value</span> <p>if no default values has been given and the option value has not been set from the command line.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-set" class="anchored"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Set the value of an option.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-opt" class="anchored"><a href="#val-opt" class="anchor"></a><code><span><span class="keyword">val</span> opt : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p>Get the value of an option as an optional value.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>Some x</code> if the option has value <code>x</code> (either by default or from the command line). If the option doesn't have a value <code>None</code> is returned.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-is_set" class="anchored"><a href="#val-is_set" class="anchor"></a><code><span><span class="keyword">val</span> is_set : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Find out if the option has a value (either by default or from the command line).</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p><code>True</code> iff the option has a value.</p></li></ul></div></div><h6 id="option-creation"><a href="#option-creation" class="anchor"></a>Option creation</h6><div class="odoc-spec"><div class="spec value" id="val-value_option" class="anchored"><a href="#val-value_option" class="anchor"></a><code><span><span class="keyword">val</span> value_option : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> option</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>exn <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Make an option which takes a single argument.</p><p><code>value_option metavar default coerce errfmt</code> returns an option which takes a single argument from the command line and calls <code>coerce</code> to coerce it to the proper type. If <code>coerce</code> raises an exception, <code>exn</code>, then <code>errfmt exn argval</code> is called to generate an error message for display. <code>metavar</code> is the name of the metavariable of the option.</p><p><code>default</code> is the default value of the option. If <code>None</code>, the option has no default value.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>the newly created option.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-callback_option" class="anchored"><a href="#val-callback_option" class="anchor"></a><code><span><span class="keyword">val</span> callback_option : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>exn <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p>Make a callback option which takes a single argument.</p><p><code>callback_option metavar coerce errfmt f</code> returns an option which takes a single argument from the command line and calls <code>coerce</code> to coerce it to the proper type. If <code>coerce</code> raises an exception <code>errfmt exn argval</code> is called to format an error message for display. If <code>coerce</code> succeeds, the callback function <code>f</code> is called with the coerced value. Finally, <code>metavar</code> is the name of the metavariable of the option.</p><ul class="at-tags"><li class="returns"><span class="at-tag">returns</span> <p>the newly created option.</p></li></ul></div></div></div></body></html>