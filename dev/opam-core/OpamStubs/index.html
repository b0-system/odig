<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamStubs (opam-core.OpamStubs)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">opam-core</a> &#x00BB; OpamStubs</nav><h1>Module <code>OpamStubs</code></h1><p>OS-specific functions requiring C code on at least one platform.</p><p>Most functions are Windows-specific and raise an exception on other platforms.</p></header><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec type" id="type-console_screen_buffer_info"><a href="#type-console_screen_buffer_info" class="anchor"></a><code><span class="keyword">type</span> console_screen_buffer_info</code><code> = <a href="../OpamStubsTypes/index.html#type-console_screen_buffer_info">OpamStubsTypes.console_screen_buffer_info</a></code><code> = </code><code>{</code><table class="record"><tr id="type-console_screen_buffer_info.size" class="anchored"><td class="def field"><a href="#type-console_screen_buffer_info.size" class="anchor"></a><code>size : int * int;</code></td></tr><tr id="type-console_screen_buffer_info.cursorPosition" class="anchored"><td class="def field"><a href="#type-console_screen_buffer_info.cursorPosition" class="anchor"></a><code>cursorPosition : int * int;</code></td></tr><tr id="type-console_screen_buffer_info.attributes" class="anchored"><td class="def field"><a href="#type-console_screen_buffer_info.attributes" class="anchor"></a><code>attributes : int;</code></td></tr><tr id="type-console_screen_buffer_info.window" class="anchored"><td class="def field"><a href="#type-console_screen_buffer_info.window" class="anchor"></a><code>window : int * int * int * int;</code></td></tr><tr id="type-console_screen_buffer_info.maximumWindowSize" class="anchored"><td class="def field"><a href="#type-console_screen_buffer_info.maximumWindowSize" class="anchor"></a><code>maximumWindowSize : int * int;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-console_font_infoex"><a href="#type-console_font_infoex" class="anchor"></a><code><span class="keyword">type</span> console_font_infoex</code><code> = <a href="../OpamStubsTypes/index.html#type-console_font_infoex">OpamStubsTypes.console_font_infoex</a></code><code> = </code><code>{</code><table class="record"><tr id="type-console_font_infoex.font" class="anchored"><td class="def field"><a href="#type-console_font_infoex.font" class="anchor"></a><code>font : int;</code></td></tr><tr id="type-console_font_infoex.fontSize" class="anchored"><td class="def field"><a href="#type-console_font_infoex.fontSize" class="anchor"></a><code>fontSize : int * int;</code></td></tr><tr id="type-console_font_infoex.fontFamily" class="anchored"><td class="def field"><a href="#type-console_font_infoex.fontFamily" class="anchor"></a><code>fontFamily : int;</code></td></tr><tr id="type-console_font_infoex.fontWeight" class="anchored"><td class="def field"><a href="#type-console_font_infoex.fontWeight" class="anchor"></a><code>fontWeight : int;</code></td></tr><tr id="type-console_font_infoex.faceName" class="anchored"><td class="def field"><a href="#type-console_font_infoex.faceName" class="anchor"></a><code>faceName : string;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-handle"><a href="#type-handle" class="anchor"></a><code><span class="keyword">type</span> handle</code><code> = <a href="../OpamStubsTypes/index.html#type-handle">OpamStubsTypes.handle</a></code></dt><dt class="spec type" id="type-stdhandle"><a href="#type-stdhandle" class="anchor"></a><code><span class="keyword">type</span> stdhandle</code><code> = <a href="../OpamStubsTypes/index.html#type-stdhandle">OpamStubsTypes.stdhandle</a></code><code> = </code><table class="variant"><tr id="type-stdhandle.STD_INPUT_HANDLE" class="anchored"><td class="def constructor"><a href="#type-stdhandle.STD_INPUT_HANDLE" class="anchor"></a><code>| </code><code><span class="constructor">STD_INPUT_HANDLE</span></code></td></tr><tr id="type-stdhandle.STD_OUTPUT_HANDLE" class="anchored"><td class="def constructor"><a href="#type-stdhandle.STD_OUTPUT_HANDLE" class="anchor"></a><code>| </code><code><span class="constructor">STD_OUTPUT_HANDLE</span></code></td></tr><tr id="type-stdhandle.STD_ERROR_HANDLE" class="anchored"><td class="def constructor"><a href="#type-stdhandle.STD_ERROR_HANDLE" class="anchor"></a><code>| </code><code><span class="constructor">STD_ERROR_HANDLE</span></code></td></tr></table></dt><dt class="spec type" id="type-registry_root"><a href="#type-registry_root" class="anchor"></a><code><span class="keyword">type</span> registry_root</code><code> = <a href="../OpamStubsTypes/index.html#type-registry_root">OpamStubsTypes.registry_root</a></code><code> = </code><table class="variant"><tr id="type-registry_root.HKEY_CLASSES_ROOT" class="anchored"><td class="def constructor"><a href="#type-registry_root.HKEY_CLASSES_ROOT" class="anchor"></a><code>| </code><code><span class="constructor">HKEY_CLASSES_ROOT</span></code></td></tr><tr id="type-registry_root.HKEY_CURRENT_CONFIG" class="anchored"><td class="def constructor"><a href="#type-registry_root.HKEY_CURRENT_CONFIG" class="anchor"></a><code>| </code><code><span class="constructor">HKEY_CURRENT_CONFIG</span></code></td></tr><tr id="type-registry_root.HKEY_CURRENT_USER" class="anchored"><td class="def constructor"><a href="#type-registry_root.HKEY_CURRENT_USER" class="anchor"></a><code>| </code><code><span class="constructor">HKEY_CURRENT_USER</span></code></td></tr><tr id="type-registry_root.HKEY_LOCAL_MACHINE" class="anchored"><td class="def constructor"><a href="#type-registry_root.HKEY_LOCAL_MACHINE" class="anchor"></a><code>| </code><code><span class="constructor">HKEY_LOCAL_MACHINE</span></code></td></tr><tr id="type-registry_root.HKEY_USERS" class="anchored"><td class="def constructor"><a href="#type-registry_root.HKEY_USERS" class="anchor"></a><code>| </code><code><span class="constructor">HKEY_USERS</span></code></td></tr></table></dt><dt class="spec type" id="type-registry_value"><a href="#type-registry_value" class="anchor"></a><code><span class="keyword">type</span> 'a registry_value</code><code> = <span class="type-var">'a</span> <a href="../OpamStubsTypes/index.html#type-registry_value">OpamStubsTypes.registry_value</a></code><code> = </code><table class="variant"><tr id="type-registry_value.REG_SZ" class="anchored"><td class="def constructor"><a href="#type-registry_value.REG_SZ" class="anchor"></a><code>| </code><code><span class="constructor">REG_SZ</span> : string <a href="index.html#type-registry_value">registry_value</a></code></td></tr></table></dt><dt class="spec type" id="type-shGFP_type"><a href="#type-shGFP_type" class="anchor"></a><code><span class="keyword">type</span> shGFP_type</code><code> = <a href="../OpamStubsTypes/index.html#type-shGFP_type">OpamStubsTypes.shGFP_type</a></code><code> = </code><table class="variant"><tr id="type-shGFP_type.SHGFP_TYPE_CURRENT" class="anchored"><td class="def constructor"><a href="#type-shGFP_type.SHGFP_TYPE_CURRENT" class="anchor"></a><code>| </code><code><span class="constructor">SHGFP_TYPE_CURRENT</span></code></td></tr><tr id="type-shGFP_type.SHGFP_TYPE_DEFAULT" class="anchored"><td class="def constructor"><a href="#type-shGFP_type.SHGFP_TYPE_DEFAULT" class="anchor"></a><code>| </code><code><span class="constructor">SHGFP_TYPE_DEFAULT</span></code></td></tr></table></dt><dt class="spec type" id="type-winmessage"><a href="#type-winmessage" class="anchor"></a><code><span class="keyword">type</span> ('a, 'b, 'c) winmessage</code><code> = (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="../OpamStubsTypes/index.html#type-winmessage">OpamStubsTypes.winmessage</a></code><code> = </code><table class="variant"><tr id="type-winmessage.WM_SETTINGCHANGE" class="anchored"><td class="def constructor"><a href="#type-winmessage.WM_SETTINGCHANGE" class="anchor"></a><code>| </code><code><span class="constructor">WM_SETTINGCHANGE</span> : (int, string, int) <a href="index.html#type-winmessage">winmessage</a></code></td></tr></table></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-getpid"><a href="#val-getpid" class="anchor"></a><code><span class="keyword">val</span> getpid : unit <span>&#45;&gt;</span> int</code></dt><dd><p>On Windows, this returns the actual process ID, rather than the non-unique faked process ID returned by the Microsoft C Runtime (see https://caml.inria.fr/mantis/view.php?id=4034).</p><p>On all other platforms, this is just an alias for <code>Unix.getpid</code>.</p></dd></dl><dl><dt class="spec value" id="val-getCurrentProcessID"><a href="#val-getCurrentProcessID" class="anchor"></a><code><span class="keyword">val</span> getCurrentProcessID : unit <span>&#45;&gt;</span> int32</code></dt><dd><p>Windows only. As <a href="index.html#val-getpid"><code>getpid</code></a>, but without the possibility of truncating the ID on 32-bit platforms.</p></dd></dl><dl><dt class="spec value" id="val-getStdHandle"><a href="#val-getStdHandle" class="anchor"></a><code><span class="keyword">val</span> getStdHandle : <a href="index.html#type-stdhandle">stdhandle</a> <span>&#45;&gt;</span> <a href="index.html#type-handle">handle</a></code></dt><dd><p>Windows only. Return a standard handle.</p></dd></dl><dl><dt class="spec value" id="val-getConsoleScreenBufferInfo"><a href="#val-getConsoleScreenBufferInfo" class="anchor"></a><code><span class="keyword">val</span> getConsoleScreenBufferInfo : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> <a href="index.html#type-console_screen_buffer_info">console_screen_buffer_info</a></code></dt><dd><p>Windows only. Return current Console screen buffer information.</p></dd></dl><dl><dt class="spec value" id="val-setConsoleTextAttribute"><a href="#val-setConsoleTextAttribute" class="anchor"></a><code><span class="keyword">val</span> setConsoleTextAttribute : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p>Windows only. Set the console's text attribute setting.</p></dd></dl><dl><dt class="spec value" id="val-fillConsoleOutputCharacter"><a href="#val-fillConsoleOutputCharacter" class="anchor"></a><code><span class="keyword">val</span> fillConsoleOutputCharacter : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> int <span>&#45;&gt;</span> (int * int) <span>&#45;&gt;</span> bool</code></dt><dd><p>Windows only. <code>fillConsoleOutputCharacter buffer c n (x, y)</code> writes <code>c</code> <code>n</code> times starting at the given coordinate (and wrapping if required).</p></dd></dl><dl><dt class="spec value" id="val-getConsoleMode"><a href="#val-getConsoleMode" class="anchor"></a><code><span class="keyword">val</span> getConsoleMode : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Windows only. Returns the input/output mode of the console screen buffer referred to by the handle.</p><dl><dt>raises Not_found</dt><dd><p>If the handle does not refer to a console.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-setConsoleMode"><a href="#val-setConsoleMode" class="anchor"></a><code><span class="keyword">val</span> setConsoleMode : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dd><p>Windows only. Sets the input/output mode of the console screen buffer referred to by the handle, returning <code>true</code> if the operation isr successful.</p></dd></dl><dl><dt class="spec value" id="val-getWindowsVersion"><a href="#val-getWindowsVersion" class="anchor"></a><code><span class="keyword">val</span> getWindowsVersion : unit <span>&#45;&gt;</span> int * int * int * int</code></dt><dd><p>Windows only. Returns the Windows version as <code>(major, minor, build, revision)</code>. This function only works if opam is compiled OCaml 4.06.0 or later, it returns <code>(0, 0, 0, 0)</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-isWoW64"><a href="#val-isWoW64" class="anchor"></a><code><span class="keyword">val</span> isWoW64 : unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Returns <code>false</code> unless this process is a 32-bit Windows process running in the WoW64 sub-system (i.e. is being run on 64-bit Windows).</p></dd></dl><dl><dt class="spec value" id="val-waitpids"><a href="#val-waitpids" class="anchor"></a><code><span class="keyword">val</span> waitpids : int list <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int * <a href="../../ocaml/Unix/index.html#type-process_status">Unix.process_status</a></code></dt><dd><p>Windows only. Given a list <code>pids</code> with <code>length</code> elements, <code>waitpids pids length</code> behaves like <code>Unix.wait</code>, returning the pid and exit status of the first process to terminate.</p></dd></dl><dl><dt class="spec value" id="val-writeRegistry"><a href="#val-writeRegistry" class="anchor"></a><code><span class="keyword">val</span> writeRegistry : <a href="index.html#type-registry_root">registry_root</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-registry_value">registry_value</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Windows only. <code>writeRegistry root key name value_type value</code> sets the value <code>name</code> of type <code>value_type</code> in registry key <code>key</code> of <code>root</code> to <code>value</code>.</p><dl><dt>raises Failure</dt><dd><p>If the value could not be set.</p></dd></dl><dl><dt>raises Not_found</dt><dd><p>If <code>key</code> does not exist.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-getConsoleOutputCP"><a href="#val-getConsoleOutputCP" class="anchor"></a><code><span class="keyword">val</span> getConsoleOutputCP : unit <span>&#45;&gt;</span> int</code></dt><dd><p>Windows only. Retrieves the current Console Output Code Page.</p></dd></dl><dl><dt class="spec value" id="val-getCurrentConsoleFontEx"><a href="#val-getCurrentConsoleFontEx" class="anchor"></a><code><span class="keyword">val</span> getCurrentConsoleFontEx : <a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> <a href="index.html#type-console_font_infoex">console_font_infoex</a></code></dt><dd><p>Windows only. Gets information on the current console output font.</p></dd></dl><dl><dt class="spec value" id="val-create_glyph_checker"><a href="#val-create_glyph_checker" class="anchor"></a><code><span class="keyword">val</span> create_glyph_checker : string <span>&#45;&gt;</span> <a href="index.html#type-handle">handle</a> * <a href="index.html#type-handle">handle</a></code></dt><dd><p>Windows only. Given a font name, returns a pair consisting of a screen DC and a font object, which will have been selected into the DC.</p><dl><dt>raises Failure</dt><dd><p>If anything goes wrong with the GDI calls.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-delete_glyph_checker"><a href="#val-delete_glyph_checker" class="anchor"></a><code><span class="keyword">val</span> delete_glyph_checker : (<a href="index.html#type-handle">handle</a> * <a href="index.html#type-handle">handle</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p>Windows only. Given <code>(dc, font)</code>, deletes the font object and releases the DC.</p></dd></dl><dl><dt class="spec value" id="val-has_glyph"><a href="#val-has_glyph" class="anchor"></a><code><span class="keyword">val</span> has_glyph : (<a href="index.html#type-handle">handle</a> * <a href="index.html#type-handle">handle</a>) <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Uchar/index.html#type-t">OpamCompat.Uchar.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Windows only. <code>has_glyph (dc, font) scalar</code> returns <code>true</code> if <code>font</code> contains a glyph for <code>scalar</code>.</p><dl><dt>raises Failure</dt><dd><p>If the call to <code>GetGlyphIndicesW</code> fails.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-isWoW64Process"><a href="#val-isWoW64Process" class="anchor"></a><code><span class="keyword">val</span> isWoW64Process : int32 <span>&#45;&gt;</span> bool</code></dt><dd><p>Windows only. General version of <a href="index.html#val-isWoW64"><code>isWoW64</code></a> for any given process ID. See https://msdn.microsoft.com/en-us/library/windows/desktop/ms684139.aspx</p></dd></dl><dl><dt class="spec value" id="val-process_putenv"><a href="#val-process_putenv" class="anchor"></a><code><span class="keyword">val</span> process_putenv : int32 <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> bool</code></dt><dd><p>Windows only. <code>process_putenv pid name value</code> sets the environment variable <code>name</code> to <code>value</code> in given process ID (<code>Unix.putenv</code> must also be called to update the value in the current process). This function must not be called if the target process is 32-bit and the current process is 64-bit or vice versa (outcomes vary from a no-op to a segfault).</p></dd></dl><dl><dt class="spec value" id="val-shGetFolderPath"><a href="#val-shGetFolderPath" class="anchor"></a><code><span class="keyword">val</span> shGetFolderPath : int <span>&#45;&gt;</span> <a href="index.html#type-shGFP_type">shGFP_type</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Windows only. <code>shGetFolderPath nFolder dwFlags</code> retrieves the location of a special folder by CSIDL value. See https://msdn.microsoft.com/en-us/library/windows/desktop/bb762181.aspx</p></dd></dl><dl><dt class="spec value" id="val-sendMessageTimeout"><a href="#val-sendMessageTimeout" class="anchor"></a><code><span class="keyword">val</span> sendMessageTimeout : nativeint <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="index.html#type-winmessage">winmessage</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> int * <span class="type-var">'c</span></code></dt><dd><p>Windows only. <code>sendMessageTimeout hwnd timeout flags message wParam lParam</code> sends a message to the given handle, but is guaranteed to return within <code>timeout</code> milliseconds. The result consists of two parts, <code>fst</code> is the return value from SendMessageTimeout, <code>snd</code> depends on both the message and <code>fst</code>. See https://msdn.microsoft.com/en-us/library/windows/desktop/ms644952.aspx</p></dd></dl><dl><dt class="spec value" id="val-getParentProcessID"><a href="#val-getParentProcessID" class="anchor"></a><code><span class="keyword">val</span> getParentProcessID : int32 <span>&#45;&gt;</span> int32</code></dt><dd><p>Windows only. <code>getParentProcessID pid</code> returns the process ID of the parent of <code>pid</code>.</p><dl><dt>raises Failure</dt><dd><p>If walking the process tree fails to find the process.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-getConsoleAlias"><a href="#val-getConsoleAlias" class="anchor"></a><code><span class="keyword">val</span> getConsoleAlias : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p>Windows only. <code>getConsoleAlias alias exeName</code> retrieves the value for a given executable or <code>&quot;&quot;</code> if the alias is not defined. See https://docs.microsoft.com/en-us/windows/console/getconsolealias</p></dd></dl></div></body></html>