<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Path (bos.Bos.OS.Path)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">bos</a> &#x00BB; <a href="../../index.html">Bos</a> &#x00BB; <a href="../index.html">OS</a> &#x00BB; Path</nav><header class="odoc-preamble"><h1>Module <code><span>OS.Path</span></code></h1><p>Path operations.</p><p>These functions operate on files and directories equally. Similar and specific functions operating only on one kind of path can be found in the <a href="../File/index.html"><code>File</code></a> and <a href="../Dir/index.html"><code>Dir</code></a> modules.</p></header><nav class="odoc-toc"><ul><li><a href="#ops">Existence, move, deletion, information and mode</a></li><li><a href="#link">Path links</a></li><li><a href="#pathmatch">Matching path patterns against the file system</a></li><li><a href="#fold">Folding over file system hierarchies</a></li></ul></nav><div class="odoc-content"><h2 id="ops"><a href="#ops" class="anchor"></a>Existence, move, deletion, information and mode</h2><div class="odoc-spec"><div class="spec value" id="val-exists" class="anchored"><a href="#val-exists" class="anchor"></a><code><span><span class="keyword">val</span> exists : <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(bool, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>exists p</code> is <code>true</code> if <code>p</code> exists for the file system and <code>false</code> otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-must_exist" class="anchored"><a href="#val-must_exist" class="anchor"></a><code><span><span class="keyword">val</span> must_exist : <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>must_exist p</code> is <code>Ok p</code> if <code>p</code> exists for the file system and an error otherwise.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-move" class="anchored"><a href="#val-move" class="anchor"></a><code><span><span class="keyword">val</span> move : <span>?force:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>move ~force src dst</code> moves path <code>src</code> to <code>dst</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) the operation doesn't error if <code>dst</code> exists and can be replaced by <code>src</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-delete" class="anchored"><a href="#val-delete" class="anchor"></a><code><span><span class="keyword">val</span> delete : <span>?must_exist:bool <span class="arrow">&#45;&gt;</span></span> <span>?recurse:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>delete ~must_exist ~recurse p</code> deletes the path <code>p</code>. If <code>must_exist</code> is <code>true</code> (defaults to <code>false</code>) an error is returned if <code>p</code> doesn't exist. If <code>recurse</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> is a directory, no error occurs if the directory is non-empty: its contents is recursively deleted first.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-stat" class="anchored"><a href="#val-stat" class="anchor"></a><code><span><span class="keyword">val</span> stat : <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../../ocaml/Unix/index.html#type-stats">Unix.stats</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>stat p</code> is <code>p</code>'s file information.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Mode" class="anchored"><a href="#module-Mode" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Mode/index.html">Mode</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Path permission modes.</p></div></div><h2 id="link"><a href="#link" class="anchor"></a>Path links</h2><div class="odoc-spec"><div class="spec value" id="val-link" class="anchored"><a href="#val-link" class="anchor"></a><code><span><span class="keyword">val</span> link : <span>?force:bool <span class="arrow">&#45;&gt;</span></span> <span>target:<a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>link ~force target p</code> hard links <code>target</code> to <code>p</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> exists, it is is <code>rmdir</code>ed or <code>unlink</code>ed before making the link.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-symlink" class="anchored"><a href="#val-symlink" class="anchor"></a><code><span><span class="keyword">val</span> symlink : <span>?force:bool <span class="arrow">&#45;&gt;</span></span> <span>target:<a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>symlink ~force target p</code> symbolically links <code>target</code> to <code>p</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> exists, it is <code>rmdir</code>ed or <code>unlink</code>ed before making the link.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-symlink_target" class="anchored"><a href="#val-symlink_target" class="anchor"></a><code><span><span class="keyword">val</span> symlink_target : <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>slink_target p</code> is <code>p</code>'s target iff <code>p</code> is a symbolic link.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-symlink_stat" class="anchored"><a href="#val-symlink_stat" class="anchor"></a><code><span><span class="keyword">val</span> symlink_stat : <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../../../../ocaml/Unix/index.html#type-stats">Unix.stats</a>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>symlink_stat p</code> is the same as <a href="#val-stat"><code>stat</code></a> but if <code>p</code> is a link returns information about the link itself.</p></div></div><h2 id="pathmatch"><a href="#pathmatch" class="anchor"></a>Matching path patterns against the file system</h2><p>A path pattern <code>pat</code> is a path whose segments are made of <a href="../../Pat/index.html">named string patterns</a>. Each variable of the pattern greedily matches a segment or sub-segment. For example the path pattern:</p><pre><code>Fpath.(v &quot;data&quot; / &quot;$(dir)&quot; / &quot;$(file).txt&quot;)</code></pre><p>matches any existing path of the file system that matches the regexp <code>data/.*/.*\.txt</code>.</p><p><b>Warning.</b> When segments with pattern variables are matched against the file system they never match <code>&quot;.&quot;</code> and <code>&quot;..&quot;</code>. For example the pattern <code>&quot;$(file).$(ext)&quot;</code> does not match <code>&quot;.&quot;</code>.</p><div class="odoc-spec"><div class="spec value" id="val-matches" class="anchored"><a href="#val-matches" class="anchor"></a><code><span><span class="keyword">val</span> matches : <span>?dotfiles:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> list</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>matches ~dotfiles pat</code> is the list of paths in the file system that match the path pattern <code>pat</code>. If <code>dotfiles</code> is <code>false</code> (default) segments that start with a pattern variable do not match dotfiles.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-query" class="anchored"><a href="#val-query" class="anchor"></a><code><span><span class="keyword">val</span> query : <span>?dotfiles:bool <span class="arrow">&#45;&gt;</span></span> <span>?init:<a href="../../Pat/index.html#type-defs">Pat.defs</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span>(<a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> * <a href="../../Pat/index.html#type-defs">Pat.defs</a>)</span> list</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>query ~init pat</code> is like <a href="#val-matches"><code>matches</code></a> except each matching path is returned with an environment mapping pattern variables to their matched part in the path. For each path the mappings are added to <code>init</code> (defaults to <code>String</code>.Map.empty).</p></div></div><h2 id="fold"><a href="#fold" class="anchor"></a>Folding over file system hierarchies</h2><div class="odoc-spec"><div class="spec type" id="type-traverse" class="anchored"><a href="#type-traverse" class="anchor"></a><code><span><span class="keyword">type</span> traverse</span><span> = </span><span>[ </span></code><table><tr id="type-traverse.Any" class="anchored"><td class="def constructor"><a href="#type-traverse.Any" class="anchor"></a><code><span>| </span></code><code><span>`Any</span></code></td></tr><tr id="type-traverse.None" class="anchored"><td class="def constructor"><a href="#type-traverse.None" class="anchor"></a><code><span>| </span></code><code><span>`None</span></code></td></tr><tr id="type-traverse.Sat" class="anchored"><td class="def constructor"><a href="#type-traverse.Sat" class="anchor"></a><code><span>| </span></code><code><span>`Sat <span class="keyword">of</span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(bool, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../index.html#type-result">result</a></span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for controlling directory traversals. The predicate of <code>`Sat</code> should only be called with directory paths, however this may not be the case due to OS races.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-elements" class="anchored"><a href="#type-elements" class="anchor"></a><code><span><span class="keyword">type</span> elements</span><span> = </span><span>[ </span></code><table><tr id="type-elements.Any" class="anchored"><td class="def constructor"><a href="#type-elements.Any" class="anchor"></a><code><span>| </span></code><code><span>`Any</span></code></td></tr><tr id="type-elements.Files" class="anchored"><td class="def constructor"><a href="#type-elements.Files" class="anchor"></a><code><span>| </span></code><code><span>`Files</span></code></td></tr><tr id="type-elements.Dirs" class="anchored"><td class="def constructor"><a href="#type-elements.Dirs" class="anchor"></a><code><span>| </span></code><code><span>`Dirs</span></code></td></tr><tr id="type-elements.Sat" class="anchored"><td class="def constructor"><a href="#type-elements.Sat" class="anchor"></a><code><span>| </span></code><code><span>`Sat <span class="keyword">of</span> <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(bool, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../index.html#type-result">result</a></span></span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The type for specifying elements being folded over.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-fold_error" class="anchored"><a href="#type-fold_error" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a fold_error</span></span><span> = <span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../index.html#type-result">result</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="../../../../rresult/Rresult/R/index.html#type-msg">Rresult.R.msg</a>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p>The type for managing fold errors.</p><p>During the fold, errors may be generated at different points of the process. For example, determining traversal with <a href="#type-traverse"><code>traverse</code></a>, determining folded <a href="#type-elements"><code>elements</code></a> or trying to <code>readdir(3)</code> a directory without having permissions.</p><p>These errors are given to a function of this type. If the function returns <code>Error _</code> the fold stops and returns that error. If the function returns <code>`Ok ()</code> the path is ignored for the operation and the fold continues.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-log_fold_error" class="anchored"><a href="#val-log_fold_error" class="anchor"></a><code><span><span class="keyword">val</span> log_fold_error : <span>level:<a href="../../../../logs/Logs/index.html#type-level">Logs.level</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-fold_error">fold_error</a></span></span></code></div><div class="spec-doc"><p><code>log_fold_error level</code> is a <a href="#type-fold_error"><code>fold_error</code></a> function that logs error with level <code>level</code> and always returns <code>`Ok ()</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold" class="anchored"><a href="#val-fold" class="anchor"></a><code><span><span class="keyword">val</span> fold : <span>?err:<span><span class="type-var">'b</span> <a href="#type-fold_error">fold_error</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?dotfiles:bool <span class="arrow">&#45;&gt;</span></span> <span>?elements:<a href="#type-elements">elements</a> <span class="arrow">&#45;&gt;</span></span> <span>?traverse:<a href="#type-traverse">traverse</a> <span class="arrow">&#45;&gt;</span></span>
<span><span>(<span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../../../fpath/Fpath/index.html#type-t">Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'e</span>)</span> <a href="../index.html#type-result">result</a></span></span></code></div><div class="spec-doc"><p><code>fold err dotfiles elements traverse f acc paths</code> folds over the list of paths <code>paths</code> traversing directories according to <code>traverse</code> (defaults to <code>`Any</code>) and selecting elements to fold over according to <code>elements</code> (defaults to <code>`Any</code>).</p><p>If <code>dotfiles</code> if <code>false</code> (default) both elements and directories to traverse that start with a <code>.</code> except <code>.</code> and <code>..</code> are skipped without being considered by <code>elements</code> or <code>traverse</code>'s values.</p><p><code>err</code> manages fold errors (see <a href="#type-fold_error"><code>fold_error</code></a>), defaults to <a href="#val-log_fold_error"><code>log_fold_error</code></a><code> ~level:Log.Error</code>.</p></div></div></div></body></html>