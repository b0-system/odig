<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamFormula (opam-format.OpamFormula)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-format</a> &#x00BB; OpamFormula</nav><header class="odoc-preamble"><h1>Module <code><span>OpamFormula</span></code></h1><p>Formulas on packages, opt. with sub-formulas on versions, and conversion functions</p></header><nav class="odoc-toc"><ul><li><a href="#atoms">Atoms</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-relop" class="anchored"><a href="#type-relop" class="anchor"></a><code><span><span class="keyword">type</span> relop</span><span> = <a href="../../opam-file-format/OpamParserTypes/FullPos/index.html#type-relop_kind">OpamParserTypes.FullPos.relop_kind</a></span></code></div><div class="spec-doc"><p>binary operations (compatible with the Dose type for Cudf operators!)</p></div></div><div class="odoc-spec"><div class="spec type" id="type-version_constraint" class="anchored"><a href="#type-version_constraint" class="anchor"></a><code><span><span class="keyword">type</span> version_constraint</span><span> = <a href="#type-relop">relop</a> * <a href="../OpamPackage/Version/index.html#type-t">OpamPackage.Version.t</a></span></code></div><div class="spec-doc"><p>Version constraints for OPAM</p></div></div><div class="odoc-spec"><div class="spec type" id="type-atom" class="anchored"><a href="#type-atom" class="anchor"></a><code><span><span class="keyword">type</span> atom</span><span> = <a href="../OpamPackage/Name/index.html#type-t">OpamPackage.Name.t</a> * <span><a href="#type-version_constraint">version_constraint</a> option</span></span></code></div><div class="spec-doc"><p>Formula atoms for OPAM</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_atom" class="anchored"><a href="#val-string_of_atom" class="anchor"></a><code><span><span class="keyword">val</span> string_of_atom : <span><a href="#type-atom">atom</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty-printing of atoms</p></div></div><div class="odoc-spec"><div class="spec value" id="val-short_string_of_atom" class="anchored"><a href="#val-short_string_of_atom" class="anchor"></a><code><span><span class="keyword">val</span> short_string_of_atom : <span><a href="#type-atom">atom</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>The compact atom format used in requests, &quot;pkgOPvers&quot;, with '.' allowed instead of '='</p></div></div><div class="odoc-spec"><div class="spec value" id="val-atom_of_string" class="anchored"><a href="#val-atom_of_string" class="anchor"></a><code><span><span class="keyword">val</span> atom_of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-atom">atom</a></span></code></div><div class="spec-doc"><p>Parses a package or atom, in a format similar to <code>short_string_of_atom</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">[Failure]</span> <p>if the format is incorrect</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_atoms" class="anchored"><a href="#val-string_of_atoms" class="anchor"></a><code><span><span class="keyword">val</span> string_of_atoms : <span><span><a href="#type-atom">atom</a> list</span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Prints atoms as a conjunction (&quot;&amp;&quot;) using the short format</p></div></div><div class="odoc-spec"><div class="spec value" id="val-check" class="anchored"><a href="#val-check" class="anchor"></a><code><span><span class="keyword">val</span> check : <span><a href="#type-atom">atom</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/index.html#type-t">OpamPackage.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Checks if a package verifies an atom</p></div></div><div class="odoc-spec"><div class="spec value" id="val-packages_of_atoms" class="anchored"><a href="#val-packages_of_atoms" class="anchor"></a><code><span><span class="keyword">val</span> packages_of_atoms : <span>?disj:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-atom">atom</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a></span></code></div><div class="spec-doc"><p>Return all packages satisfying the given atoms from a set (i.e. name matching at least one of the atoms, version matching all atoms with the appropriate name). If <code>disj</code> is true, returns packages that satisfy at least one of the constraint of a given name, otherwise that satisfy all constraints.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-conjunction" class="anchored"><a href="#type-conjunction" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a conjunction</span></span><span> = <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p>AND formulas</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_conjunction" class="anchored"><a href="#val-string_of_conjunction" class="anchor"></a><code><span><span class="keyword">val</span> string_of_conjunction : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-conjunction">conjunction</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print AND formulas</p></div></div><div class="odoc-spec"><div class="spec type" id="type-disjunction" class="anchored"><a href="#type-disjunction" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a disjunction</span></span><span> = <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p>OR formulas</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_disjunction" class="anchored"><a href="#val-string_of_disjunction" class="anchor"></a><code><span><span class="keyword">val</span> string_of_disjunction : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-disjunction">disjunction</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print OR formulas</p></div></div><div class="odoc-spec"><div class="spec type" id="type-cnf" class="anchored"><a href="#type-cnf" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a cnf</span></span><span> = <span><span><span class="type-var">'a</span> <a href="#type-disjunction">disjunction</a></span> <a href="#type-conjunction">conjunction</a></span></span></code></div><div class="spec-doc"><p>CNF formulas (Conjunctive Normal Form)</p></div></div><div class="odoc-spec"><div class="spec type" id="type-dnf" class="anchored"><a href="#type-dnf" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a dnf</span></span><span> = <span><span><span class="type-var">'a</span> <a href="#type-conjunction">conjunction</a></span> <a href="#type-disjunction">disjunction</a></span></span></code></div><div class="spec-doc"><p>DNF formulas (Disjunctive Normal Form)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_cnf" class="anchored"><a href="#val-string_of_cnf" class="anchor"></a><code><span><span class="keyword">val</span> string_of_cnf : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-cnf">cnf</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print CNF formulas</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_dnf" class="anchored"><a href="#val-string_of_dnf" class="anchor"></a><code><span><span class="keyword">val</span> string_of_dnf : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-dnf">dnf</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print DNF formulas</p></div></div><div class="odoc-spec"><div class="spec type" id="type-formula" class="anchored"><a href="#type-formula" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a formula</span></span><span> = </span></code><table><tr id="type-formula.Empty" class="anchored"><td class="def variant constructor"><a href="#type-formula.Empty" class="anchor"></a><code><span>| </span><span><span class="constructor">Empty</span></span></code></td></tr><tr id="type-formula.Atom" class="anchored"><td class="def variant constructor"><a href="#type-formula.Atom" class="anchor"></a><code><span>| </span><span><span class="constructor">Atom</span> <span class="keyword">of</span> <span class="type-var">'a</span></span></code></td></tr><tr id="type-formula.Block" class="anchored"><td class="def variant constructor"><a href="#type-formula.Block" class="anchor"></a><code><span>| </span><span><span class="constructor">Block</span> <span class="keyword">of</span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></td></tr><tr id="type-formula.And" class="anchored"><td class="def variant constructor"><a href="#type-formula.And" class="anchor"></a><code><span>| </span><span><span class="constructor">And</span> <span class="keyword">of</span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> * <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></td></tr><tr id="type-formula.Or" class="anchored"><td class="def variant constructor"><a href="#type-formula.Or" class="anchor"></a><code><span>| </span><span><span class="constructor">Or</span> <span class="keyword">of</span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> * <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></td></tr></table></div><div class="spec-doc"><p>General formulas</p></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_formula" class="anchored"><a href="#val-compare_formula" class="anchor"></a><code><span><span class="keyword">val</span> compare_formula : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-eval" class="anchored"><a href="#val-eval" class="anchor"></a><code><span><span class="keyword">val</span> eval : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Eval a formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-partial_eval" class="anchored"><a href="#val-partial_eval" class="anchor"></a><code><span><span class="keyword">val</span> partial_eval : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>[ <span>`Formula of <span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span></span> <span>| `True</span> <span>| `False</span> ]</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span>[ <span>`Formula of <span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span></span> <span>| `True</span> <span>| `False</span> ]</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-check_relop" class="anchored"><a href="#val-check_relop" class="anchor"></a><code><span><span class="keyword">val</span> check_relop : <span><a href="#type-relop">relop</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check a relational operator against an integer from compare</p></div></div><div class="odoc-spec"><div class="spec value" id="val-eval_relop" class="anchored"><a href="#val-eval_relop" class="anchor"></a><code><span><span class="keyword">val</span> eval_relop : <span><a href="#type-relop">relop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/Version/index.html#type-t">OpamPackage.Version.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/Version/index.html#type-t">OpamPackage.Version.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Evaluate a relational operator between versions</p></div></div><div class="odoc-spec"><div class="spec value" id="val-neg_relop" class="anchored"><a href="#val-neg_relop" class="anchor"></a><code><span><span class="keyword">val</span> neg_relop : <span><a href="#type-relop">relop</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-relop">relop</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-string_of_formula" class="anchored"><a href="#val-string_of_formula" class="anchor"></a><code><span><span class="keyword">val</span> string_of_formula : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print a formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ands" class="anchored"><a href="#val-ands" class="anchor"></a><code><span><span class="keyword">val</span> ands : <span><span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Convert a list of formulas to an AND-formula (<code>Empty</code> formulas are ignored)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ands_to_list" class="anchored"><a href="#val-ands_to_list" class="anchor"></a><code><span><span class="keyword">val</span> ands_to_list : <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> list</span></span></code></div><div class="spec-doc"><p>Converts back an AND-formula to a list (flattens top-level ands)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ors" class="anchored"><a href="#val-ors" class="anchor"></a><code><span><span class="keyword">val</span> ors : <span><span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Convert a list of formulas to an OR-formula (<code>Empty</code> formulas are ignored)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ors_to_list" class="anchored"><a href="#val-ors_to_list" class="anchor"></a><code><span><span class="keyword">val</span> ors_to_list : <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> list</span></span></code></div><div class="spec-doc"><p>Converts back an OR-formula to a list (flattens top-level ors)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Map on atoms. Atoms for which the given function returns Empty will be simply removed</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map_formula" class="anchored"><a href="#val-map_formula" class="anchor"></a><code><span><span class="keyword">val</span> map_formula : <span><span>(<span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Maps top-down on a formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map_up_formula" class="anchored"><a href="#val-map_up_formula" class="anchor"></a><code><span><span class="keyword">val</span> map_up_formula : <span><span>(<span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Maps bottom-up on a formula (atoms first)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-neg" class="anchored"><a href="#val-neg" class="anchor"></a><code><span><span class="keyword">val</span> neg : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Negates a formula (given the function to negate atoms)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-iter" class="anchored"><a href="#val-iter" class="anchor"></a><code><span><span class="keyword">val</span> iter : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Iter function</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_left" class="anchored"><a href="#val-fold_left" class="anchor"></a><code><span><span class="keyword">val</span> fold_left : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Fold function (bottom-up, left-to-right)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_right" class="anchored"><a href="#val-fold_right" class="anchor"></a><code><span><span class="keyword">val</span> fold_right : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Fold function (bottom-up, right-to-left)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sort" class="anchored"><a href="#val-sort" class="anchor"></a><code><span><span class="keyword">val</span> sort : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Sort formula, using <code>compare</code> function. `Block` around `Or` and `And` \ are removed.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-version_formula" class="anchored"><a href="#type-version_formula" class="anchor"></a><code><span><span class="keyword">type</span> version_formula</span><span> = <span><a href="#type-version_constraint">version_constraint</a> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Expressions composed entirely of version constraints</p></div></div><div class="odoc-spec"><div class="spec value" id="val-check_version_formula" class="anchored"><a href="#val-check_version_formula" class="anchor"></a><code><span><span class="keyword">val</span> check_version_formula : <span><a href="#type-version_formula">version_formula</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/Version/index.html#type-t">OpamPackage.Version.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Checks if a given version satisfies a formula</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span><span>(<a href="../OpamPackage/Name/index.html#type-t">OpamPackage.Name.t</a> * <a href="#type-version_formula">version_formula</a>)</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>An atom is: <code>name</code> * (<code>relop</code> * <code>version</code>) formula. Examples of valid formulae:</p><ul><li>&quot;foo&quot; {&gt; &quot;1&quot; &amp; (&lt;&quot;3&quot; | =&quot;5&quot;)}</li><li>&quot;foo&quot; {= &quot;1&quot; | &gt; &quot;4&quot;} | (&quot;bar&quot; &quot;bouh&quot;)</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-compare" class="anchored"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-verifies" class="anchored"><a href="#val-verifies" class="anchor"></a><code><span><span class="keyword">val</span> verifies : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/index.html#type-t">OpamPackage.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Returns <code>true</code> if <code>package</code> verifies <code>formula</code> (i.e. it is within at least one package set that is a solution of the formula, and is named in the formula)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-satisfies_depends" class="anchored"><a href="#val-satisfies_depends" class="anchor"></a><code><span><span class="keyword">val</span> satisfies_depends : <span><a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Checks if a given set of (installed) packages satisfies a formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-packages" class="anchored"><a href="#val-packages" class="anchor"></a><code><span><span class="keyword">val</span> packages : <span><a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a></span></code></div><div class="spec-doc"><p>Returns the subset of packages possibly matching the formula (i.e. including all disjunction cases)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_nc" class="anchored"><a href="#val-compare_nc" class="anchor"></a><code><span><span class="keyword">val</span> compare_nc : <span><span>(<a href="../OpamPackage/Name/index.html#type-t">OpamPackage.Name.t</a> * <a href="#type-version_formula">version_formula</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="../OpamPackage/Name/index.html#type-t">OpamPackage.Name.t</a> * <a href="#type-version_formula">version_formula</a>)</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-cnf_of_formula" class="anchored"><a href="#val-cnf_of_formula" class="anchor"></a><code><span><span class="keyword">val</span> cnf_of_formula : <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Convert a formula to CNF</p></div></div><div class="odoc-spec"><div class="spec value" id="val-dnf_of_formula" class="anchored"><a href="#val-dnf_of_formula" class="anchor"></a><code><span><span class="keyword">val</span> dnf_of_formula : <span><span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Convert a formula to DNF</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_atom_formula" class="anchored"><a href="#val-to_atom_formula" class="anchor"></a><code><span><span class="keyword">val</span> to_atom_formula : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-formula">formula</a></span></span></code></div><div class="spec-doc"><p>Transform a formula where versions can be expressed using formulas to a flat atom formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_atom_formula" class="anchored"><a href="#val-of_atom_formula" class="anchor"></a><code><span><span class="keyword">val</span> of_atom_formula : <span><span><a href="#type-atom">atom</a> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Convert an atom-formula to a t-formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-simplify_ineq_formula" class="anchored"><a href="#val-simplify_ineq_formula" class="anchor"></a><code><span><span class="keyword">val</span> simplify_ineq_formula : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="#type-relop">relop</a> * <span class="type-var">'a</span>)</span> <a href="#type-formula">formula</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="#type-relop">relop</a> * <span class="type-var">'a</span>)</span> <a href="#type-formula">formula</a></span> option</span></span></code></div><div class="spec-doc"><p><code>simplify_ineq_formula comp f</code> returns a canonical version of inequality formula <code>f</code>, based on comparison function <code>comp</code>, where each version appears at most once, and in increasing order. Returns <code>Some Empty</code> if the formula is always <code>true</code>, <code>None</code> if it is always false</p></div></div><div class="odoc-spec"><div class="spec value" id="val-simplify_version_formula" class="anchored"><a href="#val-simplify_version_formula" class="anchor"></a><code><span><span class="keyword">val</span> simplify_version_formula : <span><a href="#type-version_formula">version_formula</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-version_formula">version_formula</a> option</span></span></code></div><div class="spec-doc"><p>Like <code>simplify_ineq_formula</code>, but specialised on version formulas</p></div></div><div class="odoc-spec"><div class="spec value" id="val-simplify_version_set" class="anchored"><a href="#val-simplify_version_set" class="anchor"></a><code><span><span class="keyword">val</span> simplify_version_set : <span><a href="../OpamPackage/Version/Set/index.html#type-t">OpamPackage.Version.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-version_formula">version_formula</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-version_formula">version_formula</a></span></code></div><div class="spec-doc"><p>A more aggressive version of <code>simplify_version_formula</code> that attempts to find a shorter formula describing the same subset of versions within a given set. The empty formula is returned for an empty set, and the original formula is otherwise returned as is if no versions match.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-formula_of_version_set" class="anchored"><a href="#val-formula_of_version_set" class="anchor"></a><code><span><span class="keyword">val</span> formula_of_version_set : <span><a href="../OpamPackage/Version/Set/index.html#type-t">OpamPackage.Version.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../OpamPackage/Version/Set/index.html#type-t">OpamPackage.Version.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-version_formula">version_formula</a></span></code></div><div class="spec-doc"><p><code>formula_of_version_set set subset</code> generates a formula that is enough to describe all packages of <code>subset</code> and exclude packages otherwise in <code>set</code></p></div></div><h3 id="atoms"><a href="#atoms" class="anchor"></a>Atoms</h3><div class="odoc-spec"><div class="spec value" id="val-atoms" class="anchored"><a href="#val-atoms" class="anchor"></a><code><span><span class="keyword">val</span> atoms : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> list</span></span></code></div><div class="spec-doc"><p>Return all the atoms</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_string" class="anchored"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Pretty print the formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_conjunction" class="anchored"><a href="#val-to_conjunction" class="anchor"></a><code><span><span class="keyword">val</span> to_conjunction : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-conjunction">conjunction</a></span></span></code></div><div class="spec-doc"><p>Return a conjunction. If the initial formula is not a conjunction, then fail.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_conjunction" class="anchored"><a href="#val-of_conjunction" class="anchor"></a><code><span><span class="keyword">val</span> of_conjunction : <span><span><a href="#type-atom">atom</a> <a href="#type-conjunction">conjunction</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Return a formula from a conjunction of atoms</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_disjunction" class="anchored"><a href="#val-to_disjunction" class="anchor"></a><code><span><span class="keyword">val</span> to_disjunction : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-disjunction">disjunction</a></span></span></code></div><div class="spec-doc"><p>Return a disjunction of atoms from a package formula. It the initial formula is not a disjunction, then fail.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_to_disjunction" class="anchored"><a href="#val-set_to_disjunction" class="anchor"></a><code><span><span class="keyword">val</span> set_to_disjunction : <span><a href="../OpamPackage/Set/index.html#type-t">OpamPackage.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-disjunction">disjunction</a></span></span></code></div><div class="spec-doc"><p>Like <code>to_disjunction</code>, but accepts conjunctions within constraint formulas, resolving them using the provided package set. Conjunctions between packages still raise <code>Failure</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_disjunction" class="anchored"><a href="#val-of_disjunction" class="anchor"></a><code><span><span class="keyword">val</span> of_disjunction : <span><span><a href="#type-atom">atom</a> <a href="#type-disjunction">disjunction</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Return a formula from a disjunction of atoms</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_cnf" class="anchored"><a href="#val-to_cnf" class="anchor"></a><code><span><span class="keyword">val</span> to_cnf : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-cnf">cnf</a></span></span></code></div><div class="spec-doc"><p>Return an equivalent CNF formula</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_dnf" class="anchored"><a href="#val-to_dnf" class="anchor"></a><code><span><span class="keyword">val</span> to_dnf : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-atom">atom</a> <a href="#type-dnf">dnf</a></span></span></code></div><div class="spec-doc"><p>Return an equivalent DNF formula</p></div></div></div></body></html>