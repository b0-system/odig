<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Op (b0.B00_cli.Op)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">b0</a> &#x00BB; <a href="../index.html">B00_cli</a> &#x00BB; Op</nav><header class="odoc-preamble"><h1>Module <code><span>B00_cli.Op</span></code></h1><p><a href="../../B000/Op/index.html"><code>B000.Op</code></a> interaction.</p></header><nav class="odoc-toc"><ul><li><a href="#deps">Finding dependencies</a></li><li><a href="#query">Operation query</a></li><li><a href="#cli">Command line interface</a></li></ul></nav><div class="odoc-content"><h2 id="deps"><a href="#deps" class="anchor"></a>Finding dependencies</h2><div class="odoc-spec"><div class="spec value" id="val-find_needs" class="anchored"><a href="#val-find_needs" class="anchor"></a><code><span><span class="keyword">val</span> find_needs : <span>?acc:<a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span>recursive:bool <span class="arrow">&#45;&gt;</span></span> <span>writes:<span><a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <a href="../../B00_std/Fpath/Map/index.html#type-t">B00_std.Fpath.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a></span></code></div><div class="spec-doc"><p><code>find_needs ~recursive ~writes ~acc ops</code> add to <code>acc</code> (defaults to <code>B00</code>.Op.Set.empty) the set of operations in the write index <code>writes</code> that need to be executed for the set of operations <code>ops</code> to be able to proceed. If <code>recursive</code> is <code>false</code> only direct dependencies are reported.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_enables" class="anchored"><a href="#val-find_enables" class="anchor"></a><code><span><span class="keyword">val</span> find_enables : <span>?acc:<a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <span>recursive:bool <span class="arrow">&#45;&gt;</span></span> <span>reads:<span><a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <a href="../../B00_std/Fpath/Map/index.html#type-t">B00_std.Fpath.Map.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../B000/Op/Set/index.html#type-t">B000.Op.Set.t</a></span></code></div><div class="spec-doc"><p><code>find_enables ~recursive ~writes ~acc ops</code> add to <code>acc</code> (defaults to <code>B00</code>.Op.Set.empty) the set of operations in the read index <code>reads</code> that are enabled by the set of operations <code>ops</code>. If <code>recursive</code> is <code>false</code> only direct dependencies are reported.</p></div></div><h2 id="query"><a href="#query" class="anchor"></a>Operation query</h2><div class="odoc-spec"><div class="spec type" id="type-query" class="anchored"><a href="#type-query" class="anchor"></a><code><span><span class="keyword">type</span> query</span><span> = <span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span></span></code></div><div class="spec-doc"><p>The type for build operation queries. This is not simply predicate because of dependency selection.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-select" class="anchored"><a href="#val-select" class="anchor"></a><code><span><span class="keyword">val</span> select : <span>reads:<span><a href="../../B00_std/Fpath/index.html#type-t">B00_std.Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>writes:<span><a href="../../B00_std/Fpath/index.html#type-t">B00_std.Fpath.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>ids:<span><a href="../../B000/Op/index.html#type-id">B000.Op.id</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>hashes:<span><a href="../../B00_std/Hash/index.html#type-t">B00_std.Hash.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
<span>marks:<span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>select ~reads ~writes ~ids ~hashes ~marks o</code> is <code>true</code> iff <code>o</code> reads a file in <code>reads</code> or writes a file in <code>writes</code> or has its id in <code>ids</code>, or has its hash in <code>hashes</code> or has its <code>mark</code> in <code>marks</code> or if all these selector lists are empty.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-select_deps" class="anchored"><a href="#val-select_deps" class="anchor"></a><code><span><span class="keyword">val</span> select_deps : <span>needs:bool <span class="arrow">&#45;&gt;</span></span> <span>enables:bool <span class="arrow">&#45;&gt;</span></span> <span>recursive:bool <span class="arrow">&#45;&gt;</span></span> <span>dom:<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
<span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span></span></code></div><div class="spec-doc"><p><code>select_deps ~needs ~enables ~recusrive  ~dom ops</code> select the operation <code>needs</code> and/or <code>enables</code> of <code>ops</code> <code>recursive</code>ly in <code>dom</code>. This is <code>ops</code> if both <code>needs</code> and <code>enables</code> are <code>false</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-filter" class="anchored"><a href="#val-filter" class="anchor"></a><code><span><span class="keyword">val</span> filter : <span>revived:<span>bool option</span> <span class="arrow">&#45;&gt;</span></span>
<span>statuses:<span><span>[ `Aborted <span>| `Done</span> <span>| `Failed</span> <span>| `Waiting</span> ]</span> list</span> <span class="arrow">&#45;&gt;</span></span>
<span>kinds:<span><span>[ `Copy <span>| `Delete</span> <span>| `Mkdir</span> <span>| `Notify</span> <span>| `Read</span> <span>| `Spawn</span> <span>| `Wait_files</span> <span>| `Write</span> ]</span> list</span>
<span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>filter ~revived ~statuses ~kinds</code> is an operation filter for the given filters.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-order" class="anchored"><a href="#val-order" class="anchor"></a><code><span><span class="keyword">val</span> order : <span>by:<span>[ `Create <span>| `Dur</span> <span>| `Wait</span> <span>| `Start</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span></span></code></div><div class="spec-doc"><p><code>order ~by ops</code> orders <code>ops</code> by <code>by</code> time.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-query" class="anchored"><a href="#val-query" class="anchor"></a><code><span><span class="keyword">val</span> query : <span>select:<span>(<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span>select_deps:<span>(<span>dom:<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span>
<span>filter:<span>(<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span>order:<span>(<span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-query">query</a></span></code></div><div class="spec-doc"><p><code>query ~select ~select_deps ~filer ~order</code> is an operation query that <code>select</code>s operations, their dependencies (or not) according to <code>select_deps</code>, filters the result with <code>filter</code> and orders them by <code>order</code>.</p></div></div><h2 id="cli"><a href="#cli" class="anchor"></a>Command line interface</h2><div class="odoc-spec"><div class="spec value" id="val-marks" class="anchored"><a href="#val-marks" class="anchor"></a><code><span><span class="keyword">val</span> marks : <span>?opts:<span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>?doc:string <span class="arrow">&#45;&gt;</span></span> <span>?docv:string <span class="arrow">&#45;&gt;</span></span>
<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-select_cli" class="anchored"><a href="#val-select_cli" class="anchor"></a><code><span><span class="keyword">val</span> select_cli : <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>?marks:<span><span>string list</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-select_deps_cli" class="anchored"><a href="#val-select_deps_cli" class="anchor"></a><code><span><span class="keyword">val</span> select_deps_cli : <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>dom:<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span>)</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-filter_cli" class="anchored"><a href="#val-filter_cli" class="anchor"></a><code><span><span class="keyword">val</span> filter_cli : <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> <span class="arrow">&#45;&gt;</span></span> bool)</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-order_cli" class="anchored"><a href="#val-order_cli" class="anchor"></a><code><span><span class="keyword">val</span> order_cli : <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../B000/Op/index.html#type-t">B000.Op.t</a> list</span>)</span> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-query_cli" class="anchored"><a href="#val-query_cli" class="anchor"></a><code><span><span class="keyword">val</span> query_cli : <span>?docs:string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-query">query</a> <a href="../../../cmdliner/Cmdliner/Term/index.html#type-t">Cmdliner.Term.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-query_man" class="anchored"><a href="#val-query_man" class="anchor"></a><code><span><span class="keyword">val</span> query_man : <span><a href="../../../cmdliner/Cmdliner/Manpage/index.html#type-block">Cmdliner.Manpage.block</a> list</span></span></code></div></div></div></body></html>